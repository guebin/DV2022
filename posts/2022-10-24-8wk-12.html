<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="최규빈">
<meta name="dcterms.date" content="2022-10-24">

<title>DV2022 - 08wk-1,2</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">DV2022</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../about.html">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/guebin/DV2022/tree/main/posts"><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.youtube.com/channel/UCQk9RyBNgXc7ORIsYlOfQrg/playlists?view=50&amp;sort=dd&amp;shelf_id=2"><i class="bi bi-youtube" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">08wk-1,2</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">pandas</div>
                <div class="quarto-category">자료분석</div>
                <div class="quarto-category">plotnine</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>최규빈 </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">October 24, 2022</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#강의영상" id="toc-강의영상" class="nav-link active" data-scroll-target="#강의영상">강의영상</a></li>
  <li><a href="#imports" id="toc-imports" class="nav-link" data-scroll-target="#imports">imports</a></li>
  <li><a href="#판다스-새로운-열의-할당-2단계-연쇄할당" id="toc-판다스-새로운-열의-할당-2단계-연쇄할당" class="nav-link" data-scroll-target="#판다스-새로운-열의-할당-2단계-연쇄할당">판다스: 새로운 열의 할당 2단계 (연쇄할당)</a>
  <ul class="collapse">
  <li><a href="#모티브" id="toc-모티브" class="nav-link" data-scroll-target="#모티브">모티브</a></li>
  <li><a href="#해결책1-df.copy이용-.eval이용" id="toc-해결책1-df.copy이용-.eval이용" class="nav-link" data-scroll-target="#해결책1-df.copy이용-.eval이용">해결책1: df.copy()이용, .eval()이용</a></li>
  <li><a href="#해결책2-assign을-이용한-연쇄할당" id="toc-해결책2-assign을-이용한-연쇄할당" class="nav-link" data-scroll-target="#해결책2-assign을-이용한-연쇄할당">해결책2: assign을 이용한 연쇄할당</a></li>
  </ul></li>
  <li><a href="#fifa23-데이터분석" id="toc-fifa23-데이터분석" class="nav-link" data-scroll-target="#fifa23-데이터분석">FIFA23 데이터분석</a>
  <ul class="collapse">
  <li><a href="#fifa23-data" id="toc-fifa23-data" class="nav-link" data-scroll-target="#fifa23-data">FIFA23 data</a></li>
  <li><a href="#데이터살펴보기" id="toc-데이터살펴보기" class="nav-link" data-scroll-target="#데이터살펴보기">데이터살펴보기</a></li>
  <li><a href="#데이터정리하기" id="toc-데이터정리하기" class="nav-link" data-scroll-target="#데이터정리하기">데이터정리하기</a></li>
  <li><a href="#데이터분석시각화" id="toc-데이터분석시각화" class="nav-link" data-scroll-target="#데이터분석시각화">데이터분석+시각화</a></li>
  </ul></li>
  <li><a href="#판다스-groupby" id="toc-판다스-groupby" class="nav-link" data-scroll-target="#판다스-groupby">판다스: Groupby</a>
  <ul class="collapse">
  <li><a href="#flights-data" id="toc-flights-data" class="nav-link" data-scroll-target="#flights-data">flights data</a></li>
  <li><a href="#get_groups" id="toc-get_groups" class="nav-link" data-scroll-target="#get_groups">get_groups</a></li>
  <li><a href="#범주형변수를-기준으로-groupby---agg" id="toc-범주형변수를-기준으로-groupby---agg" class="nav-link" data-scroll-target="#범주형변수를-기준으로-groupby---agg">범주형변수를 기준으로 groupby -&gt; agg</a>
  <ul class="collapse">
  <li><a href="#ex1-airline-to-arr_delaymean" id="toc-ex1-airline-to-arr_delaymean" class="nav-link" data-scroll-target="#ex1-airline-to-arr_delaymean"><code>#</code> EX1: [AIRLINE] <span class="math inline">\(\to\)</span> {ARR_DELAY:mean}</a></li>
  <li><a href="#ex2-airlineweekday-to-cancelledsum" id="toc-ex2-airlineweekday-to-cancelledsum" class="nav-link" data-scroll-target="#ex2-airlineweekday-to-cancelledsum"><code>#</code> EX2: [AIRLINE,WEEKDAY] <span class="math inline">\(\to\)</span> {CANCELLED:sum}</a></li>
  <li><a href="#ex3-airlineweekday-to-cancelledsummean-diverted-summean" id="toc-ex3-airlineweekday-to-cancelledsummean-diverted-summean" class="nav-link" data-scroll-target="#ex3-airlineweekday-to-cancelledsummean-diverted-summean"><code>#</code> EX3: [AIRLINE,WEEKDAY] <span class="math inline">\(\to\)</span> {CANCELLED:sum,mean}, {DIVERTED: sum,mean}</a></li>
  <li><a href="#ex4-airlineweekday-to-cancelledsummeancount-air_time-meanvar" id="toc-ex4-airlineweekday-to-cancelledsummeancount-air_time-meanvar" class="nav-link" data-scroll-target="#ex4-airlineweekday-to-cancelledsummeancount-air_time-meanvar"><code>#</code> EX4: [AIRLINE,WEEKDAY] <span class="math inline">\(\to\)</span> {CANCELLED:sum,mean,count}, {AIR_TIME: mean,var}</a></li>
  </ul></li>
  <li><a href="#연속형변수를-기준으로-groupby---agg" id="toc-연속형변수를-기준으로-groupby---agg" class="nav-link" data-scroll-target="#연속형변수를-기준으로-groupby---agg">연속형변수를 기준으로 groupby -&gt; agg</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<blockquote class="blockquote">
<p>판다스– 새로운 열의 할당(2), 자료분석–FIFA23 데이터분석, 판다스– Groupby</p>
</blockquote>
<section id="강의영상" class="level1">
<h1>강의영상</h1>
<p><a href="https://youtube.com/playlist?list=PLQqh36zP38-wOd-atBIouN7KjEBqTWy1r" class="uri">https://youtube.com/playlist?list=PLQqh36zP38-wOd-atBIouN7KjEBqTWy1r</a></p>
</section>
<section id="imports" class="level1">
<h1>imports</h1>
<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1"></a><span class="co"># !pip install pandas_profiling</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="im">import</span> pandas_profiling</span>
<span id="cb2-4"><a href="#cb2-4"></a><span class="im">from</span> plotnine <span class="im">import</span> <span class="op">*</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="판다스-새로운-열의-할당-2단계-연쇄할당" class="level1">
<h1>판다스: 새로운 열의 할당 2단계 (연쇄할당)</h1>
<section id="모티브" class="level2">
<h2 class="anchored" data-anchor-id="모티브">모티브</h2>
<p><code>-</code> 원본데이터를 가급적 손상시키지 않으면서 데이터를 변형하고 싶음.</p>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1"></a>df <span class="op">=</span> pd.DataFrame({<span class="st">'A'</span>:<span class="bu">range</span>(<span class="dv">0</span>,<span class="dv">5</span>),<span class="st">'B'</span>:<span class="bu">range</span>(<span class="dv">1</span>,<span class="dv">6</span>)})</span>
<span id="cb3-2"><a href="#cb3-2"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="3">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>5</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>복사본 생성</p>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1"></a>df2 <span class="op">=</span> df </span>
<span id="cb4-2"><a href="#cb4-2"></a>df2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>5</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1"></a>df2[<span class="st">'C'</span>] <span class="op">=</span> (df2.A<span class="op">+</span> df2.B)<span class="op">/</span><span class="dv">2</span></span>
<span id="cb5-2"><a href="#cb5-2"></a>df2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>1</td>
      <td>0.5</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>2</td>
      <td>1.5</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>3</td>
      <td>2.5</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>4</td>
      <td>3.5</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>5</td>
      <td>4.5</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1"></a>df2[<span class="st">'D'</span>]<span class="op">=</span> (df2.C <span class="op">-</span> np.mean(df2.C))<span class="op">/</span>np.std(df2.C) </span>
<span id="cb6-2"><a href="#cb6-2"></a>df2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>1</td>
      <td>0.5</td>
      <td>-1.414214</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>2</td>
      <td>1.5</td>
      <td>-0.707107</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>3</td>
      <td>2.5</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>4</td>
      <td>3.5</td>
      <td>0.707107</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>5</td>
      <td>4.5</td>
      <td>1.414214</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1"></a>df <span class="co"># 니가 왜 거기서 나와??</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>1</td>
      <td>0.5</td>
      <td>-1.414214</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>2</td>
      <td>1.5</td>
      <td>-0.707107</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>3</td>
      <td>2.5</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>4</td>
      <td>3.5</td>
      <td>0.707107</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>5</td>
      <td>4.5</td>
      <td>1.414214</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</section>
<section id="해결책1-df.copy이용-.eval이용" class="level2">
<h2 class="anchored" data-anchor-id="해결책1-df.copy이용-.eval이용">해결책1: df.copy()이용, .eval()이용</h2>
<p><code>-</code> 올바른코드1</p>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1"></a>df <span class="op">=</span> pd.DataFrame({<span class="st">'A'</span>:<span class="bu">range</span>(<span class="dv">0</span>,<span class="dv">5</span>),<span class="st">'B'</span>:<span class="bu">range</span>(<span class="dv">1</span>,<span class="dv">6</span>)})</span>
<span id="cb8-2"><a href="#cb8-2"></a>df2 <span class="op">=</span> df.copy() </span>
<span id="cb8-3"><a href="#cb8-3"></a>df2[<span class="st">'C'</span>] <span class="op">=</span> (df2.A<span class="op">+</span> df2.B)<span class="op">/</span><span class="dv">2</span></span>
<span id="cb8-4"><a href="#cb8-4"></a>df2[<span class="st">'D'</span>]<span class="op">=</span> (df2.C <span class="op">-</span> np.mean(df2.C))<span class="op">/</span>np.std(df2.C) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1"></a>df2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>1</td>
      <td>0.5</td>
      <td>-1.414214</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>2</td>
      <td>1.5</td>
      <td>-0.707107</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>3</td>
      <td>2.5</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>4</td>
      <td>3.5</td>
      <td>0.707107</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>5</td>
      <td>4.5</td>
      <td>1.414214</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>5</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p><code>-</code> 올바른코드2</p>
<div class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1"></a>df <span class="op">=</span> pd.DataFrame({<span class="st">'A'</span>:<span class="bu">range</span>(<span class="dv">0</span>,<span class="dv">5</span>),<span class="st">'B'</span>:<span class="bu">range</span>(<span class="dv">1</span>,<span class="dv">6</span>)})</span>
<span id="cb11-2"><a href="#cb11-2"></a>mean <span class="op">=</span> np.mean </span>
<span id="cb11-3"><a href="#cb11-3"></a>std <span class="op">=</span> np.std </span>
<span id="cb11-4"><a href="#cb11-4"></a>df.<span class="bu">eval</span>(<span class="st">'C=(A+B)/2'</span>).<span class="bu">eval</span>(<span class="st">'D=(C-@mean(C))/@std(C)'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="30">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>1</td>
      <td>0.5</td>
      <td>-1.414214</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>2</td>
      <td>1.5</td>
      <td>-0.707107</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>3</td>
      <td>2.5</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>4</td>
      <td>3.5</td>
      <td>0.707107</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>5</td>
      <td>4.5</td>
      <td>1.414214</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<ul>
<li>어디까지 eval expression 안에서 지원되는지 명확하지 않고</li>
<li>외부에 함수를 선언하고 eval expression 안에 <span class="citation" data-cites="를">@를</span> 붙이는게 좀 귀찮음</li>
</ul>
<p><code>-</code> 올바른코드3 (assign) –&gt; 실패</p>
<div class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1"></a>df <span class="op">=</span> pd.DataFrame({<span class="st">'A'</span>:<span class="bu">range</span>(<span class="dv">0</span>,<span class="dv">5</span>),<span class="st">'B'</span>:<span class="bu">range</span>(<span class="dv">1</span>,<span class="dv">6</span>)})</span>
<span id="cb12-2"><a href="#cb12-2"></a>df.assign(C<span class="op">=</span> (df.A<span class="op">+</span>df.B)<span class="op">/</span><span class="dv">2</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="31">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>1</td>
      <td>0.5</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>2</td>
      <td>1.5</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>3</td>
      <td>2.5</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>4</td>
      <td>3.5</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>5</td>
      <td>4.5</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1"></a>df.assign(C<span class="op">=</span> (df.A<span class="op">+</span>df.B)<span class="op">/</span><span class="dv">2</span>).assign(D<span class="op">=</span> (df.C<span class="op">-</span> np.mean(df.C))<span class="op">/</span>np.std(df.C))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>AttributeError: 'DataFrame' object has no attribute 'C'</code></pre>
</div>
</div>
<p>아래와 같이 고쳐야함</p>
<div class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1"></a>_df <span class="op">=</span> df.assign(C<span class="op">=</span> (df.A<span class="op">+</span>df.B)<span class="op">/</span><span class="dv">2</span>)</span>
<span id="cb15-2"><a href="#cb15-2"></a>_df.assign(D<span class="op">=</span> (_df.C<span class="op">-</span> np.mean(_df.C))<span class="op">/</span>np.std(_df.C))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="39">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>1</td>
      <td>0.5</td>
      <td>-1.414214</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>2</td>
      <td>1.5</td>
      <td>-0.707107</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>3</td>
      <td>2.5</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>4</td>
      <td>3.5</td>
      <td>0.707107</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>5</td>
      <td>4.5</td>
      <td>1.414214</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<ul>
<li>이건 우리의 철학이랑 안맞음..</li>
</ul>
</section>
<section id="해결책2-assign을-이용한-연쇄할당" class="level2">
<h2 class="anchored" data-anchor-id="해결책2-assign을-이용한-연쇄할당">해결책2: assign을 이용한 연쇄할당</h2>
<p>실패한코드는 아래와 같다.</p>
<div class="cell" data-execution_count="44">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1"></a>df.assign(C<span class="op">=</span> (df.A<span class="op">+</span>df.B)<span class="op">/</span><span class="dv">2</span>).assign(D<span class="op">=</span> (df.C<span class="op">-</span> np.mean(df.C))<span class="op">/</span>np.std(df.C))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>AttributeError: 'DataFrame' object has no attribute 'C'</code></pre>
</div>
</div>
<p>두번째 assign에서 표현된 df.C 에서, df가 <code>current df</code> (= <code>df.assign(C= (df.A+df.B)/2)</code> 까지 연산된 상태) 를 의미하도록 만들고 싶다. <span class="math inline">\(\to\)</span> 아래와 같이 <code>lambda df:</code> 를 추가하면 된다.</p>
<div class="cell" data-execution_count="49">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1"></a>df.assign(C<span class="op">=</span> (df.A<span class="op">+</span>df.B)<span class="op">/</span><span class="dv">2</span>).assign(D<span class="op">=</span> <span class="kw">lambda</span> df: (df.C<span class="op">-</span> np.mean(df.C))<span class="op">/</span>np.std(df.C))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="49">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>1</td>
      <td>0.5</td>
      <td>-1.414214</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>2</td>
      <td>1.5</td>
      <td>-0.707107</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>3</td>
      <td>2.5</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>4</td>
      <td>3.5</td>
      <td>0.707107</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>5</td>
      <td>4.5</td>
      <td>1.414214</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p><code>-</code> 연쇄할당</p>
<div class="cell" data-execution_count="55">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1"></a>df.assign(C <span class="op">=</span> (df.A<span class="op">+</span>df.B)<span class="op">/</span><span class="dv">2</span>).assign(D <span class="op">=</span> <span class="kw">lambda</span> df: df.C <span class="op">+</span><span class="dv">2</span>).assign(E <span class="op">=</span> <span class="kw">lambda</span> df: df.D <span class="op">-</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="55">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>E</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>1</td>
      <td>0.5</td>
      <td>2.5</td>
      <td>0.5</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>2</td>
      <td>1.5</td>
      <td>3.5</td>
      <td>1.5</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>3</td>
      <td>2.5</td>
      <td>4.5</td>
      <td>2.5</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>4</td>
      <td>3.5</td>
      <td>5.5</td>
      <td>3.5</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>5</td>
      <td>4.5</td>
      <td>6.5</td>
      <td>4.5</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</section>
</section>
<section id="fifa23-데이터분석" class="level1">
<h1>FIFA23 데이터분석</h1>
<section id="fifa23-data" class="level2">
<h2 class="anchored" data-anchor-id="fifa23-data">FIFA23 data</h2>
<p><code>-</code> FIFA23라는 축구게임이 있음</p>
<p><code>-</code> 게임에 실제 선수들이 나오면서 선수들의 능력치가 세밀하게 구현되어 있음</p>
<p><code>-</code> 선수들 능력치에 대한 데이터셋은 캐글에 공개되어 있음 - https://www.kaggle.com/datasets/bryanb/fifa-player-stats-database?select=FIFA23_official_data.csv</p>
</section>
<section id="데이터살펴보기" class="level2">
<h2 class="anchored" data-anchor-id="데이터살펴보기">데이터살펴보기</h2>
<p><code>-</code> 일단 살펴보기</p>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1"></a>df<span class="op">=</span>pd.read_csv(<span class="st">'https://raw.githubusercontent.com/guebin/DV2022/master/posts/FIFA23_official_data.csv'</span>)</span>
<span id="cb20-2"><a href="#cb20-2"></a>df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="3">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>ID</th>
      <th>Name</th>
      <th>Age</th>
      <th>Photo</th>
      <th>Nationality</th>
      <th>Flag</th>
      <th>Overall</th>
      <th>Potential</th>
      <th>Club</th>
      <th>Club Logo</th>
      <th>...</th>
      <th>Real Face</th>
      <th>Position</th>
      <th>Joined</th>
      <th>Loaned From</th>
      <th>Contract Valid Until</th>
      <th>Height</th>
      <th>Weight</th>
      <th>Release Clause</th>
      <th>Kit Number</th>
      <th>Best Overall Rating</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>209658</td>
      <td>L. Goretzka</td>
      <td>27</td>
      <td>https://cdn.sofifa.net/players/209/658/23_60.png</td>
      <td>Germany</td>
      <td>https://cdn.sofifa.net/flags/de.png</td>
      <td>87</td>
      <td>88</td>
      <td>FC Bayern München</td>
      <td>https://cdn.sofifa.net/teams/21/30.png</td>
      <td>...</td>
      <td>Yes</td>
      <td>&lt;span class="pos pos28"&gt;SUB</td>
      <td>Jul 1, 2018</td>
      <td>NaN</td>
      <td>2026</td>
      <td>189cm</td>
      <td>82kg</td>
      <td>€157M</td>
      <td>8.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>212198</td>
      <td>Bruno Fernandes</td>
      <td>27</td>
      <td>https://cdn.sofifa.net/players/212/198/23_60.png</td>
      <td>Portugal</td>
      <td>https://cdn.sofifa.net/flags/pt.png</td>
      <td>86</td>
      <td>87</td>
      <td>Manchester United</td>
      <td>https://cdn.sofifa.net/teams/11/30.png</td>
      <td>...</td>
      <td>Yes</td>
      <td>&lt;span class="pos pos15"&gt;LCM</td>
      <td>Jan 30, 2020</td>
      <td>NaN</td>
      <td>2026</td>
      <td>179cm</td>
      <td>69kg</td>
      <td>€155M</td>
      <td>8.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>224334</td>
      <td>M. Acuña</td>
      <td>30</td>
      <td>https://cdn.sofifa.net/players/224/334/23_60.png</td>
      <td>Argentina</td>
      <td>https://cdn.sofifa.net/flags/ar.png</td>
      <td>85</td>
      <td>85</td>
      <td>Sevilla FC</td>
      <td>https://cdn.sofifa.net/teams/481/30.png</td>
      <td>...</td>
      <td>No</td>
      <td>&lt;span class="pos pos7"&gt;LB</td>
      <td>Sep 14, 2020</td>
      <td>NaN</td>
      <td>2024</td>
      <td>172cm</td>
      <td>69kg</td>
      <td>€97.7M</td>
      <td>19.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>192985</td>
      <td>K. De Bruyne</td>
      <td>31</td>
      <td>https://cdn.sofifa.net/players/192/985/23_60.png</td>
      <td>Belgium</td>
      <td>https://cdn.sofifa.net/flags/be.png</td>
      <td>91</td>
      <td>91</td>
      <td>Manchester City</td>
      <td>https://cdn.sofifa.net/teams/10/30.png</td>
      <td>...</td>
      <td>Yes</td>
      <td>&lt;span class="pos pos13"&gt;RCM</td>
      <td>Aug 30, 2015</td>
      <td>NaN</td>
      <td>2025</td>
      <td>181cm</td>
      <td>70kg</td>
      <td>€198.9M</td>
      <td>17.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>224232</td>
      <td>N. Barella</td>
      <td>25</td>
      <td>https://cdn.sofifa.net/players/224/232/23_60.png</td>
      <td>Italy</td>
      <td>https://cdn.sofifa.net/flags/it.png</td>
      <td>86</td>
      <td>89</td>
      <td>Inter</td>
      <td>https://cdn.sofifa.net/teams/44/30.png</td>
      <td>...</td>
      <td>Yes</td>
      <td>&lt;span class="pos pos13"&gt;RCM</td>
      <td>Sep 1, 2020</td>
      <td>NaN</td>
      <td>2026</td>
      <td>172cm</td>
      <td>68kg</td>
      <td>€154.4M</td>
      <td>23.0</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 29 columns</p>
</div>
</div>
</div>
<p>트랜스포즈하여 보는 것이 편할때도 있음</p>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1"></a>df.T</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>...</th>
      <th>17650</th>
      <th>17651</th>
      <th>17652</th>
      <th>17653</th>
      <th>17654</th>
      <th>17655</th>
      <th>17656</th>
      <th>17657</th>
      <th>17658</th>
      <th>17659</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>ID</th>
      <td>209658</td>
      <td>212198</td>
      <td>224334</td>
      <td>192985</td>
      <td>224232</td>
      <td>212622</td>
      <td>197445</td>
      <td>187961</td>
      <td>208333</td>
      <td>210514</td>
      <td>...</td>
      <td>256879</td>
      <td>269546</td>
      <td>267647</td>
      <td>253186</td>
      <td>267461</td>
      <td>269526</td>
      <td>267946</td>
      <td>270567</td>
      <td>256624</td>
      <td>256376</td>
    </tr>
    <tr>
      <th>Name</th>
      <td>L. Goretzka</td>
      <td>Bruno Fernandes</td>
      <td>M. Acuña</td>
      <td>K. De Bruyne</td>
      <td>N. Barella</td>
      <td>J. Kimmich</td>
      <td>D. Alaba</td>
      <td>22&nbsp;Paulinho</td>
      <td>E. Can</td>
      <td>João Cancelo</td>
      <td>...</td>
      <td>22&nbsp;G. Leijon</td>
      <td>Wu Fei</td>
      <td>22&nbsp;E. Grosz</td>
      <td>22&nbsp;S. Booth</td>
      <td>22&nbsp;L. Grimpe</td>
      <td>Deng Xiongtao</td>
      <td>22&nbsp;Lim Jun Sub</td>
      <td>A. Demir</td>
      <td>21&nbsp;S. Czajor</td>
      <td>21&nbsp;F. Jakobsson</td>
    </tr>
    <tr>
      <th>Age</th>
      <td>27</td>
      <td>27</td>
      <td>30</td>
      <td>31</td>
      <td>25</td>
      <td>27</td>
      <td>30</td>
      <td>32</td>
      <td>28</td>
      <td>28</td>
      <td>...</td>
      <td>19</td>
      <td>32</td>
      <td>18</td>
      <td>20</td>
      <td>17</td>
      <td>19</td>
      <td>17</td>
      <td>25</td>
      <td>18</td>
      <td>20</td>
    </tr>
    <tr>
      <th>Photo</th>
      <td>https://cdn.sofifa.net/players/209/658/23_60.png</td>
      <td>https://cdn.sofifa.net/players/212/198/23_60.png</td>
      <td>https://cdn.sofifa.net/players/224/334/23_60.png</td>
      <td>https://cdn.sofifa.net/players/192/985/23_60.png</td>
      <td>https://cdn.sofifa.net/players/224/232/23_60.png</td>
      <td>https://cdn.sofifa.net/players/212/622/23_60.png</td>
      <td>https://cdn.sofifa.net/players/197/445/23_60.png</td>
      <td>https://cdn.sofifa.net/players/187/961/22_60.png</td>
      <td>https://cdn.sofifa.net/players/208/333/23_60.png</td>
      <td>https://cdn.sofifa.net/players/210/514/23_60.png</td>
      <td>...</td>
      <td>https://cdn.sofifa.net/players/256/879/22_60.png</td>
      <td>https://cdn.sofifa.net/players/269/546/23_60.png</td>
      <td>https://cdn.sofifa.net/players/267/647/22_60.png</td>
      <td>https://cdn.sofifa.net/players/253/186/22_60.png</td>
      <td>https://cdn.sofifa.net/players/267/461/22_60.png</td>
      <td>https://cdn.sofifa.net/players/269/526/23_60.png</td>
      <td>https://cdn.sofifa.net/players/267/946/22_60.png</td>
      <td>https://cdn.sofifa.net/players/270/567/23_60.png</td>
      <td>https://cdn.sofifa.net/players/256/624/21_60.png</td>
      <td>https://cdn.sofifa.net/players/256/376/21_60.png</td>
    </tr>
    <tr>
      <th>Nationality</th>
      <td>Germany</td>
      <td>Portugal</td>
      <td>Argentina</td>
      <td>Belgium</td>
      <td>Italy</td>
      <td>Germany</td>
      <td>Austria</td>
      <td>Brazil</td>
      <td>Germany</td>
      <td>Portugal</td>
      <td>...</td>
      <td>Sweden</td>
      <td>China PR</td>
      <td>Romania</td>
      <td>England</td>
      <td>Germany</td>
      <td>China PR</td>
      <td>Korea Republic</td>
      <td>Turkey</td>
      <td>Poland</td>
      <td>Sweden</td>
    </tr>
    <tr>
      <th>Flag</th>
      <td>https://cdn.sofifa.net/flags/de.png</td>
      <td>https://cdn.sofifa.net/flags/pt.png</td>
      <td>https://cdn.sofifa.net/flags/ar.png</td>
      <td>https://cdn.sofifa.net/flags/be.png</td>
      <td>https://cdn.sofifa.net/flags/it.png</td>
      <td>https://cdn.sofifa.net/flags/de.png</td>
      <td>https://cdn.sofifa.net/flags/at.png</td>
      <td>https://cdn.sofifa.net/flags/br.png</td>
      <td>https://cdn.sofifa.net/flags/de.png</td>
      <td>https://cdn.sofifa.net/flags/pt.png</td>
      <td>...</td>
      <td>https://cdn.sofifa.net/flags/se.png</td>
      <td>https://cdn.sofifa.net/flags/cn.png</td>
      <td>https://cdn.sofifa.net/flags/ro.png</td>
      <td>https://cdn.sofifa.net/flags/gb-eng.png</td>
      <td>https://cdn.sofifa.net/flags/de.png</td>
      <td>https://cdn.sofifa.net/flags/cn.png</td>
      <td>https://cdn.sofifa.net/flags/kr.png</td>
      <td>https://cdn.sofifa.net/flags/tr.png</td>
      <td>https://cdn.sofifa.net/flags/pl.png</td>
      <td>https://cdn.sofifa.net/flags/se.png</td>
    </tr>
    <tr>
      <th>Overall</th>
      <td>87</td>
      <td>86</td>
      <td>85</td>
      <td>91</td>
      <td>86</td>
      <td>89</td>
      <td>86</td>
      <td>83</td>
      <td>82</td>
      <td>88</td>
      <td>...</td>
      <td>52</td>
      <td>51</td>
      <td>52</td>
      <td>51</td>
      <td>54</td>
      <td>48</td>
      <td>48</td>
      <td>51</td>
      <td>50</td>
      <td>50</td>
    </tr>
    <tr>
      <th>Potential</th>
      <td>88</td>
      <td>87</td>
      <td>85</td>
      <td>91</td>
      <td>89</td>
      <td>90</td>
      <td>86</td>
      <td>83</td>
      <td>82</td>
      <td>88</td>
      <td>...</td>
      <td>62</td>
      <td>51</td>
      <td>70</td>
      <td>60</td>
      <td>68</td>
      <td>61</td>
      <td>64</td>
      <td>56</td>
      <td>65</td>
      <td>61</td>
    </tr>
    <tr>
      <th>Club</th>
      <td>FC Bayern München</td>
      <td>Manchester United</td>
      <td>Sevilla FC</td>
      <td>Manchester City</td>
      <td>Inter</td>
      <td>FC Bayern München</td>
      <td>Real Madrid CF</td>
      <td>Al Ahli</td>
      <td>Borussia Dortmund</td>
      <td>Manchester City</td>
      <td>...</td>
      <td>Örebro SK</td>
      <td>Wuhan Three Towns</td>
      <td>Gaz Metan Mediaş</td>
      <td>Crewe Alexandra</td>
      <td>RB Leipzig</td>
      <td>Meizhou Hakka</td>
      <td>Jeju United FC</td>
      <td>Ümraniyespor</td>
      <td>Fleetwood Town</td>
      <td>IFK Norrköping</td>
    </tr>
    <tr>
      <th>Club Logo</th>
      <td>https://cdn.sofifa.net/teams/21/30.png</td>
      <td>https://cdn.sofifa.net/teams/11/30.png</td>
      <td>https://cdn.sofifa.net/teams/481/30.png</td>
      <td>https://cdn.sofifa.net/teams/10/30.png</td>
      <td>https://cdn.sofifa.net/teams/44/30.png</td>
      <td>https://cdn.sofifa.net/teams/21/30.png</td>
      <td>https://cdn.sofifa.net/teams/243/30.png</td>
      <td>https://cdn.sofifa.net/teams/112387/30.png</td>
      <td>https://cdn.sofifa.net/teams/22/30.png</td>
      <td>https://cdn.sofifa.net/teams/10/30.png</td>
      <td>...</td>
      <td>https://cdn.sofifa.net/teams/705/30.png</td>
      <td>https://cdn.sofifa.net/teams/116361/30.png</td>
      <td>https://cdn.sofifa.net/teams/112637/30.png</td>
      <td>https://cdn.sofifa.net/teams/121/30.png</td>
      <td>https://cdn.sofifa.net/teams/112172/30.png</td>
      <td>https://cdn.sofifa.net/teams/114628/30.png</td>
      <td>https://cdn.sofifa.net/teams/1478/30.png</td>
      <td>https://cdn.sofifa.net/teams/113796/30.png</td>
      <td>https://cdn.sofifa.net/teams/112260/30.png</td>
      <td>https://cdn.sofifa.net/teams/702/30.png</td>
    </tr>
    <tr>
      <th>Value</th>
      <td>€91M</td>
      <td>€78.5M</td>
      <td>€46.5M</td>
      <td>€107.5M</td>
      <td>€89.5M</td>
      <td>€105.5M</td>
      <td>€55.5M</td>
      <td>€28.5M</td>
      <td>€30.5M</td>
      <td>€82.5M</td>
      <td>...</td>
      <td>€150K</td>
      <td>€30K</td>
      <td>€180K</td>
      <td>€110K</td>
      <td>€210K</td>
      <td>€100K</td>
      <td>€100K</td>
      <td>€70K</td>
      <td>€90K</td>
      <td>€90K</td>
    </tr>
    <tr>
      <th>Wage</th>
      <td>€115K</td>
      <td>€190K</td>
      <td>€46K</td>
      <td>€350K</td>
      <td>€110K</td>
      <td>€130K</td>
      <td>€220K</td>
      <td>€61K</td>
      <td>€63K</td>
      <td>€250K</td>
      <td>...</td>
      <td>€500</td>
      <td>€2K</td>
      <td>€500</td>
      <td>€850</td>
      <td>€500</td>
      <td>€500</td>
      <td>€500</td>
      <td>€2K</td>
      <td>€500</td>
      <td>€500</td>
    </tr>
    <tr>
      <th>Special</th>
      <td>2312</td>
      <td>2305</td>
      <td>2303</td>
      <td>2303</td>
      <td>2296</td>
      <td>2283</td>
      <td>2277</td>
      <td>2273</td>
      <td>2271</td>
      <td>2262</td>
      <td>...</td>
      <td>779</td>
      <td>777</td>
      <td>775</td>
      <td>768</td>
      <td>767</td>
      <td>762</td>
      <td>761</td>
      <td>759</td>
      <td>758</td>
      <td>749</td>
    </tr>
    <tr>
      <th>Preferred Foot</th>
      <td>Right</td>
      <td>Right</td>
      <td>Left</td>
      <td>Right</td>
      <td>Right</td>
      <td>Right</td>
      <td>Left</td>
      <td>Right</td>
      <td>Right</td>
      <td>Right</td>
      <td>...</td>
      <td>Right</td>
      <td>Right</td>
      <td>Right</td>
      <td>Right</td>
      <td>Right</td>
      <td>Right</td>
      <td>Right</td>
      <td>Right</td>
      <td>Right</td>
      <td>Left</td>
    </tr>
    <tr>
      <th>International Reputation</th>
      <td>4.0</td>
      <td>3.0</td>
      <td>2.0</td>
      <td>4.0</td>
      <td>3.0</td>
      <td>4.0</td>
      <td>4.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>...</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>Weak Foot</th>
      <td>4.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>5.0</td>
      <td>3.0</td>
      <td>4.0</td>
      <td>4.0</td>
      <td>4.0</td>
      <td>4.0</td>
      <td>4.0</td>
      <td>...</td>
      <td>3.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>Skill Moves</th>
      <td>3.0</td>
      <td>4.0</td>
      <td>3.0</td>
      <td>4.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>4.0</td>
      <td>3.0</td>
      <td>4.0</td>
      <td>...</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>Work Rate</th>
      <td>High/ Medium</td>
      <td>High/ High</td>
      <td>High/ High</td>
      <td>High/ High</td>
      <td>High/ High</td>
      <td>High/ Medium</td>
      <td>Medium/ Medium</td>
      <td>High/ High</td>
      <td>Medium/ High</td>
      <td>High/ Medium</td>
      <td>...</td>
      <td>Medium/ Medium</td>
      <td>Medium/ Medium</td>
      <td>Medium/ Medium</td>
      <td>Medium/ Medium</td>
      <td>Medium/ Medium</td>
      <td>Medium/ Medium</td>
      <td>Medium/ Medium</td>
      <td>Medium/ Medium</td>
      <td>Medium/ Medium</td>
      <td>Medium/ Medium</td>
    </tr>
    <tr>
      <th>Body Type</th>
      <td>Unique</td>
      <td>Unique</td>
      <td>Stocky (170-185)</td>
      <td>Unique</td>
      <td>Normal (170-)</td>
      <td>Normal (170-185)</td>
      <td>Normal (170-185)</td>
      <td>Normal (170-185)</td>
      <td>Stocky (185+)</td>
      <td>Unique</td>
      <td>...</td>
      <td>Normal (185+)</td>
      <td>Normal (185+)</td>
      <td>Lean (185+)</td>
      <td>Lean (185+)</td>
      <td>Lean (185+)</td>
      <td>Normal (185+)</td>
      <td>Lean (185+)</td>
      <td>Lean (185+)</td>
      <td>Normal (185+)</td>
      <td>Normal (185+)</td>
    </tr>
    <tr>
      <th>Real Face</th>
      <td>Yes</td>
      <td>Yes</td>
      <td>No</td>
      <td>Yes</td>
      <td>Yes</td>
      <td>Yes</td>
      <td>Yes</td>
      <td>Yes</td>
      <td>Yes</td>
      <td>Yes</td>
      <td>...</td>
      <td>No</td>
      <td>No</td>
      <td>No</td>
      <td>No</td>
      <td>No</td>
      <td>No</td>
      <td>No</td>
      <td>No</td>
      <td>No</td>
      <td>No</td>
    </tr>
    <tr>
      <th>Position</th>
      <td>&lt;span class="pos pos28"&gt;SUB</td>
      <td>&lt;span class="pos pos15"&gt;LCM</td>
      <td>&lt;span class="pos pos7"&gt;LB</td>
      <td>&lt;span class="pos pos13"&gt;RCM</td>
      <td>&lt;span class="pos pos13"&gt;RCM</td>
      <td>&lt;span class="pos pos9"&gt;RDM</td>
      <td>&lt;span class="pos pos6"&gt;LCB</td>
      <td>&lt;span class="pos pos15"&gt;LCM</td>
      <td>&lt;span class="pos pos28"&gt;SUB</td>
      <td>&lt;span class="pos pos7"&gt;LB</td>
      <td>...</td>
      <td>&lt;span class="pos pos28"&gt;SUB</td>
      <td>&lt;span class="pos pos28"&gt;SUB</td>
      <td>&lt;span class="pos pos28"&gt;SUB</td>
      <td>&lt;span class="pos pos29"&gt;RES</td>
      <td>&lt;span class="pos pos29"&gt;RES</td>
      <td>&lt;span class="pos pos29"&gt;RES</td>
      <td>&lt;span class="pos pos29"&gt;RES</td>
      <td>&lt;span class="pos pos29"&gt;RES</td>
      <td>&lt;span class="pos pos29"&gt;RES</td>
      <td>&lt;span class="pos pos29"&gt;RES</td>
    </tr>
    <tr>
      <th>Joined</th>
      <td>Jul 1, 2018</td>
      <td>Jan 30, 2020</td>
      <td>Sep 14, 2020</td>
      <td>Aug 30, 2015</td>
      <td>Sep 1, 2020</td>
      <td>Jul 1, 2015</td>
      <td>Jul 1, 2021</td>
      <td>Jul 22, 2021</td>
      <td>Feb 18, 2020</td>
      <td>Aug 7, 2019</td>
      <td>...</td>
      <td>Jun 14, 2020</td>
      <td>Feb 15, 2019</td>
      <td>Jul 1, 2020</td>
      <td>Jul 1, 2019</td>
      <td>Feb 7, 2022</td>
      <td>Apr 11, 2022</td>
      <td>Jan 1, 2022</td>
      <td>Jun 6, 2021</td>
      <td>Jan 1, 2020</td>
      <td>Jan 8, 2020</td>
    </tr>
    <tr>
      <th>Loaned From</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Contract Valid Until</th>
      <td>2026</td>
      <td>2026</td>
      <td>2024</td>
      <td>2025</td>
      <td>2026</td>
      <td>2025</td>
      <td>2026</td>
      <td>2024</td>
      <td>2024</td>
      <td>2027</td>
      <td>...</td>
      <td>2022</td>
      <td>2022</td>
      <td>2022</td>
      <td>2022</td>
      <td>2023</td>
      <td>2027</td>
      <td>2026</td>
      <td>2023</td>
      <td>2021</td>
      <td>2021</td>
    </tr>
    <tr>
      <th>Height</th>
      <td>189cm</td>
      <td>179cm</td>
      <td>172cm</td>
      <td>181cm</td>
      <td>172cm</td>
      <td>177cm</td>
      <td>180cm</td>
      <td>183cm</td>
      <td>186cm</td>
      <td>182cm</td>
      <td>...</td>
      <td>188cm</td>
      <td>186cm</td>
      <td>190cm</td>
      <td>195cm</td>
      <td>186cm</td>
      <td>190cm</td>
      <td>195cm</td>
      <td>190cm</td>
      <td>187cm</td>
      <td>186cm</td>
    </tr>
    <tr>
      <th>Weight</th>
      <td>82kg</td>
      <td>69kg</td>
      <td>69kg</td>
      <td>70kg</td>
      <td>68kg</td>
      <td>75kg</td>
      <td>78kg</td>
      <td>80kg</td>
      <td>86kg</td>
      <td>74kg</td>
      <td>...</td>
      <td>81kg</td>
      <td>78kg</td>
      <td>70kg</td>
      <td>80kg</td>
      <td>78kg</td>
      <td>78kg</td>
      <td>84kg</td>
      <td>82kg</td>
      <td>79kg</td>
      <td>78kg</td>
    </tr>
    <tr>
      <th>Release Clause</th>
      <td>€157M</td>
      <td>€155M</td>
      <td>€97.7M</td>
      <td>€198.9M</td>
      <td>€154.4M</td>
      <td>€182M</td>
      <td>€113.8M</td>
      <td>€48.5M</td>
      <td>€51.9M</td>
      <td>€152.6M</td>
      <td>...</td>
      <td>€218K</td>
      <td>€47K</td>
      <td>€356K</td>
      <td>€215K</td>
      <td>€488K</td>
      <td>€218K</td>
      <td>€188K</td>
      <td>€142K</td>
      <td>€214K</td>
      <td>€131K</td>
    </tr>
    <tr>
      <th>Kit Number</th>
      <td>8.0</td>
      <td>8.0</td>
      <td>19.0</td>
      <td>17.0</td>
      <td>23.0</td>
      <td>6.0</td>
      <td>4.0</td>
      <td>15.0</td>
      <td>23.0</td>
      <td>7.0</td>
      <td>...</td>
      <td>33.0</td>
      <td>1.0</td>
      <td>99.0</td>
      <td>27.0</td>
      <td>43.0</td>
      <td>35.0</td>
      <td>21.0</td>
      <td>12.0</td>
      <td>40.0</td>
      <td>30.0</td>
    </tr>
    <tr>
      <th>Best Overall Rating</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>29 rows × 17660 columns</p>
</div>
</div>
</div>
<p><code>-</code> column이름조사</p>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1"></a>df.keys()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<pre><code>Index(['ID', 'Name', 'Age', 'Photo', 'Nationality', 'Flag', 'Overall',
       'Potential', 'Club', 'Club Logo', 'Value', 'Wage', 'Special',
       'Preferred Foot', 'International Reputation', 'Weak Foot',
       'Skill Moves', 'Work Rate', 'Body Type', 'Real Face', 'Position',
       'Joined', 'Loaned From', 'Contract Valid Until', 'Height', 'Weight',
       'Release Clause', 'Kit Number', 'Best Overall Rating'],
      dtype='object')</code></pre>
</div>
</div>
<ul>
<li>이름에 space가 있어서 좀 거슬림</li>
</ul>
<p><code>-</code> 각 column 별로 자료형조사</p>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1"></a>pd.DataFrame({<span class="st">'colname'</span>:df.keys(), <span class="st">'dtype'</span>:[df[key].dtype <span class="cf">for</span> key <span class="kw">in</span> df.keys()]})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>colname</th>
      <th>dtype</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>ID</td>
      <td>int64</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Name</td>
      <td>object</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Age</td>
      <td>int64</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Photo</td>
      <td>object</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Nationality</td>
      <td>object</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Flag</td>
      <td>object</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Overall</td>
      <td>int64</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Potential</td>
      <td>int64</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Club</td>
      <td>object</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Club Logo</td>
      <td>object</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Value</td>
      <td>object</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Wage</td>
      <td>object</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Special</td>
      <td>int64</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Preferred Foot</td>
      <td>object</td>
    </tr>
    <tr>
      <th>14</th>
      <td>International Reputation</td>
      <td>float64</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Weak Foot</td>
      <td>float64</td>
    </tr>
    <tr>
      <th>16</th>
      <td>Skill Moves</td>
      <td>float64</td>
    </tr>
    <tr>
      <th>17</th>
      <td>Work Rate</td>
      <td>object</td>
    </tr>
    <tr>
      <th>18</th>
      <td>Body Type</td>
      <td>object</td>
    </tr>
    <tr>
      <th>19</th>
      <td>Real Face</td>
      <td>object</td>
    </tr>
    <tr>
      <th>20</th>
      <td>Position</td>
      <td>object</td>
    </tr>
    <tr>
      <th>21</th>
      <td>Joined</td>
      <td>object</td>
    </tr>
    <tr>
      <th>22</th>
      <td>Loaned From</td>
      <td>object</td>
    </tr>
    <tr>
      <th>23</th>
      <td>Contract Valid Until</td>
      <td>object</td>
    </tr>
    <tr>
      <th>24</th>
      <td>Height</td>
      <td>object</td>
    </tr>
    <tr>
      <th>25</th>
      <td>Weight</td>
      <td>object</td>
    </tr>
    <tr>
      <th>26</th>
      <td>Release Clause</td>
      <td>object</td>
    </tr>
    <tr>
      <th>27</th>
      <td>Kit Number</td>
      <td>float64</td>
    </tr>
    <tr>
      <th>28</th>
      <td>Best Overall Rating</td>
      <td>object</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p><code>-</code> 결측치조사</p>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1"></a>pd.DataFrame({<span class="st">'colname'</span>:df.keys(), </span>
<span id="cb25-2"><a href="#cb25-2"></a>              <span class="st">'dtype'</span>:[df[key].dtype <span class="cf">for</span> key <span class="kw">in</span> df.keys()],</span>
<span id="cb25-3"><a href="#cb25-3"></a>              <span class="st">'na'</span>:[df[key].isna().<span class="bu">sum</span>() <span class="cf">for</span> key <span class="kw">in</span> df.keys()]</span>
<span id="cb25-4"><a href="#cb25-4"></a>             })</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>colname</th>
      <th>dtype</th>
      <th>na</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>ID</td>
      <td>int64</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Name</td>
      <td>object</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Age</td>
      <td>int64</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Photo</td>
      <td>object</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Nationality</td>
      <td>object</td>
      <td>0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Flag</td>
      <td>object</td>
      <td>0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Overall</td>
      <td>int64</td>
      <td>0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Potential</td>
      <td>int64</td>
      <td>0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Club</td>
      <td>object</td>
      <td>211</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Club Logo</td>
      <td>object</td>
      <td>0</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Value</td>
      <td>object</td>
      <td>0</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Wage</td>
      <td>object</td>
      <td>0</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Special</td>
      <td>int64</td>
      <td>0</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Preferred Foot</td>
      <td>object</td>
      <td>0</td>
    </tr>
    <tr>
      <th>14</th>
      <td>International Reputation</td>
      <td>float64</td>
      <td>0</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Weak Foot</td>
      <td>float64</td>
      <td>0</td>
    </tr>
    <tr>
      <th>16</th>
      <td>Skill Moves</td>
      <td>float64</td>
      <td>0</td>
    </tr>
    <tr>
      <th>17</th>
      <td>Work Rate</td>
      <td>object</td>
      <td>0</td>
    </tr>
    <tr>
      <th>18</th>
      <td>Body Type</td>
      <td>object</td>
      <td>38</td>
    </tr>
    <tr>
      <th>19</th>
      <td>Real Face</td>
      <td>object</td>
      <td>38</td>
    </tr>
    <tr>
      <th>20</th>
      <td>Position</td>
      <td>object</td>
      <td>35</td>
    </tr>
    <tr>
      <th>21</th>
      <td>Joined</td>
      <td>object</td>
      <td>1098</td>
    </tr>
    <tr>
      <th>22</th>
      <td>Loaned From</td>
      <td>object</td>
      <td>16966</td>
    </tr>
    <tr>
      <th>23</th>
      <td>Contract Valid Until</td>
      <td>object</td>
      <td>361</td>
    </tr>
    <tr>
      <th>24</th>
      <td>Height</td>
      <td>object</td>
      <td>0</td>
    </tr>
    <tr>
      <th>25</th>
      <td>Weight</td>
      <td>object</td>
      <td>0</td>
    </tr>
    <tr>
      <th>26</th>
      <td>Release Clause</td>
      <td>object</td>
      <td>1151</td>
    </tr>
    <tr>
      <th>27</th>
      <td>Kit Number</td>
      <td>float64</td>
      <td>35</td>
    </tr>
    <tr>
      <th>28</th>
      <td>Best Overall Rating</td>
      <td>object</td>
      <td>17639</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>(퀴즈) 열의선택: 결측치가 10000개 이상인 열을 보고싶다면?</p>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1"></a>df.loc[:,[df[key].isna().<span class="bu">sum</span>()<span class="op">&gt;</span><span class="dv">10000</span> <span class="cf">for</span> key <span class="kw">in</span> df.keys()]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Loaned From</th>
      <th>Best Overall Rating</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>17655</th>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>17656</th>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>17657</th>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>17658</th>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>17659</th>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>17660 rows × 2 columns</p>
</div>
</div>
</div>
<p><code>-</code> .info()</p>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1"></a>df.info()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 17660 entries, 0 to 17659
Data columns (total 29 columns):
 #   Column                    Non-Null Count  Dtype  
---  ------                    --------------  -----  
 0   ID                        17660 non-null  int64  
 1   Name                      17660 non-null  object 
 2   Age                       17660 non-null  int64  
 3   Photo                     17660 non-null  object 
 4   Nationality               17660 non-null  object 
 5   Flag                      17660 non-null  object 
 6   Overall                   17660 non-null  int64  
 7   Potential                 17660 non-null  int64  
 8   Club                      17449 non-null  object 
 9   Club Logo                 17660 non-null  object 
 10  Value                     17660 non-null  object 
 11  Wage                      17660 non-null  object 
 12  Special                   17660 non-null  int64  
 13  Preferred Foot            17660 non-null  object 
 14  International Reputation  17660 non-null  float64
 15  Weak Foot                 17660 non-null  float64
 16  Skill Moves               17660 non-null  float64
 17  Work Rate                 17660 non-null  object 
 18  Body Type                 17622 non-null  object 
 19  Real Face                 17622 non-null  object 
 20  Position                  17625 non-null  object 
 21  Joined                    16562 non-null  object 
 22  Loaned From               694 non-null    object 
 23  Contract Valid Until      17299 non-null  object 
 24  Height                    17660 non-null  object 
 25  Weight                    17660 non-null  object 
 26  Release Clause            16509 non-null  object 
 27  Kit Number                17625 non-null  float64
 28  Best Overall Rating       21 non-null     object 
dtypes: float64(4), int64(5), object(20)
memory usage: 3.9+ MB</code></pre>
</div>
</div>
<p><code>-</code> .describe(): 숫자들이 저장된 column에 대하여 기본통계량 조사</p>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1"></a>df.describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>ID</th>
      <th>Age</th>
      <th>Overall</th>
      <th>Potential</th>
      <th>Special</th>
      <th>International Reputation</th>
      <th>Weak Foot</th>
      <th>Skill Moves</th>
      <th>Kit Number</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>17660.000000</td>
      <td>17660.000000</td>
      <td>17660.000000</td>
      <td>17660.000000</td>
      <td>17660.000000</td>
      <td>17660.000000</td>
      <td>17660.000000</td>
      <td>17660.000000</td>
      <td>17625.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>246319.424462</td>
      <td>23.127746</td>
      <td>63.369592</td>
      <td>70.981200</td>
      <td>1537.915855</td>
      <td>1.106285</td>
      <td>2.900340</td>
      <td>2.297169</td>
      <td>25.037957</td>
    </tr>
    <tr>
      <th>std</th>
      <td>31487.892861</td>
      <td>4.639821</td>
      <td>8.036268</td>
      <td>6.529836</td>
      <td>285.893809</td>
      <td>0.407021</td>
      <td>0.663523</td>
      <td>0.754264</td>
      <td>19.154116</td>
    </tr>
    <tr>
      <th>min</th>
      <td>16.000000</td>
      <td>15.000000</td>
      <td>43.000000</td>
      <td>42.000000</td>
      <td>749.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>240732.500000</td>
      <td>20.000000</td>
      <td>58.000000</td>
      <td>67.000000</td>
      <td>1387.000000</td>
      <td>1.000000</td>
      <td>3.000000</td>
      <td>2.000000</td>
      <td>11.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>257041.000000</td>
      <td>22.000000</td>
      <td>63.000000</td>
      <td>71.000000</td>
      <td>1548.000000</td>
      <td>1.000000</td>
      <td>3.000000</td>
      <td>2.000000</td>
      <td>22.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>263027.500000</td>
      <td>26.000000</td>
      <td>69.000000</td>
      <td>75.000000</td>
      <td>1727.000000</td>
      <td>1.000000</td>
      <td>3.000000</td>
      <td>3.000000</td>
      <td>32.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>271340.000000</td>
      <td>54.000000</td>
      <td>91.000000</td>
      <td>95.000000</td>
      <td>2312.000000</td>
      <td>5.000000</td>
      <td>5.000000</td>
      <td>5.000000</td>
      <td>99.000000</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p><code>-</code> pandas_profiling.ProfileReport()을 이용한 전체적인 조사</p>
<div class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1"></a><span class="co"># pandas_profiling.ProfileReport(df).to_file('fifa2023_reprot.html')</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>-</code> 특정열을 중심으로 정렬하여 보기</p>
<div class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1"></a>df.sort_values(by<span class="op">=</span><span class="st">'Overall'</span>,ascending<span class="op">=</span><span class="va">False</span>).reset_index()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="16">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>index</th>
      <th>ID</th>
      <th>Name</th>
      <th>Age</th>
      <th>Photo</th>
      <th>Nationality</th>
      <th>Flag</th>
      <th>Overall</th>
      <th>Potential</th>
      <th>Club</th>
      <th>...</th>
      <th>Real Face</th>
      <th>Position</th>
      <th>Joined</th>
      <th>Loaned From</th>
      <th>Contract Valid Until</th>
      <th>Height</th>
      <th>Weight</th>
      <th>Release Clause</th>
      <th>Kit Number</th>
      <th>Best Overall Rating</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>41</td>
      <td>188545</td>
      <td>R. Lewandowski</td>
      <td>33</td>
      <td>https://cdn.sofifa.net/players/188/545/23_60.png</td>
      <td>Poland</td>
      <td>https://cdn.sofifa.net/flags/pl.png</td>
      <td>91</td>
      <td>91</td>
      <td>FC Barcelona</td>
      <td>...</td>
      <td>Yes</td>
      <td>&lt;span class="pos pos25"&gt;ST</td>
      <td>Jul 18, 2022</td>
      <td>NaN</td>
      <td>2025</td>
      <td>185cm</td>
      <td>81kg</td>
      <td>€172.2M</td>
      <td>9.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>124</td>
      <td>165153</td>
      <td>K. Benzema</td>
      <td>34</td>
      <td>https://cdn.sofifa.net/players/165/153/23_60.png</td>
      <td>France</td>
      <td>https://cdn.sofifa.net/flags/fr.png</td>
      <td>91</td>
      <td>91</td>
      <td>Real Madrid CF</td>
      <td>...</td>
      <td>Yes</td>
      <td>&lt;span class="pos pos21"&gt;CF</td>
      <td>Jul 9, 2009</td>
      <td>NaN</td>
      <td>2023</td>
      <td>185cm</td>
      <td>81kg</td>
      <td>€131.2M</td>
      <td>9.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>192985</td>
      <td>K. De Bruyne</td>
      <td>31</td>
      <td>https://cdn.sofifa.net/players/192/985/23_60.png</td>
      <td>Belgium</td>
      <td>https://cdn.sofifa.net/flags/be.png</td>
      <td>91</td>
      <td>91</td>
      <td>Manchester City</td>
      <td>...</td>
      <td>Yes</td>
      <td>&lt;span class="pos pos13"&gt;RCM</td>
      <td>Aug 30, 2015</td>
      <td>NaN</td>
      <td>2025</td>
      <td>181cm</td>
      <td>70kg</td>
      <td>€198.9M</td>
      <td>17.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>56</td>
      <td>158023</td>
      <td>L. Messi</td>
      <td>35</td>
      <td>https://cdn.sofifa.net/players/158/023/23_60.png</td>
      <td>Argentina</td>
      <td>https://cdn.sofifa.net/flags/ar.png</td>
      <td>91</td>
      <td>91</td>
      <td>Paris Saint-Germain</td>
      <td>...</td>
      <td>Yes</td>
      <td>&lt;span class="pos pos23"&gt;RW</td>
      <td>Aug 10, 2021</td>
      <td>NaN</td>
      <td>2023</td>
      <td>169cm</td>
      <td>67kg</td>
      <td>€99.9M</td>
      <td>30.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>75</td>
      <td>231747</td>
      <td>K. Mbappé</td>
      <td>23</td>
      <td>https://cdn.sofifa.net/players/231/747/23_60.png</td>
      <td>France</td>
      <td>https://cdn.sofifa.net/flags/fr.png</td>
      <td>91</td>
      <td>95</td>
      <td>Paris Saint-Germain</td>
      <td>...</td>
      <td>Yes</td>
      <td>&lt;span class="pos pos25"&gt;ST</td>
      <td>Jul 1, 2018</td>
      <td>NaN</td>
      <td>2025</td>
      <td>182cm</td>
      <td>73kg</td>
      <td>€366.7M</td>
      <td>7.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>17655</th>
      <td>15513</td>
      <td>266751</td>
      <td>22&nbsp;Jung Ho Yeon</td>
      <td>20</td>
      <td>https://cdn.sofifa.net/players/266/751/22_60.png</td>
      <td>Korea Republic</td>
      <td>https://cdn.sofifa.net/flags/kr.png</td>
      <td>45</td>
      <td>53</td>
      <td>GwangJu FC</td>
      <td>...</td>
      <td>No</td>
      <td>&lt;span class="pos pos29"&gt;RES</td>
      <td>Jan 20, 2022</td>
      <td>NaN</td>
      <td>2026</td>
      <td>180cm</td>
      <td>73kg</td>
      <td>€145K</td>
      <td>23.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>17656</th>
      <td>16215</td>
      <td>268279</td>
      <td>22&nbsp;J. Looschen</td>
      <td>24</td>
      <td>https://cdn.sofifa.net/players/268/279/22_60.png</td>
      <td>Germany</td>
      <td>https://cdn.sofifa.net/flags/de.png</td>
      <td>44</td>
      <td>47</td>
      <td>SV Meppen</td>
      <td>...</td>
      <td>No</td>
      <td>&lt;span class="pos pos29"&gt;RES</td>
      <td>Mar 19, 2022</td>
      <td>NaN</td>
      <td>2026</td>
      <td>178cm</td>
      <td>78kg</td>
      <td>€92K</td>
      <td>42.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>17657</th>
      <td>16042</td>
      <td>255283</td>
      <td>20&nbsp;Kim Yeong Geun</td>
      <td>22</td>
      <td>https://cdn.sofifa.net/players/255/283/20_60.png</td>
      <td>Korea Republic</td>
      <td>https://cdn.sofifa.net/flags/kr.png</td>
      <td>44</td>
      <td>49</td>
      <td>Gyeongnam FC</td>
      <td>...</td>
      <td>No</td>
      <td>&lt;span class="pos pos29"&gt;RES</td>
      <td>Jan 9, 2020</td>
      <td>NaN</td>
      <td>2020</td>
      <td>174cm</td>
      <td>71kg</td>
      <td>€53K</td>
      <td>43.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>17658</th>
      <td>14634</td>
      <td>269038</td>
      <td>22&nbsp;Zhang Wenxuan</td>
      <td>16</td>
      <td>https://cdn.sofifa.net/players/269/038/22_60.png</td>
      <td>China PR</td>
      <td>https://cdn.sofifa.net/flags/cn.png</td>
      <td>44</td>
      <td>59</td>
      <td>Guangzhou FC</td>
      <td>...</td>
      <td>No</td>
      <td>&lt;span class="pos pos29"&gt;RES</td>
      <td>May 1, 2022</td>
      <td>NaN</td>
      <td>2022</td>
      <td>175cm</td>
      <td>70kg</td>
      <td>€239K</td>
      <td>29.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>17659</th>
      <td>17618</td>
      <td>168933</td>
      <td>07&nbsp;I. Paskov</td>
      <td>33</td>
      <td>https://cdn.sofifa.net/players/168/933/07_60.png</td>
      <td>Bulgaria</td>
      <td>https://cdn.sofifa.net/flags/bg.png</td>
      <td>43</td>
      <td>42</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>&lt;span class="pos pos28"&gt;SUB</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>184cm</td>
      <td>79kg</td>
      <td>NaN</td>
      <td>24.0</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>17660 rows × 30 columns</p>
</div>
</div>
</div>
<p><code>-</code> 특정열을 중심으로 그룹화하여 보기 (<span class="math inline">\(\star\)</span>)</p>
<div class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1"></a>df.Nationality.unique() <span class="co"># 데이터셋에 포함된 나라들 출력</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="17">
<pre><code>array(['Germany', 'Portugal', 'Argentina', 'Belgium', 'Italy', 'Austria',
       'Brazil', 'Croatia', 'Serbia', 'Spain', 'Netherlands', 'France',
       'Colombia', 'England', 'Uruguay', 'Morocco', 'Egypt', 'Algeria',
       'Ukraine', 'United States', "Côte d'Ivoire", 'Poland', 'Chile',
       'Senegal', 'Central African Republic', 'Denmark', 'Nigeria',
       'Mexico', 'Turkey', 'Canada', 'Wales', 'Scotland', 'Romania',
       'Czech Republic', 'Ghana', 'Korea Republic',
       'Bosnia and Herzegovina', 'Mali', 'Slovakia', 'Armenia', 'Norway',
       'Switzerland', 'Cameroon', 'Peru', 'Jamaica', 'Zambia', 'Guinea',
       'Sweden', 'North Macedonia', 'Russia', 'Tunisia', 'Malta',
       'Angola', 'Republic of Ireland', 'Ecuador', 'Benin', 'Paraguay',
       'Montenegro', 'Australia', 'Comoros', 'Gabon', 'Iceland',
       'Slovenia', 'Japan', 'Israel', 'China PR', 'Venezuela', 'Liberia',
       'Greece', 'Bulgaria', 'Honduras', 'Saudi Arabia', 'Curacao',
       'Northern Ireland', 'Guinea Bissau', 'Kosovo', 'Hungary',
       'Finland', 'Costa Rica', 'Albania', 'Congo DR', 'Iran',
       'Mozambique', 'Suriname', 'Cape Verde Islands', 'Bolivia',
       'Madagascar', 'New Zealand', 'Burkina Faso', 'Dominican Republic',
       'Kazakhstan', 'Syria', 'Luxembourg', 'Kenya', 'Zimbabwe', 'Haiti',
       'Uzbekistan', 'South Africa', 'Cyprus', 'Qatar',
       'Equatorial Guinea', 'Libya', 'Thailand', 'Togo',
       'Trinidad and Tobago', 'Liechtenstein', 'Gambia', 'Georgia',
       'Philippines', 'Burundi', 'United Arab Emirates', 'Grenada',
       'Iraq', 'Panama', 'Malaysia', 'Moldova', 'Congo', 'India',
       'Jordan', 'Kuwait', 'Antigua and Barbuda', 'Cuba', 'Vietnam',
       'Korea DPR', 'Uganda', 'Lithuania', 'Estonia', 'Montserrat',
       'Sierra Leone', 'Afghanistan', 'New Caledonia', 'Belarus', 'Laos',
       'Saint Lucia', 'Bhutan', 'Guyana', 'Mauritania', 'Faroe Islands',
       'Namibia', 'Niger', 'Palestine', 'Sudan', 'Azerbaijan',
       'Hong Kong', 'Gibraltar', 'Tanzania', 'Latvia', 'Chinese Taipei',
       'Singapore', 'Lebanon', 'El Salvador', 'Indonesia', 'Guatemala',
       'Papua New Guinea', 'Puerto Rico', 'Malawi', 'South Sudan',
       'Ethiopia', 'San Marino', 'Andorra', 'Saint Kitts and Nevis'],
      dtype=object)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1"></a>df.groupby(by<span class="op">=</span><span class="st">'Nationality'</span>)[[<span class="st">'Overall'</span>]].agg({np.mean,<span class="bu">len</span>}).sort_values((<span class="st">'Overall'</span>, <span class="st">'mean'</span>),ascending<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="18">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th colspan="2" halign="left">Overall</th>
    </tr>
    <tr>
      <th></th>
      <th>mean</th>
      <th>len</th>
    </tr>
    <tr>
      <th>Nationality</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Philippines</th>
      <td>74.000000</td>
      <td>1</td>
    </tr>
    <tr>
      <th>Namibia</th>
      <td>72.000000</td>
      <td>1</td>
    </tr>
    <tr>
      <th>Mozambique</th>
      <td>72.000000</td>
      <td>2</td>
    </tr>
    <tr>
      <th>Kuwait</th>
      <td>71.000000</td>
      <td>1</td>
    </tr>
    <tr>
      <th>Brazil</th>
      <td>70.556586</td>
      <td>539</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>San Marino</th>
      <td>53.000000</td>
      <td>1</td>
    </tr>
    <tr>
      <th>China PR</th>
      <td>52.230769</td>
      <td>325</td>
    </tr>
    <tr>
      <th>South Sudan</th>
      <td>52.000000</td>
      <td>5</td>
    </tr>
    <tr>
      <th>India</th>
      <td>51.994681</td>
      <td>188</td>
    </tr>
    <tr>
      <th>Saint Kitts and Nevis</th>
      <td>51.000000</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>161 rows × 2 columns</p>
</div>
</div>
</div>
<ul>
<li>groupby는 나중에 다시 설명 합니다.</li>
</ul>
</section>
<section id="데이터정리하기" class="level2">
<h2 class="anchored" data-anchor-id="데이터정리하기">데이터정리하기</h2>
<p><code>-</code> 칼럼이름변경</p>
<div class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1"></a>df.set_axis(pd.Index(<span class="bu">map</span>(<span class="kw">lambda</span> x: x.replace(<span class="st">' '</span>,<span class="st">'_'</span>), df.columns)), axis<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="19">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>ID</th>
      <th>Name</th>
      <th>Age</th>
      <th>Photo</th>
      <th>Nationality</th>
      <th>Flag</th>
      <th>Overall</th>
      <th>Potential</th>
      <th>Club</th>
      <th>Club_Logo</th>
      <th>...</th>
      <th>Real_Face</th>
      <th>Position</th>
      <th>Joined</th>
      <th>Loaned_From</th>
      <th>Contract_Valid_Until</th>
      <th>Height</th>
      <th>Weight</th>
      <th>Release_Clause</th>
      <th>Kit_Number</th>
      <th>Best_Overall_Rating</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>209658</td>
      <td>L. Goretzka</td>
      <td>27</td>
      <td>https://cdn.sofifa.net/players/209/658/23_60.png</td>
      <td>Germany</td>
      <td>https://cdn.sofifa.net/flags/de.png</td>
      <td>87</td>
      <td>88</td>
      <td>FC Bayern München</td>
      <td>https://cdn.sofifa.net/teams/21/30.png</td>
      <td>...</td>
      <td>Yes</td>
      <td>&lt;span class="pos pos28"&gt;SUB</td>
      <td>Jul 1, 2018</td>
      <td>NaN</td>
      <td>2026</td>
      <td>189cm</td>
      <td>82kg</td>
      <td>€157M</td>
      <td>8.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>212198</td>
      <td>Bruno Fernandes</td>
      <td>27</td>
      <td>https://cdn.sofifa.net/players/212/198/23_60.png</td>
      <td>Portugal</td>
      <td>https://cdn.sofifa.net/flags/pt.png</td>
      <td>86</td>
      <td>87</td>
      <td>Manchester United</td>
      <td>https://cdn.sofifa.net/teams/11/30.png</td>
      <td>...</td>
      <td>Yes</td>
      <td>&lt;span class="pos pos15"&gt;LCM</td>
      <td>Jan 30, 2020</td>
      <td>NaN</td>
      <td>2026</td>
      <td>179cm</td>
      <td>69kg</td>
      <td>€155M</td>
      <td>8.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>224334</td>
      <td>M. Acuña</td>
      <td>30</td>
      <td>https://cdn.sofifa.net/players/224/334/23_60.png</td>
      <td>Argentina</td>
      <td>https://cdn.sofifa.net/flags/ar.png</td>
      <td>85</td>
      <td>85</td>
      <td>Sevilla FC</td>
      <td>https://cdn.sofifa.net/teams/481/30.png</td>
      <td>...</td>
      <td>No</td>
      <td>&lt;span class="pos pos7"&gt;LB</td>
      <td>Sep 14, 2020</td>
      <td>NaN</td>
      <td>2024</td>
      <td>172cm</td>
      <td>69kg</td>
      <td>€97.7M</td>
      <td>19.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>192985</td>
      <td>K. De Bruyne</td>
      <td>31</td>
      <td>https://cdn.sofifa.net/players/192/985/23_60.png</td>
      <td>Belgium</td>
      <td>https://cdn.sofifa.net/flags/be.png</td>
      <td>91</td>
      <td>91</td>
      <td>Manchester City</td>
      <td>https://cdn.sofifa.net/teams/10/30.png</td>
      <td>...</td>
      <td>Yes</td>
      <td>&lt;span class="pos pos13"&gt;RCM</td>
      <td>Aug 30, 2015</td>
      <td>NaN</td>
      <td>2025</td>
      <td>181cm</td>
      <td>70kg</td>
      <td>€198.9M</td>
      <td>17.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>224232</td>
      <td>N. Barella</td>
      <td>25</td>
      <td>https://cdn.sofifa.net/players/224/232/23_60.png</td>
      <td>Italy</td>
      <td>https://cdn.sofifa.net/flags/it.png</td>
      <td>86</td>
      <td>89</td>
      <td>Inter</td>
      <td>https://cdn.sofifa.net/teams/44/30.png</td>
      <td>...</td>
      <td>Yes</td>
      <td>&lt;span class="pos pos13"&gt;RCM</td>
      <td>Sep 1, 2020</td>
      <td>NaN</td>
      <td>2026</td>
      <td>172cm</td>
      <td>68kg</td>
      <td>€154.4M</td>
      <td>23.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>17655</th>
      <td>269526</td>
      <td>Deng Xiongtao</td>
      <td>19</td>
      <td>https://cdn.sofifa.net/players/269/526/23_60.png</td>
      <td>China PR</td>
      <td>https://cdn.sofifa.net/flags/cn.png</td>
      <td>48</td>
      <td>61</td>
      <td>Meizhou Hakka</td>
      <td>https://cdn.sofifa.net/teams/114628/30.png</td>
      <td>...</td>
      <td>No</td>
      <td>&lt;span class="pos pos29"&gt;RES</td>
      <td>Apr 11, 2022</td>
      <td>NaN</td>
      <td>2027</td>
      <td>190cm</td>
      <td>78kg</td>
      <td>€218K</td>
      <td>35.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>17656</th>
      <td>267946</td>
      <td>22&nbsp;Lim Jun Sub</td>
      <td>17</td>
      <td>https://cdn.sofifa.net/players/267/946/22_60.png</td>
      <td>Korea Republic</td>
      <td>https://cdn.sofifa.net/flags/kr.png</td>
      <td>48</td>
      <td>64</td>
      <td>Jeju United FC</td>
      <td>https://cdn.sofifa.net/teams/1478/30.png</td>
      <td>...</td>
      <td>No</td>
      <td>&lt;span class="pos pos29"&gt;RES</td>
      <td>Jan 1, 2022</td>
      <td>NaN</td>
      <td>2026</td>
      <td>195cm</td>
      <td>84kg</td>
      <td>€188K</td>
      <td>21.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>17657</th>
      <td>270567</td>
      <td>A. Demir</td>
      <td>25</td>
      <td>https://cdn.sofifa.net/players/270/567/23_60.png</td>
      <td>Turkey</td>
      <td>https://cdn.sofifa.net/flags/tr.png</td>
      <td>51</td>
      <td>56</td>
      <td>Ümraniyespor</td>
      <td>https://cdn.sofifa.net/teams/113796/30.png</td>
      <td>...</td>
      <td>No</td>
      <td>&lt;span class="pos pos29"&gt;RES</td>
      <td>Jun 6, 2021</td>
      <td>NaN</td>
      <td>2023</td>
      <td>190cm</td>
      <td>82kg</td>
      <td>€142K</td>
      <td>12.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>17658</th>
      <td>256624</td>
      <td>21&nbsp;S. Czajor</td>
      <td>18</td>
      <td>https://cdn.sofifa.net/players/256/624/21_60.png</td>
      <td>Poland</td>
      <td>https://cdn.sofifa.net/flags/pl.png</td>
      <td>50</td>
      <td>65</td>
      <td>Fleetwood Town</td>
      <td>https://cdn.sofifa.net/teams/112260/30.png</td>
      <td>...</td>
      <td>No</td>
      <td>&lt;span class="pos pos29"&gt;RES</td>
      <td>Jan 1, 2020</td>
      <td>NaN</td>
      <td>2021</td>
      <td>187cm</td>
      <td>79kg</td>
      <td>€214K</td>
      <td>40.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>17659</th>
      <td>256376</td>
      <td>21&nbsp;F. Jakobsson</td>
      <td>20</td>
      <td>https://cdn.sofifa.net/players/256/376/21_60.png</td>
      <td>Sweden</td>
      <td>https://cdn.sofifa.net/flags/se.png</td>
      <td>50</td>
      <td>61</td>
      <td>IFK Norrköping</td>
      <td>https://cdn.sofifa.net/teams/702/30.png</td>
      <td>...</td>
      <td>No</td>
      <td>&lt;span class="pos pos29"&gt;RES</td>
      <td>Jan 8, 2020</td>
      <td>NaN</td>
      <td>2021</td>
      <td>186cm</td>
      <td>78kg</td>
      <td>€131K</td>
      <td>30.0</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>17660 rows × 29 columns</p>
</div>
</div>
</div>
<p><code>-</code> 결측치제거</p>
<div class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1"></a>df.drop(columns<span class="op">=</span>[<span class="st">'Loaned From'</span>, <span class="st">'Best Overall Rating'</span>]).dropna()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="20">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>ID</th>
      <th>Name</th>
      <th>Age</th>
      <th>Photo</th>
      <th>Nationality</th>
      <th>Flag</th>
      <th>Overall</th>
      <th>Potential</th>
      <th>Club</th>
      <th>Club Logo</th>
      <th>...</th>
      <th>Work Rate</th>
      <th>Body Type</th>
      <th>Real Face</th>
      <th>Position</th>
      <th>Joined</th>
      <th>Contract Valid Until</th>
      <th>Height</th>
      <th>Weight</th>
      <th>Release Clause</th>
      <th>Kit Number</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>209658</td>
      <td>L. Goretzka</td>
      <td>27</td>
      <td>https://cdn.sofifa.net/players/209/658/23_60.png</td>
      <td>Germany</td>
      <td>https://cdn.sofifa.net/flags/de.png</td>
      <td>87</td>
      <td>88</td>
      <td>FC Bayern München</td>
      <td>https://cdn.sofifa.net/teams/21/30.png</td>
      <td>...</td>
      <td>High/ Medium</td>
      <td>Unique</td>
      <td>Yes</td>
      <td>&lt;span class="pos pos28"&gt;SUB</td>
      <td>Jul 1, 2018</td>
      <td>2026</td>
      <td>189cm</td>
      <td>82kg</td>
      <td>€157M</td>
      <td>8.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>212198</td>
      <td>Bruno Fernandes</td>
      <td>27</td>
      <td>https://cdn.sofifa.net/players/212/198/23_60.png</td>
      <td>Portugal</td>
      <td>https://cdn.sofifa.net/flags/pt.png</td>
      <td>86</td>
      <td>87</td>
      <td>Manchester United</td>
      <td>https://cdn.sofifa.net/teams/11/30.png</td>
      <td>...</td>
      <td>High/ High</td>
      <td>Unique</td>
      <td>Yes</td>
      <td>&lt;span class="pos pos15"&gt;LCM</td>
      <td>Jan 30, 2020</td>
      <td>2026</td>
      <td>179cm</td>
      <td>69kg</td>
      <td>€155M</td>
      <td>8.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>224334</td>
      <td>M. Acuña</td>
      <td>30</td>
      <td>https://cdn.sofifa.net/players/224/334/23_60.png</td>
      <td>Argentina</td>
      <td>https://cdn.sofifa.net/flags/ar.png</td>
      <td>85</td>
      <td>85</td>
      <td>Sevilla FC</td>
      <td>https://cdn.sofifa.net/teams/481/30.png</td>
      <td>...</td>
      <td>High/ High</td>
      <td>Stocky (170-185)</td>
      <td>No</td>
      <td>&lt;span class="pos pos7"&gt;LB</td>
      <td>Sep 14, 2020</td>
      <td>2024</td>
      <td>172cm</td>
      <td>69kg</td>
      <td>€97.7M</td>
      <td>19.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>192985</td>
      <td>K. De Bruyne</td>
      <td>31</td>
      <td>https://cdn.sofifa.net/players/192/985/23_60.png</td>
      <td>Belgium</td>
      <td>https://cdn.sofifa.net/flags/be.png</td>
      <td>91</td>
      <td>91</td>
      <td>Manchester City</td>
      <td>https://cdn.sofifa.net/teams/10/30.png</td>
      <td>...</td>
      <td>High/ High</td>
      <td>Unique</td>
      <td>Yes</td>
      <td>&lt;span class="pos pos13"&gt;RCM</td>
      <td>Aug 30, 2015</td>
      <td>2025</td>
      <td>181cm</td>
      <td>70kg</td>
      <td>€198.9M</td>
      <td>17.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>224232</td>
      <td>N. Barella</td>
      <td>25</td>
      <td>https://cdn.sofifa.net/players/224/232/23_60.png</td>
      <td>Italy</td>
      <td>https://cdn.sofifa.net/flags/it.png</td>
      <td>86</td>
      <td>89</td>
      <td>Inter</td>
      <td>https://cdn.sofifa.net/teams/44/30.png</td>
      <td>...</td>
      <td>High/ High</td>
      <td>Normal (170-)</td>
      <td>Yes</td>
      <td>&lt;span class="pos pos13"&gt;RCM</td>
      <td>Sep 1, 2020</td>
      <td>2026</td>
      <td>172cm</td>
      <td>68kg</td>
      <td>€154.4M</td>
      <td>23.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>17655</th>
      <td>269526</td>
      <td>Deng Xiongtao</td>
      <td>19</td>
      <td>https://cdn.sofifa.net/players/269/526/23_60.png</td>
      <td>China PR</td>
      <td>https://cdn.sofifa.net/flags/cn.png</td>
      <td>48</td>
      <td>61</td>
      <td>Meizhou Hakka</td>
      <td>https://cdn.sofifa.net/teams/114628/30.png</td>
      <td>...</td>
      <td>Medium/ Medium</td>
      <td>Normal (185+)</td>
      <td>No</td>
      <td>&lt;span class="pos pos29"&gt;RES</td>
      <td>Apr 11, 2022</td>
      <td>2027</td>
      <td>190cm</td>
      <td>78kg</td>
      <td>€218K</td>
      <td>35.0</td>
    </tr>
    <tr>
      <th>17656</th>
      <td>267946</td>
      <td>22&nbsp;Lim Jun Sub</td>
      <td>17</td>
      <td>https://cdn.sofifa.net/players/267/946/22_60.png</td>
      <td>Korea Republic</td>
      <td>https://cdn.sofifa.net/flags/kr.png</td>
      <td>48</td>
      <td>64</td>
      <td>Jeju United FC</td>
      <td>https://cdn.sofifa.net/teams/1478/30.png</td>
      <td>...</td>
      <td>Medium/ Medium</td>
      <td>Lean (185+)</td>
      <td>No</td>
      <td>&lt;span class="pos pos29"&gt;RES</td>
      <td>Jan 1, 2022</td>
      <td>2026</td>
      <td>195cm</td>
      <td>84kg</td>
      <td>€188K</td>
      <td>21.0</td>
    </tr>
    <tr>
      <th>17657</th>
      <td>270567</td>
      <td>A. Demir</td>
      <td>25</td>
      <td>https://cdn.sofifa.net/players/270/567/23_60.png</td>
      <td>Turkey</td>
      <td>https://cdn.sofifa.net/flags/tr.png</td>
      <td>51</td>
      <td>56</td>
      <td>Ümraniyespor</td>
      <td>https://cdn.sofifa.net/teams/113796/30.png</td>
      <td>...</td>
      <td>Medium/ Medium</td>
      <td>Lean (185+)</td>
      <td>No</td>
      <td>&lt;span class="pos pos29"&gt;RES</td>
      <td>Jun 6, 2021</td>
      <td>2023</td>
      <td>190cm</td>
      <td>82kg</td>
      <td>€142K</td>
      <td>12.0</td>
    </tr>
    <tr>
      <th>17658</th>
      <td>256624</td>
      <td>21&nbsp;S. Czajor</td>
      <td>18</td>
      <td>https://cdn.sofifa.net/players/256/624/21_60.png</td>
      <td>Poland</td>
      <td>https://cdn.sofifa.net/flags/pl.png</td>
      <td>50</td>
      <td>65</td>
      <td>Fleetwood Town</td>
      <td>https://cdn.sofifa.net/teams/112260/30.png</td>
      <td>...</td>
      <td>Medium/ Medium</td>
      <td>Normal (185+)</td>
      <td>No</td>
      <td>&lt;span class="pos pos29"&gt;RES</td>
      <td>Jan 1, 2020</td>
      <td>2021</td>
      <td>187cm</td>
      <td>79kg</td>
      <td>€214K</td>
      <td>40.0</td>
    </tr>
    <tr>
      <th>17659</th>
      <td>256376</td>
      <td>21&nbsp;F. Jakobsson</td>
      <td>20</td>
      <td>https://cdn.sofifa.net/players/256/376/21_60.png</td>
      <td>Sweden</td>
      <td>https://cdn.sofifa.net/flags/se.png</td>
      <td>50</td>
      <td>61</td>
      <td>IFK Norrköping</td>
      <td>https://cdn.sofifa.net/teams/702/30.png</td>
      <td>...</td>
      <td>Medium/ Medium</td>
      <td>Normal (185+)</td>
      <td>No</td>
      <td>&lt;span class="pos pos29"&gt;RES</td>
      <td>Jan 8, 2020</td>
      <td>2021</td>
      <td>186cm</td>
      <td>78kg</td>
      <td>€131K</td>
      <td>30.0</td>
    </tr>
  </tbody>
</table>
<p>16364 rows × 27 columns</p>
</div>
</div>
</div>
<p><code>-</code> Height, Weight의 자료형을 float형으로 수정하기</p>
<div class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1"></a>df.assign(</span>
<span id="cb37-2"><a href="#cb37-2"></a>    Height<span class="op">=</span> <span class="bu">list</span>(<span class="bu">map</span>(<span class="kw">lambda</span> x: <span class="bu">float</span>(x[:<span class="op">-</span><span class="dv">2</span>]), df.Height)),</span>
<span id="cb37-3"><a href="#cb37-3"></a>    Weight<span class="op">=</span> <span class="bu">list</span>(<span class="bu">map</span>(<span class="kw">lambda</span> x: <span class="bu">float</span>(x[:<span class="op">-</span><span class="dv">2</span>]), df.Weight))</span>
<span id="cb37-4"><a href="#cb37-4"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="21">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>ID</th>
      <th>Name</th>
      <th>Age</th>
      <th>Photo</th>
      <th>Nationality</th>
      <th>Flag</th>
      <th>Overall</th>
      <th>Potential</th>
      <th>Club</th>
      <th>Club Logo</th>
      <th>...</th>
      <th>Real Face</th>
      <th>Position</th>
      <th>Joined</th>
      <th>Loaned From</th>
      <th>Contract Valid Until</th>
      <th>Height</th>
      <th>Weight</th>
      <th>Release Clause</th>
      <th>Kit Number</th>
      <th>Best Overall Rating</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>209658</td>
      <td>L. Goretzka</td>
      <td>27</td>
      <td>https://cdn.sofifa.net/players/209/658/23_60.png</td>
      <td>Germany</td>
      <td>https://cdn.sofifa.net/flags/de.png</td>
      <td>87</td>
      <td>88</td>
      <td>FC Bayern München</td>
      <td>https://cdn.sofifa.net/teams/21/30.png</td>
      <td>...</td>
      <td>Yes</td>
      <td>&lt;span class="pos pos28"&gt;SUB</td>
      <td>Jul 1, 2018</td>
      <td>NaN</td>
      <td>2026</td>
      <td>189.0</td>
      <td>82.0</td>
      <td>€157M</td>
      <td>8.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>212198</td>
      <td>Bruno Fernandes</td>
      <td>27</td>
      <td>https://cdn.sofifa.net/players/212/198/23_60.png</td>
      <td>Portugal</td>
      <td>https://cdn.sofifa.net/flags/pt.png</td>
      <td>86</td>
      <td>87</td>
      <td>Manchester United</td>
      <td>https://cdn.sofifa.net/teams/11/30.png</td>
      <td>...</td>
      <td>Yes</td>
      <td>&lt;span class="pos pos15"&gt;LCM</td>
      <td>Jan 30, 2020</td>
      <td>NaN</td>
      <td>2026</td>
      <td>179.0</td>
      <td>69.0</td>
      <td>€155M</td>
      <td>8.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>224334</td>
      <td>M. Acuña</td>
      <td>30</td>
      <td>https://cdn.sofifa.net/players/224/334/23_60.png</td>
      <td>Argentina</td>
      <td>https://cdn.sofifa.net/flags/ar.png</td>
      <td>85</td>
      <td>85</td>
      <td>Sevilla FC</td>
      <td>https://cdn.sofifa.net/teams/481/30.png</td>
      <td>...</td>
      <td>No</td>
      <td>&lt;span class="pos pos7"&gt;LB</td>
      <td>Sep 14, 2020</td>
      <td>NaN</td>
      <td>2024</td>
      <td>172.0</td>
      <td>69.0</td>
      <td>€97.7M</td>
      <td>19.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>192985</td>
      <td>K. De Bruyne</td>
      <td>31</td>
      <td>https://cdn.sofifa.net/players/192/985/23_60.png</td>
      <td>Belgium</td>
      <td>https://cdn.sofifa.net/flags/be.png</td>
      <td>91</td>
      <td>91</td>
      <td>Manchester City</td>
      <td>https://cdn.sofifa.net/teams/10/30.png</td>
      <td>...</td>
      <td>Yes</td>
      <td>&lt;span class="pos pos13"&gt;RCM</td>
      <td>Aug 30, 2015</td>
      <td>NaN</td>
      <td>2025</td>
      <td>181.0</td>
      <td>70.0</td>
      <td>€198.9M</td>
      <td>17.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>224232</td>
      <td>N. Barella</td>
      <td>25</td>
      <td>https://cdn.sofifa.net/players/224/232/23_60.png</td>
      <td>Italy</td>
      <td>https://cdn.sofifa.net/flags/it.png</td>
      <td>86</td>
      <td>89</td>
      <td>Inter</td>
      <td>https://cdn.sofifa.net/teams/44/30.png</td>
      <td>...</td>
      <td>Yes</td>
      <td>&lt;span class="pos pos13"&gt;RCM</td>
      <td>Sep 1, 2020</td>
      <td>NaN</td>
      <td>2026</td>
      <td>172.0</td>
      <td>68.0</td>
      <td>€154.4M</td>
      <td>23.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>17655</th>
      <td>269526</td>
      <td>Deng Xiongtao</td>
      <td>19</td>
      <td>https://cdn.sofifa.net/players/269/526/23_60.png</td>
      <td>China PR</td>
      <td>https://cdn.sofifa.net/flags/cn.png</td>
      <td>48</td>
      <td>61</td>
      <td>Meizhou Hakka</td>
      <td>https://cdn.sofifa.net/teams/114628/30.png</td>
      <td>...</td>
      <td>No</td>
      <td>&lt;span class="pos pos29"&gt;RES</td>
      <td>Apr 11, 2022</td>
      <td>NaN</td>
      <td>2027</td>
      <td>190.0</td>
      <td>78.0</td>
      <td>€218K</td>
      <td>35.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>17656</th>
      <td>267946</td>
      <td>22&nbsp;Lim Jun Sub</td>
      <td>17</td>
      <td>https://cdn.sofifa.net/players/267/946/22_60.png</td>
      <td>Korea Republic</td>
      <td>https://cdn.sofifa.net/flags/kr.png</td>
      <td>48</td>
      <td>64</td>
      <td>Jeju United FC</td>
      <td>https://cdn.sofifa.net/teams/1478/30.png</td>
      <td>...</td>
      <td>No</td>
      <td>&lt;span class="pos pos29"&gt;RES</td>
      <td>Jan 1, 2022</td>
      <td>NaN</td>
      <td>2026</td>
      <td>195.0</td>
      <td>84.0</td>
      <td>€188K</td>
      <td>21.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>17657</th>
      <td>270567</td>
      <td>A. Demir</td>
      <td>25</td>
      <td>https://cdn.sofifa.net/players/270/567/23_60.png</td>
      <td>Turkey</td>
      <td>https://cdn.sofifa.net/flags/tr.png</td>
      <td>51</td>
      <td>56</td>
      <td>Ümraniyespor</td>
      <td>https://cdn.sofifa.net/teams/113796/30.png</td>
      <td>...</td>
      <td>No</td>
      <td>&lt;span class="pos pos29"&gt;RES</td>
      <td>Jun 6, 2021</td>
      <td>NaN</td>
      <td>2023</td>
      <td>190.0</td>
      <td>82.0</td>
      <td>€142K</td>
      <td>12.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>17658</th>
      <td>256624</td>
      <td>21&nbsp;S. Czajor</td>
      <td>18</td>
      <td>https://cdn.sofifa.net/players/256/624/21_60.png</td>
      <td>Poland</td>
      <td>https://cdn.sofifa.net/flags/pl.png</td>
      <td>50</td>
      <td>65</td>
      <td>Fleetwood Town</td>
      <td>https://cdn.sofifa.net/teams/112260/30.png</td>
      <td>...</td>
      <td>No</td>
      <td>&lt;span class="pos pos29"&gt;RES</td>
      <td>Jan 1, 2020</td>
      <td>NaN</td>
      <td>2021</td>
      <td>187.0</td>
      <td>79.0</td>
      <td>€214K</td>
      <td>40.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>17659</th>
      <td>256376</td>
      <td>21&nbsp;F. Jakobsson</td>
      <td>20</td>
      <td>https://cdn.sofifa.net/players/256/376/21_60.png</td>
      <td>Sweden</td>
      <td>https://cdn.sofifa.net/flags/se.png</td>
      <td>50</td>
      <td>61</td>
      <td>IFK Norrköping</td>
      <td>https://cdn.sofifa.net/teams/702/30.png</td>
      <td>...</td>
      <td>No</td>
      <td>&lt;span class="pos pos29"&gt;RES</td>
      <td>Jan 8, 2020</td>
      <td>NaN</td>
      <td>2021</td>
      <td>186.0</td>
      <td>78.0</td>
      <td>€131K</td>
      <td>30.0</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>17660 rows × 29 columns</p>
</div>
</div>
</div>
<p><code>-</code> Release Clause의 자료형을 float으로 수정하기</p>
<div class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1"></a>df[<span class="st">'Release Clause'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="22">
<pre><code>0          €157M
1          €155M
2         €97.7M
3        €198.9M
4        €154.4M
          ...   
17655      €218K
17656      €188K
17657      €142K
17658      €214K
17659      €131K
Name: Release Clause, Length: 17660, dtype: object</code></pre>
</div>
</div>
<div class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1"></a>_f <span class="op">=</span> <span class="kw">lambda</span> x: <span class="bu">float</span>(x[<span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>])<span class="op">*</span><span class="dv">1000</span> <span class="cf">if</span> x[<span class="op">-</span><span class="dv">1</span>]<span class="op">==</span><span class="st">'K'</span> <span class="cf">else</span> <span class="bu">float</span>(x[<span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>])<span class="op">*</span><span class="dv">1000000</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1"></a>_f(<span class="st">'€157M'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="24">
<pre><code>157000000.0</code></pre>
</div>
</div>
<div class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1"></a>_f(<span class="st">'€131K'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="25">
<pre><code>131000.0</code></pre>
</div>
</div>
<p>(시도1–실패)</p>
<div class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1"></a><span class="bu">list</span>(<span class="bu">map</span>(_f,df[<span class="st">'Release Clause'</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>TypeError: 'float' object is not subscriptable</code></pre>
</div>
</div>
<p>(시도1이 실패한 이유)</p>
<div class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1"></a>df[<span class="st">'Release Clause'</span>].isna().<span class="bu">sum</span>() <span class="co"># 이 column에는 1151개의 결측치가 존재</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="27">
<pre><code>1151</code></pre>
</div>
</div>
<p>(nan에 대한 예비학습)</p>
<div class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1"></a>df.loc[df[<span class="st">'Release Clause'</span>].isna(), <span class="st">'Release Clause'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="28">
<pre><code>18       NaN
34       NaN
38       NaN
49       NaN
50       NaN
        ... 
17378    NaN
17386    NaN
17535    NaN
17590    NaN
17618    NaN
Name: Release Clause, Length: 1151, dtype: object</code></pre>
</div>
</div>
<div class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1"></a>df.loc[<span class="dv">18</span>, <span class="st">'Release Clause'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="29">
<pre><code>nan</code></pre>
</div>
</div>
<div class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1"></a>pd.isna(df.loc[<span class="dv">18</span>, <span class="st">'Release Clause'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="30">
<pre><code>True</code></pre>
</div>
</div>
<div class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1"></a><span class="bu">type</span>(df.loc[<span class="dv">18</span>, <span class="st">'Release Clause'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="31">
<pre><code>float</code></pre>
</div>
</div>
<div class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1"></a>df.loc[<span class="dv">18</span>, <span class="st">'Release Clause'</span>][<span class="op">-</span><span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>TypeError: 'float' object is not subscriptable</code></pre>
</div>
</div>
<p>(시도2–성공)</p>
<div class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1"></a>df.rename(columns<span class="op">=</span>{<span class="st">'Release Clause'</span>:<span class="st">'ReleaseClause'</span>})<span class="op">\</span></span>
<span id="cb59-2"><a href="#cb59-2"></a>.assign(ReleaseClause <span class="op">=</span> <span class="bu">list</span>(<span class="bu">map</span>(<span class="kw">lambda</span> x: _f(x) <span class="cf">if</span> pd.isna(x)<span class="op">==</span><span class="va">False</span> <span class="cf">else</span> x , df[<span class="st">'Release Clause'</span>])))<span class="op">\</span></span>
<span id="cb59-3"><a href="#cb59-3"></a>.rename(columns<span class="op">=</span>{<span class="st">'ReleaseClause'</span>:<span class="st">'Release Clause'</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="33">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>ID</th>
      <th>Name</th>
      <th>Age</th>
      <th>Photo</th>
      <th>Nationality</th>
      <th>Flag</th>
      <th>Overall</th>
      <th>Potential</th>
      <th>Club</th>
      <th>Club Logo</th>
      <th>...</th>
      <th>Real Face</th>
      <th>Position</th>
      <th>Joined</th>
      <th>Loaned From</th>
      <th>Contract Valid Until</th>
      <th>Height</th>
      <th>Weight</th>
      <th>Release Clause</th>
      <th>Kit Number</th>
      <th>Best Overall Rating</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>209658</td>
      <td>L. Goretzka</td>
      <td>27</td>
      <td>https://cdn.sofifa.net/players/209/658/23_60.png</td>
      <td>Germany</td>
      <td>https://cdn.sofifa.net/flags/de.png</td>
      <td>87</td>
      <td>88</td>
      <td>FC Bayern München</td>
      <td>https://cdn.sofifa.net/teams/21/30.png</td>
      <td>...</td>
      <td>Yes</td>
      <td>&lt;span class="pos pos28"&gt;SUB</td>
      <td>Jul 1, 2018</td>
      <td>NaN</td>
      <td>2026</td>
      <td>189cm</td>
      <td>82kg</td>
      <td>157000000.0</td>
      <td>8.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>212198</td>
      <td>Bruno Fernandes</td>
      <td>27</td>
      <td>https://cdn.sofifa.net/players/212/198/23_60.png</td>
      <td>Portugal</td>
      <td>https://cdn.sofifa.net/flags/pt.png</td>
      <td>86</td>
      <td>87</td>
      <td>Manchester United</td>
      <td>https://cdn.sofifa.net/teams/11/30.png</td>
      <td>...</td>
      <td>Yes</td>
      <td>&lt;span class="pos pos15"&gt;LCM</td>
      <td>Jan 30, 2020</td>
      <td>NaN</td>
      <td>2026</td>
      <td>179cm</td>
      <td>69kg</td>
      <td>155000000.0</td>
      <td>8.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>224334</td>
      <td>M. Acuña</td>
      <td>30</td>
      <td>https://cdn.sofifa.net/players/224/334/23_60.png</td>
      <td>Argentina</td>
      <td>https://cdn.sofifa.net/flags/ar.png</td>
      <td>85</td>
      <td>85</td>
      <td>Sevilla FC</td>
      <td>https://cdn.sofifa.net/teams/481/30.png</td>
      <td>...</td>
      <td>No</td>
      <td>&lt;span class="pos pos7"&gt;LB</td>
      <td>Sep 14, 2020</td>
      <td>NaN</td>
      <td>2024</td>
      <td>172cm</td>
      <td>69kg</td>
      <td>97700000.0</td>
      <td>19.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>192985</td>
      <td>K. De Bruyne</td>
      <td>31</td>
      <td>https://cdn.sofifa.net/players/192/985/23_60.png</td>
      <td>Belgium</td>
      <td>https://cdn.sofifa.net/flags/be.png</td>
      <td>91</td>
      <td>91</td>
      <td>Manchester City</td>
      <td>https://cdn.sofifa.net/teams/10/30.png</td>
      <td>...</td>
      <td>Yes</td>
      <td>&lt;span class="pos pos13"&gt;RCM</td>
      <td>Aug 30, 2015</td>
      <td>NaN</td>
      <td>2025</td>
      <td>181cm</td>
      <td>70kg</td>
      <td>198900000.0</td>
      <td>17.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>224232</td>
      <td>N. Barella</td>
      <td>25</td>
      <td>https://cdn.sofifa.net/players/224/232/23_60.png</td>
      <td>Italy</td>
      <td>https://cdn.sofifa.net/flags/it.png</td>
      <td>86</td>
      <td>89</td>
      <td>Inter</td>
      <td>https://cdn.sofifa.net/teams/44/30.png</td>
      <td>...</td>
      <td>Yes</td>
      <td>&lt;span class="pos pos13"&gt;RCM</td>
      <td>Sep 1, 2020</td>
      <td>NaN</td>
      <td>2026</td>
      <td>172cm</td>
      <td>68kg</td>
      <td>154400000.0</td>
      <td>23.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>17655</th>
      <td>269526</td>
      <td>Deng Xiongtao</td>
      <td>19</td>
      <td>https://cdn.sofifa.net/players/269/526/23_60.png</td>
      <td>China PR</td>
      <td>https://cdn.sofifa.net/flags/cn.png</td>
      <td>48</td>
      <td>61</td>
      <td>Meizhou Hakka</td>
      <td>https://cdn.sofifa.net/teams/114628/30.png</td>
      <td>...</td>
      <td>No</td>
      <td>&lt;span class="pos pos29"&gt;RES</td>
      <td>Apr 11, 2022</td>
      <td>NaN</td>
      <td>2027</td>
      <td>190cm</td>
      <td>78kg</td>
      <td>218000.0</td>
      <td>35.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>17656</th>
      <td>267946</td>
      <td>22&nbsp;Lim Jun Sub</td>
      <td>17</td>
      <td>https://cdn.sofifa.net/players/267/946/22_60.png</td>
      <td>Korea Republic</td>
      <td>https://cdn.sofifa.net/flags/kr.png</td>
      <td>48</td>
      <td>64</td>
      <td>Jeju United FC</td>
      <td>https://cdn.sofifa.net/teams/1478/30.png</td>
      <td>...</td>
      <td>No</td>
      <td>&lt;span class="pos pos29"&gt;RES</td>
      <td>Jan 1, 2022</td>
      <td>NaN</td>
      <td>2026</td>
      <td>195cm</td>
      <td>84kg</td>
      <td>188000.0</td>
      <td>21.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>17657</th>
      <td>270567</td>
      <td>A. Demir</td>
      <td>25</td>
      <td>https://cdn.sofifa.net/players/270/567/23_60.png</td>
      <td>Turkey</td>
      <td>https://cdn.sofifa.net/flags/tr.png</td>
      <td>51</td>
      <td>56</td>
      <td>Ümraniyespor</td>
      <td>https://cdn.sofifa.net/teams/113796/30.png</td>
      <td>...</td>
      <td>No</td>
      <td>&lt;span class="pos pos29"&gt;RES</td>
      <td>Jun 6, 2021</td>
      <td>NaN</td>
      <td>2023</td>
      <td>190cm</td>
      <td>82kg</td>
      <td>142000.0</td>
      <td>12.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>17658</th>
      <td>256624</td>
      <td>21&nbsp;S. Czajor</td>
      <td>18</td>
      <td>https://cdn.sofifa.net/players/256/624/21_60.png</td>
      <td>Poland</td>
      <td>https://cdn.sofifa.net/flags/pl.png</td>
      <td>50</td>
      <td>65</td>
      <td>Fleetwood Town</td>
      <td>https://cdn.sofifa.net/teams/112260/30.png</td>
      <td>...</td>
      <td>No</td>
      <td>&lt;span class="pos pos29"&gt;RES</td>
      <td>Jan 1, 2020</td>
      <td>NaN</td>
      <td>2021</td>
      <td>187cm</td>
      <td>79kg</td>
      <td>214000.0</td>
      <td>40.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>17659</th>
      <td>256376</td>
      <td>21&nbsp;F. Jakobsson</td>
      <td>20</td>
      <td>https://cdn.sofifa.net/players/256/376/21_60.png</td>
      <td>Sweden</td>
      <td>https://cdn.sofifa.net/flags/se.png</td>
      <td>50</td>
      <td>61</td>
      <td>IFK Norrköping</td>
      <td>https://cdn.sofifa.net/teams/702/30.png</td>
      <td>...</td>
      <td>No</td>
      <td>&lt;span class="pos pos29"&gt;RES</td>
      <td>Jan 8, 2020</td>
      <td>NaN</td>
      <td>2021</td>
      <td>186cm</td>
      <td>78kg</td>
      <td>131000.0</td>
      <td>30.0</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>17660 rows × 29 columns</p>
</div>
</div>
</div>
<p>(시도3–성공) 그냥 결측치를 제거하고 변형해도 무방..</p>
<div class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1"></a>df2 <span class="op">=</span> df.drop(columns<span class="op">=</span>[<span class="st">'Loaned From'</span>, <span class="st">'Best Overall Rating'</span>]).dropna()</span>
<span id="cb60-2"><a href="#cb60-2"></a>df2[<span class="st">'Release Clause'</span>] <span class="op">=</span> <span class="bu">list</span>(<span class="bu">map</span>(<span class="kw">lambda</span> x: _f(x) <span class="cf">if</span> pd.isna(x)<span class="op">==</span><span class="va">False</span> <span class="cf">else</span> x , df2[<span class="st">'Release Clause'</span>]))</span>
<span id="cb60-3"><a href="#cb60-3"></a>df2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="34">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>ID</th>
      <th>Name</th>
      <th>Age</th>
      <th>Photo</th>
      <th>Nationality</th>
      <th>Flag</th>
      <th>Overall</th>
      <th>Potential</th>
      <th>Club</th>
      <th>Club Logo</th>
      <th>...</th>
      <th>Work Rate</th>
      <th>Body Type</th>
      <th>Real Face</th>
      <th>Position</th>
      <th>Joined</th>
      <th>Contract Valid Until</th>
      <th>Height</th>
      <th>Weight</th>
      <th>Release Clause</th>
      <th>Kit Number</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>209658</td>
      <td>L. Goretzka</td>
      <td>27</td>
      <td>https://cdn.sofifa.net/players/209/658/23_60.png</td>
      <td>Germany</td>
      <td>https://cdn.sofifa.net/flags/de.png</td>
      <td>87</td>
      <td>88</td>
      <td>FC Bayern München</td>
      <td>https://cdn.sofifa.net/teams/21/30.png</td>
      <td>...</td>
      <td>High/ Medium</td>
      <td>Unique</td>
      <td>Yes</td>
      <td>&lt;span class="pos pos28"&gt;SUB</td>
      <td>Jul 1, 2018</td>
      <td>2026</td>
      <td>189cm</td>
      <td>82kg</td>
      <td>157000000.0</td>
      <td>8.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>212198</td>
      <td>Bruno Fernandes</td>
      <td>27</td>
      <td>https://cdn.sofifa.net/players/212/198/23_60.png</td>
      <td>Portugal</td>
      <td>https://cdn.sofifa.net/flags/pt.png</td>
      <td>86</td>
      <td>87</td>
      <td>Manchester United</td>
      <td>https://cdn.sofifa.net/teams/11/30.png</td>
      <td>...</td>
      <td>High/ High</td>
      <td>Unique</td>
      <td>Yes</td>
      <td>&lt;span class="pos pos15"&gt;LCM</td>
      <td>Jan 30, 2020</td>
      <td>2026</td>
      <td>179cm</td>
      <td>69kg</td>
      <td>155000000.0</td>
      <td>8.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>224334</td>
      <td>M. Acuña</td>
      <td>30</td>
      <td>https://cdn.sofifa.net/players/224/334/23_60.png</td>
      <td>Argentina</td>
      <td>https://cdn.sofifa.net/flags/ar.png</td>
      <td>85</td>
      <td>85</td>
      <td>Sevilla FC</td>
      <td>https://cdn.sofifa.net/teams/481/30.png</td>
      <td>...</td>
      <td>High/ High</td>
      <td>Stocky (170-185)</td>
      <td>No</td>
      <td>&lt;span class="pos pos7"&gt;LB</td>
      <td>Sep 14, 2020</td>
      <td>2024</td>
      <td>172cm</td>
      <td>69kg</td>
      <td>97700000.0</td>
      <td>19.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>192985</td>
      <td>K. De Bruyne</td>
      <td>31</td>
      <td>https://cdn.sofifa.net/players/192/985/23_60.png</td>
      <td>Belgium</td>
      <td>https://cdn.sofifa.net/flags/be.png</td>
      <td>91</td>
      <td>91</td>
      <td>Manchester City</td>
      <td>https://cdn.sofifa.net/teams/10/30.png</td>
      <td>...</td>
      <td>High/ High</td>
      <td>Unique</td>
      <td>Yes</td>
      <td>&lt;span class="pos pos13"&gt;RCM</td>
      <td>Aug 30, 2015</td>
      <td>2025</td>
      <td>181cm</td>
      <td>70kg</td>
      <td>198900000.0</td>
      <td>17.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>224232</td>
      <td>N. Barella</td>
      <td>25</td>
      <td>https://cdn.sofifa.net/players/224/232/23_60.png</td>
      <td>Italy</td>
      <td>https://cdn.sofifa.net/flags/it.png</td>
      <td>86</td>
      <td>89</td>
      <td>Inter</td>
      <td>https://cdn.sofifa.net/teams/44/30.png</td>
      <td>...</td>
      <td>High/ High</td>
      <td>Normal (170-)</td>
      <td>Yes</td>
      <td>&lt;span class="pos pos13"&gt;RCM</td>
      <td>Sep 1, 2020</td>
      <td>2026</td>
      <td>172cm</td>
      <td>68kg</td>
      <td>154400000.0</td>
      <td>23.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>17655</th>
      <td>269526</td>
      <td>Deng Xiongtao</td>
      <td>19</td>
      <td>https://cdn.sofifa.net/players/269/526/23_60.png</td>
      <td>China PR</td>
      <td>https://cdn.sofifa.net/flags/cn.png</td>
      <td>48</td>
      <td>61</td>
      <td>Meizhou Hakka</td>
      <td>https://cdn.sofifa.net/teams/114628/30.png</td>
      <td>...</td>
      <td>Medium/ Medium</td>
      <td>Normal (185+)</td>
      <td>No</td>
      <td>&lt;span class="pos pos29"&gt;RES</td>
      <td>Apr 11, 2022</td>
      <td>2027</td>
      <td>190cm</td>
      <td>78kg</td>
      <td>218000.0</td>
      <td>35.0</td>
    </tr>
    <tr>
      <th>17656</th>
      <td>267946</td>
      <td>22&nbsp;Lim Jun Sub</td>
      <td>17</td>
      <td>https://cdn.sofifa.net/players/267/946/22_60.png</td>
      <td>Korea Republic</td>
      <td>https://cdn.sofifa.net/flags/kr.png</td>
      <td>48</td>
      <td>64</td>
      <td>Jeju United FC</td>
      <td>https://cdn.sofifa.net/teams/1478/30.png</td>
      <td>...</td>
      <td>Medium/ Medium</td>
      <td>Lean (185+)</td>
      <td>No</td>
      <td>&lt;span class="pos pos29"&gt;RES</td>
      <td>Jan 1, 2022</td>
      <td>2026</td>
      <td>195cm</td>
      <td>84kg</td>
      <td>188000.0</td>
      <td>21.0</td>
    </tr>
    <tr>
      <th>17657</th>
      <td>270567</td>
      <td>A. Demir</td>
      <td>25</td>
      <td>https://cdn.sofifa.net/players/270/567/23_60.png</td>
      <td>Turkey</td>
      <td>https://cdn.sofifa.net/flags/tr.png</td>
      <td>51</td>
      <td>56</td>
      <td>Ümraniyespor</td>
      <td>https://cdn.sofifa.net/teams/113796/30.png</td>
      <td>...</td>
      <td>Medium/ Medium</td>
      <td>Lean (185+)</td>
      <td>No</td>
      <td>&lt;span class="pos pos29"&gt;RES</td>
      <td>Jun 6, 2021</td>
      <td>2023</td>
      <td>190cm</td>
      <td>82kg</td>
      <td>142000.0</td>
      <td>12.0</td>
    </tr>
    <tr>
      <th>17658</th>
      <td>256624</td>
      <td>21&nbsp;S. Czajor</td>
      <td>18</td>
      <td>https://cdn.sofifa.net/players/256/624/21_60.png</td>
      <td>Poland</td>
      <td>https://cdn.sofifa.net/flags/pl.png</td>
      <td>50</td>
      <td>65</td>
      <td>Fleetwood Town</td>
      <td>https://cdn.sofifa.net/teams/112260/30.png</td>
      <td>...</td>
      <td>Medium/ Medium</td>
      <td>Normal (185+)</td>
      <td>No</td>
      <td>&lt;span class="pos pos29"&gt;RES</td>
      <td>Jan 1, 2020</td>
      <td>2021</td>
      <td>187cm</td>
      <td>79kg</td>
      <td>214000.0</td>
      <td>40.0</td>
    </tr>
    <tr>
      <th>17659</th>
      <td>256376</td>
      <td>21&nbsp;F. Jakobsson</td>
      <td>20</td>
      <td>https://cdn.sofifa.net/players/256/376/21_60.png</td>
      <td>Sweden</td>
      <td>https://cdn.sofifa.net/flags/se.png</td>
      <td>50</td>
      <td>61</td>
      <td>IFK Norrköping</td>
      <td>https://cdn.sofifa.net/teams/702/30.png</td>
      <td>...</td>
      <td>Medium/ Medium</td>
      <td>Normal (185+)</td>
      <td>No</td>
      <td>&lt;span class="pos pos29"&gt;RES</td>
      <td>Jan 8, 2020</td>
      <td>2021</td>
      <td>186cm</td>
      <td>78kg</td>
      <td>131000.0</td>
      <td>30.0</td>
    </tr>
  </tbody>
</table>
<p>16364 rows × 27 columns</p>
</div>
</div>
</div>
<blockquote class="blockquote">
<p>분석의 편의를 위하여 (1) colnames를 변경하고 (2) 결측치를 제거하고 (3) 몇 가지 전 처리를 추가로 진행한 뒤 df2를 만들어서 분석하는게 좋음</p>
</blockquote>
</section>
<section id="데이터분석시각화" class="level2">
<h2 class="anchored" data-anchor-id="데이터분석시각화">데이터분석+시각화</h2>
<p><code>-</code> Overall vs Potential</p>
<div class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1"></a>ggplot(data<span class="op">=</span>df) <span class="op">+</span> geom_point(aes(x<span class="op">=</span><span class="st">'Overall'</span>,y<span class="op">=</span><span class="st">'Potential'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2022-10-24-8wk-12_files/figure-html/cell-47-output-1.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display" data-execution_count="35">
<pre><code>&lt;ggplot: (8772275859669)&gt;</code></pre>
</div>
</div>
<ul>
<li>뭔가 Potential &gt; Overall 인 관계가 성립하는 듯 하다. <span class="math inline">\(\to\)</span> 우리가 생각하는 포텐셜의 의미는 사실 Potential2 = Potential - Overall 에 더 가깝다. <span class="math inline">\(\to\)</span> Potential2 = Potential - Overall 인 변수를 새로 만들고 시각화 해보자.</li>
</ul>
<p><code>-</code> Potential2 = Potential - Overall 를 계산하여 새로운 열을 추가하자.</p>
<div class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1"></a>df.<span class="bu">eval</span>(<span class="st">'Potential2 = Potential - Overall'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="36">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>ID</th>
      <th>Name</th>
      <th>Age</th>
      <th>Photo</th>
      <th>Nationality</th>
      <th>Flag</th>
      <th>Overall</th>
      <th>Potential</th>
      <th>Club</th>
      <th>Club Logo</th>
      <th>...</th>
      <th>Position</th>
      <th>Joined</th>
      <th>Loaned From</th>
      <th>Contract Valid Until</th>
      <th>Height</th>
      <th>Weight</th>
      <th>Release Clause</th>
      <th>Kit Number</th>
      <th>Best Overall Rating</th>
      <th>Potential2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>209658</td>
      <td>L. Goretzka</td>
      <td>27</td>
      <td>https://cdn.sofifa.net/players/209/658/23_60.png</td>
      <td>Germany</td>
      <td>https://cdn.sofifa.net/flags/de.png</td>
      <td>87</td>
      <td>88</td>
      <td>FC Bayern München</td>
      <td>https://cdn.sofifa.net/teams/21/30.png</td>
      <td>...</td>
      <td>&lt;span class="pos pos28"&gt;SUB</td>
      <td>Jul 1, 2018</td>
      <td>NaN</td>
      <td>2026</td>
      <td>189cm</td>
      <td>82kg</td>
      <td>€157M</td>
      <td>8.0</td>
      <td>NaN</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>212198</td>
      <td>Bruno Fernandes</td>
      <td>27</td>
      <td>https://cdn.sofifa.net/players/212/198/23_60.png</td>
      <td>Portugal</td>
      <td>https://cdn.sofifa.net/flags/pt.png</td>
      <td>86</td>
      <td>87</td>
      <td>Manchester United</td>
      <td>https://cdn.sofifa.net/teams/11/30.png</td>
      <td>...</td>
      <td>&lt;span class="pos pos15"&gt;LCM</td>
      <td>Jan 30, 2020</td>
      <td>NaN</td>
      <td>2026</td>
      <td>179cm</td>
      <td>69kg</td>
      <td>€155M</td>
      <td>8.0</td>
      <td>NaN</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>224334</td>
      <td>M. Acuña</td>
      <td>30</td>
      <td>https://cdn.sofifa.net/players/224/334/23_60.png</td>
      <td>Argentina</td>
      <td>https://cdn.sofifa.net/flags/ar.png</td>
      <td>85</td>
      <td>85</td>
      <td>Sevilla FC</td>
      <td>https://cdn.sofifa.net/teams/481/30.png</td>
      <td>...</td>
      <td>&lt;span class="pos pos7"&gt;LB</td>
      <td>Sep 14, 2020</td>
      <td>NaN</td>
      <td>2024</td>
      <td>172cm</td>
      <td>69kg</td>
      <td>€97.7M</td>
      <td>19.0</td>
      <td>NaN</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>192985</td>
      <td>K. De Bruyne</td>
      <td>31</td>
      <td>https://cdn.sofifa.net/players/192/985/23_60.png</td>
      <td>Belgium</td>
      <td>https://cdn.sofifa.net/flags/be.png</td>
      <td>91</td>
      <td>91</td>
      <td>Manchester City</td>
      <td>https://cdn.sofifa.net/teams/10/30.png</td>
      <td>...</td>
      <td>&lt;span class="pos pos13"&gt;RCM</td>
      <td>Aug 30, 2015</td>
      <td>NaN</td>
      <td>2025</td>
      <td>181cm</td>
      <td>70kg</td>
      <td>€198.9M</td>
      <td>17.0</td>
      <td>NaN</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>224232</td>
      <td>N. Barella</td>
      <td>25</td>
      <td>https://cdn.sofifa.net/players/224/232/23_60.png</td>
      <td>Italy</td>
      <td>https://cdn.sofifa.net/flags/it.png</td>
      <td>86</td>
      <td>89</td>
      <td>Inter</td>
      <td>https://cdn.sofifa.net/teams/44/30.png</td>
      <td>...</td>
      <td>&lt;span class="pos pos13"&gt;RCM</td>
      <td>Sep 1, 2020</td>
      <td>NaN</td>
      <td>2026</td>
      <td>172cm</td>
      <td>68kg</td>
      <td>€154.4M</td>
      <td>23.0</td>
      <td>NaN</td>
      <td>3</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>17655</th>
      <td>269526</td>
      <td>Deng Xiongtao</td>
      <td>19</td>
      <td>https://cdn.sofifa.net/players/269/526/23_60.png</td>
      <td>China PR</td>
      <td>https://cdn.sofifa.net/flags/cn.png</td>
      <td>48</td>
      <td>61</td>
      <td>Meizhou Hakka</td>
      <td>https://cdn.sofifa.net/teams/114628/30.png</td>
      <td>...</td>
      <td>&lt;span class="pos pos29"&gt;RES</td>
      <td>Apr 11, 2022</td>
      <td>NaN</td>
      <td>2027</td>
      <td>190cm</td>
      <td>78kg</td>
      <td>€218K</td>
      <td>35.0</td>
      <td>NaN</td>
      <td>13</td>
    </tr>
    <tr>
      <th>17656</th>
      <td>267946</td>
      <td>22&nbsp;Lim Jun Sub</td>
      <td>17</td>
      <td>https://cdn.sofifa.net/players/267/946/22_60.png</td>
      <td>Korea Republic</td>
      <td>https://cdn.sofifa.net/flags/kr.png</td>
      <td>48</td>
      <td>64</td>
      <td>Jeju United FC</td>
      <td>https://cdn.sofifa.net/teams/1478/30.png</td>
      <td>...</td>
      <td>&lt;span class="pos pos29"&gt;RES</td>
      <td>Jan 1, 2022</td>
      <td>NaN</td>
      <td>2026</td>
      <td>195cm</td>
      <td>84kg</td>
      <td>€188K</td>
      <td>21.0</td>
      <td>NaN</td>
      <td>16</td>
    </tr>
    <tr>
      <th>17657</th>
      <td>270567</td>
      <td>A. Demir</td>
      <td>25</td>
      <td>https://cdn.sofifa.net/players/270/567/23_60.png</td>
      <td>Turkey</td>
      <td>https://cdn.sofifa.net/flags/tr.png</td>
      <td>51</td>
      <td>56</td>
      <td>Ümraniyespor</td>
      <td>https://cdn.sofifa.net/teams/113796/30.png</td>
      <td>...</td>
      <td>&lt;span class="pos pos29"&gt;RES</td>
      <td>Jun 6, 2021</td>
      <td>NaN</td>
      <td>2023</td>
      <td>190cm</td>
      <td>82kg</td>
      <td>€142K</td>
      <td>12.0</td>
      <td>NaN</td>
      <td>5</td>
    </tr>
    <tr>
      <th>17658</th>
      <td>256624</td>
      <td>21&nbsp;S. Czajor</td>
      <td>18</td>
      <td>https://cdn.sofifa.net/players/256/624/21_60.png</td>
      <td>Poland</td>
      <td>https://cdn.sofifa.net/flags/pl.png</td>
      <td>50</td>
      <td>65</td>
      <td>Fleetwood Town</td>
      <td>https://cdn.sofifa.net/teams/112260/30.png</td>
      <td>...</td>
      <td>&lt;span class="pos pos29"&gt;RES</td>
      <td>Jan 1, 2020</td>
      <td>NaN</td>
      <td>2021</td>
      <td>187cm</td>
      <td>79kg</td>
      <td>€214K</td>
      <td>40.0</td>
      <td>NaN</td>
      <td>15</td>
    </tr>
    <tr>
      <th>17659</th>
      <td>256376</td>
      <td>21&nbsp;F. Jakobsson</td>
      <td>20</td>
      <td>https://cdn.sofifa.net/players/256/376/21_60.png</td>
      <td>Sweden</td>
      <td>https://cdn.sofifa.net/flags/se.png</td>
      <td>50</td>
      <td>61</td>
      <td>IFK Norrköping</td>
      <td>https://cdn.sofifa.net/teams/702/30.png</td>
      <td>...</td>
      <td>&lt;span class="pos pos29"&gt;RES</td>
      <td>Jan 8, 2020</td>
      <td>NaN</td>
      <td>2021</td>
      <td>186cm</td>
      <td>78kg</td>
      <td>€131K</td>
      <td>30.0</td>
      <td>NaN</td>
      <td>11</td>
    </tr>
  </tbody>
</table>
<p>17660 rows × 30 columns</p>
</div>
</div>
</div>
<p><code>-</code> 수정된 데이터프레임으로 다시 시각화를 하자.</p>
<div class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1"></a>ggplot(data<span class="op">=</span>df.<span class="bu">eval</span>(<span class="st">'Potential2 = Potential - Overall'</span>))<span class="op">\</span></span>
<span id="cb64-2"><a href="#cb64-2"></a><span class="op">+</span> geom_point(aes(x<span class="op">=</span><span class="st">'Overall'</span>,y<span class="op">=</span><span class="st">'Potential2'</span>),alpha<span class="op">=</span><span class="fl">0.01</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2022-10-24-8wk-12_files/figure-html/cell-49-output-1.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display" data-execution_count="37">
<pre><code>&lt;ggplot: (8772307230189)&gt;</code></pre>
</div>
</div>
<p><code>-</code> 일부점들이 겹치므로 position = ’jitter’를 사용하여 점들을 흩뿌리자.</p>
<div class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1"></a>ggplot(data<span class="op">=</span>df.<span class="bu">eval</span>(<span class="st">'Potential2 = Potential - Overall'</span>))<span class="op">\</span></span>
<span id="cb66-2"><a href="#cb66-2"></a><span class="op">+</span> geom_point(aes(x<span class="op">=</span><span class="st">'Overall'</span>,y<span class="op">=</span><span class="st">'Potential2'</span>),alpha<span class="op">=</span><span class="fl">0.05</span>,position<span class="op">=</span><span class="st">'jitter'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2022-10-24-8wk-12_files/figure-html/cell-50-output-1.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display" data-execution_count="38">
<pre><code>&lt;ggplot: (8772275596573)&gt;</code></pre>
</div>
</div>
<p><code>-</code> 해석 - 해석1: Overall, Potential2는 음의 상관관계가 있다. - 해석2: 0근처에 데이터가 많음 <span class="math inline">\(\to\)</span> 이미 은퇴한 선수들이 아닐까? - 해석3: Overall의 값이 작을수록 Potential2의 분산이 크다.</p>
<p><code>-</code> 은퇴한 선수들은 제외하고 시각화하자.</p>
<div class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1"></a>ggplot(data<span class="op">=</span>df.<span class="bu">eval</span>(<span class="st">'Potential2 = Potential - Overall'</span>).query(<span class="st">'Potential2 &gt; 1'</span>))<span class="op">\</span></span>
<span id="cb68-2"><a href="#cb68-2"></a><span class="op">+</span> geom_point(aes(x<span class="op">=</span><span class="st">'Overall'</span>,y<span class="op">=</span><span class="st">'Potential2'</span>),alpha<span class="op">=</span><span class="fl">0.05</span>,position<span class="op">=</span><span class="st">'jitter'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2022-10-24-8wk-12_files/figure-html/cell-51-output-1.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display" data-execution_count="39">
<pre><code>&lt;ggplot: (8772275556513)&gt;</code></pre>
</div>
</div>
<p><code>-</code> Overall에 따라서 구간을 나누고 그 구간에 대응하는 boxplot을 그리자.</p>
<div class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1"></a>df.<span class="bu">eval</span>(<span class="st">'Potential2 = Potential - Overall'</span>).query(<span class="st">'Potential2 &gt; 1'</span>)<span class="op">\</span></span>
<span id="cb70-2"><a href="#cb70-2"></a>.Overall.describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="40">
<pre><code>count    13644.000000
mean        61.415347
std          7.247821
min         44.000000
25%         56.000000
50%         61.000000
75%         66.000000
max         91.000000
Name: Overall, dtype: float64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1"></a><span class="kw">def</span> f(x):</span>
<span id="cb72-2"><a href="#cb72-2"></a>    <span class="cf">if</span> x<span class="op">&gt;</span><span class="dv">66</span>: </span>
<span id="cb72-3"><a href="#cb72-3"></a>        y<span class="op">=</span><span class="st">'66&lt;'</span></span>
<span id="cb72-4"><a href="#cb72-4"></a>    <span class="cf">elif</span> x<span class="op">&gt;</span><span class="dv">61</span>:</span>
<span id="cb72-5"><a href="#cb72-5"></a>        y<span class="op">=</span><span class="st">'61~66'</span></span>
<span id="cb72-6"><a href="#cb72-6"></a>    <span class="cf">elif</span> x<span class="op">&gt;</span><span class="dv">56</span>:</span>
<span id="cb72-7"><a href="#cb72-7"></a>        y<span class="op">=</span><span class="st">'56~61'</span></span>
<span id="cb72-8"><a href="#cb72-8"></a>    <span class="cf">else</span>:</span>
<span id="cb72-9"><a href="#cb72-9"></a>        y<span class="op">=</span><span class="st">'&lt;56'</span> </span>
<span id="cb72-10"><a href="#cb72-10"></a>    <span class="cf">return</span> y</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1"></a>ggplot(data<span class="op">=</span>df.<span class="bu">eval</span>(<span class="st">'Potential2 = Potential - Overall'</span>).query(<span class="st">'Potential2 &gt; 1'</span>)<span class="op">\</span></span>
<span id="cb73-2"><a href="#cb73-2"></a>.assign(Overall_grouped<span class="op">=</span> <span class="kw">lambda</span> df: <span class="bu">list</span>(<span class="bu">map</span>(f,df.Overall))))<span class="op">\</span></span>
<span id="cb73-3"><a href="#cb73-3"></a>    <span class="op">+</span> geom_boxplot(aes(x<span class="op">=</span><span class="st">'Overall_grouped'</span>,y<span class="op">=</span><span class="st">'Potential2'</span>,color<span class="op">=</span><span class="st">'Overall_grouped'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2022-10-24-8wk-12_files/figure-html/cell-54-output-1.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display" data-execution_count="42">
<pre><code>&lt;ggplot: (8772275730901)&gt;</code></pre>
</div>
</div>
<ul>
<li><p>Overall_grouped = “&lt;56” 에 대응하는 점들을 모두 뽑아서 mean(Overall)를 계산하고 그 값을 Overall_grouped = “&lt;56” 에 대응하는 박스플랏의 x축위치로 설정</p></li>
<li><p>Overall_grouped = “56~61” 에 대응하는 점들을 모두 뽑아서 mean(Overall)를 계산하고 그 값을 Overall_grouped = “56~61” 에 대응하는 박스플랏의 x축위치로 설정</p></li>
<li><p>Overall_grouped = “61~66” 에 대응하는 점들을 모두 뽑아서 mean(Overall)를 계산하고 그 값을 Overall_grouped = “61~66” 에 대응하는 박스플랏의 x축위치로 설정</p></li>
<li><p>Overall_grouped = “66&lt;” 에 대응하는 점들을 모두 뽑아서 mean(Overall)를 계산하고 그 값을 Overall_grouped = “66&lt;” 에 대응하는 박스플랏의 x축위치로 설정</p></li>
</ul>
<div class="cell" data-execution_count="43">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1"></a>df.<span class="bu">eval</span>(<span class="st">'Potential2 = Potential - Overall'</span>).query(<span class="st">'Potential2 &gt; 1'</span>)<span class="op">\</span></span>
<span id="cb75-2"><a href="#cb75-2"></a>.assign(Overall_grouped<span class="op">=</span> <span class="kw">lambda</span> df: <span class="bu">list</span>(<span class="bu">map</span>(f,df.Overall)))<span class="op">\</span></span>
<span id="cb75-3"><a href="#cb75-3"></a>.query(<span class="st">"Overall_grouped == '66&lt;'"</span>).Overall.mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="43">
<pre><code>71.8127687727423</code></pre>
</div>
</div>
<p>(방법1)</p>
<div class="cell" data-execution_count="44">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb77-1"><a href="#cb77-1"></a><span class="kw">def</span> g(x):</span>
<span id="cb77-2"><a href="#cb77-2"></a>    <span class="cf">if</span> x<span class="op">==</span><span class="st">'66&lt;'</span>: </span>
<span id="cb77-3"><a href="#cb77-3"></a>        y<span class="op">=</span> <span class="fl">71.8127687727423</span></span>
<span id="cb77-4"><a href="#cb77-4"></a>    <span class="cf">elif</span> x<span class="op">==</span><span class="st">'61~66'</span>:</span>
<span id="cb77-5"><a href="#cb77-5"></a>        y<span class="op">=</span> <span class="fl">63.773918342474104</span></span>
<span id="cb77-6"><a href="#cb77-6"></a>    <span class="cf">elif</span> x<span class="op">==</span><span class="st">'56~61'</span>:</span>
<span id="cb77-7"><a href="#cb77-7"></a>        y<span class="op">=</span> <span class="fl">59.155840684309005</span></span>
<span id="cb77-8"><a href="#cb77-8"></a>    <span class="cf">else</span>:</span>
<span id="cb77-9"><a href="#cb77-9"></a>        y<span class="op">=</span> <span class="fl">52.87743190661479</span></span>
<span id="cb77-10"><a href="#cb77-10"></a>    <span class="cf">return</span> y</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="45">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1"></a>df.<span class="bu">eval</span>(<span class="st">'Potential2 = Potential - Overall'</span>).query(<span class="st">'Potential2 &gt; 1'</span>)<span class="op">\</span></span>
<span id="cb78-2"><a href="#cb78-2"></a>.assign(Overall_grouped<span class="op">=</span> <span class="kw">lambda</span> df: <span class="bu">list</span>(<span class="bu">map</span>(f,df.Overall)))<span class="op">\</span></span>
<span id="cb78-3"><a href="#cb78-3"></a>.assign(Overall_x<span class="op">=</span> <span class="kw">lambda</span> df: <span class="bu">list</span>(<span class="bu">map</span>(g,df.Overall_grouped)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="45">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>ID</th>
      <th>Name</th>
      <th>Age</th>
      <th>Photo</th>
      <th>Nationality</th>
      <th>Flag</th>
      <th>Overall</th>
      <th>Potential</th>
      <th>Club</th>
      <th>Club Logo</th>
      <th>...</th>
      <th>Loaned From</th>
      <th>Contract Valid Until</th>
      <th>Height</th>
      <th>Weight</th>
      <th>Release Clause</th>
      <th>Kit Number</th>
      <th>Best Overall Rating</th>
      <th>Potential2</th>
      <th>Overall_grouped</th>
      <th>Overall_x</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>4</th>
      <td>224232</td>
      <td>N. Barella</td>
      <td>25</td>
      <td>https://cdn.sofifa.net/players/224/232/23_60.png</td>
      <td>Italy</td>
      <td>https://cdn.sofifa.net/flags/it.png</td>
      <td>86</td>
      <td>89</td>
      <td>Inter</td>
      <td>https://cdn.sofifa.net/teams/44/30.png</td>
      <td>...</td>
      <td>NaN</td>
      <td>2026</td>
      <td>172cm</td>
      <td>68kg</td>
      <td>€154.4M</td>
      <td>23.0</td>
      <td>NaN</td>
      <td>3</td>
      <td>66&lt;</td>
      <td>71.812769</td>
    </tr>
    <tr>
      <th>10</th>
      <td>228251</td>
      <td>L. Pellegrini</td>
      <td>26</td>
      <td>https://cdn.sofifa.net/players/228/251/23_60.png</td>
      <td>Italy</td>
      <td>https://cdn.sofifa.net/flags/it.png</td>
      <td>84</td>
      <td>87</td>
      <td>Roma</td>
      <td>https://cdn.sofifa.net/teams/52/30.png</td>
      <td>...</td>
      <td>NaN</td>
      <td>2026</td>
      <td>186cm</td>
      <td>77kg</td>
      <td>€97.6M</td>
      <td>7.0</td>
      <td>NaN</td>
      <td>3</td>
      <td>66&lt;</td>
      <td>71.812769</td>
    </tr>
    <tr>
      <th>13</th>
      <td>225193</td>
      <td>Merino</td>
      <td>26</td>
      <td>https://cdn.sofifa.net/players/225/193/23_60.png</td>
      <td>Spain</td>
      <td>https://cdn.sofifa.net/flags/es.png</td>
      <td>83</td>
      <td>86</td>
      <td>Real Sociedad</td>
      <td>https://cdn.sofifa.net/teams/457/30.png</td>
      <td>...</td>
      <td>NaN</td>
      <td>2025</td>
      <td>189cm</td>
      <td>83kg</td>
      <td>€102.2M</td>
      <td>8.0</td>
      <td>NaN</td>
      <td>3</td>
      <td>66&lt;</td>
      <td>71.812769</td>
    </tr>
    <tr>
      <th>17</th>
      <td>228702</td>
      <td>F. de Jong</td>
      <td>25</td>
      <td>https://cdn.sofifa.net/players/228/702/23_60.png</td>
      <td>Netherlands</td>
      <td>https://cdn.sofifa.net/flags/nl.png</td>
      <td>87</td>
      <td>92</td>
      <td>FC Barcelona</td>
      <td>https://cdn.sofifa.net/teams/241/30.png</td>
      <td>...</td>
      <td>NaN</td>
      <td>2026</td>
      <td>180cm</td>
      <td>74kg</td>
      <td>€247.6M</td>
      <td>21.0</td>
      <td>NaN</td>
      <td>5</td>
      <td>66&lt;</td>
      <td>71.812769</td>
    </tr>
    <tr>
      <th>21</th>
      <td>231281</td>
      <td>T. Alexander-Arnold</td>
      <td>23</td>
      <td>https://cdn.sofifa.net/players/231/281/23_60.png</td>
      <td>England</td>
      <td>https://cdn.sofifa.net/flags/gb-eng.png</td>
      <td>87</td>
      <td>90</td>
      <td>Liverpool</td>
      <td>https://cdn.sofifa.net/teams/9/30.png</td>
      <td>...</td>
      <td>NaN</td>
      <td>2025</td>
      <td>180cm</td>
      <td>69kg</td>
      <td>€193.5M</td>
      <td>66.0</td>
      <td>NaN</td>
      <td>3</td>
      <td>66&lt;</td>
      <td>71.812769</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>17655</th>
      <td>269526</td>
      <td>Deng Xiongtao</td>
      <td>19</td>
      <td>https://cdn.sofifa.net/players/269/526/23_60.png</td>
      <td>China PR</td>
      <td>https://cdn.sofifa.net/flags/cn.png</td>
      <td>48</td>
      <td>61</td>
      <td>Meizhou Hakka</td>
      <td>https://cdn.sofifa.net/teams/114628/30.png</td>
      <td>...</td>
      <td>NaN</td>
      <td>2027</td>
      <td>190cm</td>
      <td>78kg</td>
      <td>€218K</td>
      <td>35.0</td>
      <td>NaN</td>
      <td>13</td>
      <td>&lt;56</td>
      <td>52.877432</td>
    </tr>
    <tr>
      <th>17656</th>
      <td>267946</td>
      <td>22&nbsp;Lim Jun Sub</td>
      <td>17</td>
      <td>https://cdn.sofifa.net/players/267/946/22_60.png</td>
      <td>Korea Republic</td>
      <td>https://cdn.sofifa.net/flags/kr.png</td>
      <td>48</td>
      <td>64</td>
      <td>Jeju United FC</td>
      <td>https://cdn.sofifa.net/teams/1478/30.png</td>
      <td>...</td>
      <td>NaN</td>
      <td>2026</td>
      <td>195cm</td>
      <td>84kg</td>
      <td>€188K</td>
      <td>21.0</td>
      <td>NaN</td>
      <td>16</td>
      <td>&lt;56</td>
      <td>52.877432</td>
    </tr>
    <tr>
      <th>17657</th>
      <td>270567</td>
      <td>A. Demir</td>
      <td>25</td>
      <td>https://cdn.sofifa.net/players/270/567/23_60.png</td>
      <td>Turkey</td>
      <td>https://cdn.sofifa.net/flags/tr.png</td>
      <td>51</td>
      <td>56</td>
      <td>Ümraniyespor</td>
      <td>https://cdn.sofifa.net/teams/113796/30.png</td>
      <td>...</td>
      <td>NaN</td>
      <td>2023</td>
      <td>190cm</td>
      <td>82kg</td>
      <td>€142K</td>
      <td>12.0</td>
      <td>NaN</td>
      <td>5</td>
      <td>&lt;56</td>
      <td>52.877432</td>
    </tr>
    <tr>
      <th>17658</th>
      <td>256624</td>
      <td>21&nbsp;S. Czajor</td>
      <td>18</td>
      <td>https://cdn.sofifa.net/players/256/624/21_60.png</td>
      <td>Poland</td>
      <td>https://cdn.sofifa.net/flags/pl.png</td>
      <td>50</td>
      <td>65</td>
      <td>Fleetwood Town</td>
      <td>https://cdn.sofifa.net/teams/112260/30.png</td>
      <td>...</td>
      <td>NaN</td>
      <td>2021</td>
      <td>187cm</td>
      <td>79kg</td>
      <td>€214K</td>
      <td>40.0</td>
      <td>NaN</td>
      <td>15</td>
      <td>&lt;56</td>
      <td>52.877432</td>
    </tr>
    <tr>
      <th>17659</th>
      <td>256376</td>
      <td>21&nbsp;F. Jakobsson</td>
      <td>20</td>
      <td>https://cdn.sofifa.net/players/256/376/21_60.png</td>
      <td>Sweden</td>
      <td>https://cdn.sofifa.net/flags/se.png</td>
      <td>50</td>
      <td>61</td>
      <td>IFK Norrköping</td>
      <td>https://cdn.sofifa.net/teams/702/30.png</td>
      <td>...</td>
      <td>NaN</td>
      <td>2021</td>
      <td>186cm</td>
      <td>78kg</td>
      <td>€131K</td>
      <td>30.0</td>
      <td>NaN</td>
      <td>11</td>
      <td>&lt;56</td>
      <td>52.877432</td>
    </tr>
  </tbody>
</table>
<p>13644 rows × 32 columns</p>
</div>
</div>
</div>
<div class="cell" data-execution_count="46">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1"></a>df2<span class="op">=</span> df.<span class="bu">eval</span>(<span class="st">'Potential2 = Potential - Overall'</span>).query(<span class="st">'Potential2 &gt; 1'</span>)<span class="op">\</span></span>
<span id="cb79-2"><a href="#cb79-2"></a>.assign(Overall_grouped<span class="op">=</span> <span class="kw">lambda</span> df: <span class="bu">list</span>(<span class="bu">map</span>(f,df.Overall)))<span class="op">\</span></span>
<span id="cb79-3"><a href="#cb79-3"></a>.assign(Overall_x<span class="op">=</span> <span class="kw">lambda</span> df: <span class="bu">list</span>(<span class="bu">map</span>(g,df.Overall_grouped)))</span>
<span id="cb79-4"><a href="#cb79-4"></a>df2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="46">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>ID</th>
      <th>Name</th>
      <th>Age</th>
      <th>Photo</th>
      <th>Nationality</th>
      <th>Flag</th>
      <th>Overall</th>
      <th>Potential</th>
      <th>Club</th>
      <th>Club Logo</th>
      <th>...</th>
      <th>Loaned From</th>
      <th>Contract Valid Until</th>
      <th>Height</th>
      <th>Weight</th>
      <th>Release Clause</th>
      <th>Kit Number</th>
      <th>Best Overall Rating</th>
      <th>Potential2</th>
      <th>Overall_grouped</th>
      <th>Overall_x</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>4</th>
      <td>224232</td>
      <td>N. Barella</td>
      <td>25</td>
      <td>https://cdn.sofifa.net/players/224/232/23_60.png</td>
      <td>Italy</td>
      <td>https://cdn.sofifa.net/flags/it.png</td>
      <td>86</td>
      <td>89</td>
      <td>Inter</td>
      <td>https://cdn.sofifa.net/teams/44/30.png</td>
      <td>...</td>
      <td>NaN</td>
      <td>2026</td>
      <td>172cm</td>
      <td>68kg</td>
      <td>€154.4M</td>
      <td>23.0</td>
      <td>NaN</td>
      <td>3</td>
      <td>66&lt;</td>
      <td>71.812769</td>
    </tr>
    <tr>
      <th>10</th>
      <td>228251</td>
      <td>L. Pellegrini</td>
      <td>26</td>
      <td>https://cdn.sofifa.net/players/228/251/23_60.png</td>
      <td>Italy</td>
      <td>https://cdn.sofifa.net/flags/it.png</td>
      <td>84</td>
      <td>87</td>
      <td>Roma</td>
      <td>https://cdn.sofifa.net/teams/52/30.png</td>
      <td>...</td>
      <td>NaN</td>
      <td>2026</td>
      <td>186cm</td>
      <td>77kg</td>
      <td>€97.6M</td>
      <td>7.0</td>
      <td>NaN</td>
      <td>3</td>
      <td>66&lt;</td>
      <td>71.812769</td>
    </tr>
    <tr>
      <th>13</th>
      <td>225193</td>
      <td>Merino</td>
      <td>26</td>
      <td>https://cdn.sofifa.net/players/225/193/23_60.png</td>
      <td>Spain</td>
      <td>https://cdn.sofifa.net/flags/es.png</td>
      <td>83</td>
      <td>86</td>
      <td>Real Sociedad</td>
      <td>https://cdn.sofifa.net/teams/457/30.png</td>
      <td>...</td>
      <td>NaN</td>
      <td>2025</td>
      <td>189cm</td>
      <td>83kg</td>
      <td>€102.2M</td>
      <td>8.0</td>
      <td>NaN</td>
      <td>3</td>
      <td>66&lt;</td>
      <td>71.812769</td>
    </tr>
    <tr>
      <th>17</th>
      <td>228702</td>
      <td>F. de Jong</td>
      <td>25</td>
      <td>https://cdn.sofifa.net/players/228/702/23_60.png</td>
      <td>Netherlands</td>
      <td>https://cdn.sofifa.net/flags/nl.png</td>
      <td>87</td>
      <td>92</td>
      <td>FC Barcelona</td>
      <td>https://cdn.sofifa.net/teams/241/30.png</td>
      <td>...</td>
      <td>NaN</td>
      <td>2026</td>
      <td>180cm</td>
      <td>74kg</td>
      <td>€247.6M</td>
      <td>21.0</td>
      <td>NaN</td>
      <td>5</td>
      <td>66&lt;</td>
      <td>71.812769</td>
    </tr>
    <tr>
      <th>21</th>
      <td>231281</td>
      <td>T. Alexander-Arnold</td>
      <td>23</td>
      <td>https://cdn.sofifa.net/players/231/281/23_60.png</td>
      <td>England</td>
      <td>https://cdn.sofifa.net/flags/gb-eng.png</td>
      <td>87</td>
      <td>90</td>
      <td>Liverpool</td>
      <td>https://cdn.sofifa.net/teams/9/30.png</td>
      <td>...</td>
      <td>NaN</td>
      <td>2025</td>
      <td>180cm</td>
      <td>69kg</td>
      <td>€193.5M</td>
      <td>66.0</td>
      <td>NaN</td>
      <td>3</td>
      <td>66&lt;</td>
      <td>71.812769</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>17655</th>
      <td>269526</td>
      <td>Deng Xiongtao</td>
      <td>19</td>
      <td>https://cdn.sofifa.net/players/269/526/23_60.png</td>
      <td>China PR</td>
      <td>https://cdn.sofifa.net/flags/cn.png</td>
      <td>48</td>
      <td>61</td>
      <td>Meizhou Hakka</td>
      <td>https://cdn.sofifa.net/teams/114628/30.png</td>
      <td>...</td>
      <td>NaN</td>
      <td>2027</td>
      <td>190cm</td>
      <td>78kg</td>
      <td>€218K</td>
      <td>35.0</td>
      <td>NaN</td>
      <td>13</td>
      <td>&lt;56</td>
      <td>52.877432</td>
    </tr>
    <tr>
      <th>17656</th>
      <td>267946</td>
      <td>22&nbsp;Lim Jun Sub</td>
      <td>17</td>
      <td>https://cdn.sofifa.net/players/267/946/22_60.png</td>
      <td>Korea Republic</td>
      <td>https://cdn.sofifa.net/flags/kr.png</td>
      <td>48</td>
      <td>64</td>
      <td>Jeju United FC</td>
      <td>https://cdn.sofifa.net/teams/1478/30.png</td>
      <td>...</td>
      <td>NaN</td>
      <td>2026</td>
      <td>195cm</td>
      <td>84kg</td>
      <td>€188K</td>
      <td>21.0</td>
      <td>NaN</td>
      <td>16</td>
      <td>&lt;56</td>
      <td>52.877432</td>
    </tr>
    <tr>
      <th>17657</th>
      <td>270567</td>
      <td>A. Demir</td>
      <td>25</td>
      <td>https://cdn.sofifa.net/players/270/567/23_60.png</td>
      <td>Turkey</td>
      <td>https://cdn.sofifa.net/flags/tr.png</td>
      <td>51</td>
      <td>56</td>
      <td>Ümraniyespor</td>
      <td>https://cdn.sofifa.net/teams/113796/30.png</td>
      <td>...</td>
      <td>NaN</td>
      <td>2023</td>
      <td>190cm</td>
      <td>82kg</td>
      <td>€142K</td>
      <td>12.0</td>
      <td>NaN</td>
      <td>5</td>
      <td>&lt;56</td>
      <td>52.877432</td>
    </tr>
    <tr>
      <th>17658</th>
      <td>256624</td>
      <td>21&nbsp;S. Czajor</td>
      <td>18</td>
      <td>https://cdn.sofifa.net/players/256/624/21_60.png</td>
      <td>Poland</td>
      <td>https://cdn.sofifa.net/flags/pl.png</td>
      <td>50</td>
      <td>65</td>
      <td>Fleetwood Town</td>
      <td>https://cdn.sofifa.net/teams/112260/30.png</td>
      <td>...</td>
      <td>NaN</td>
      <td>2021</td>
      <td>187cm</td>
      <td>79kg</td>
      <td>€214K</td>
      <td>40.0</td>
      <td>NaN</td>
      <td>15</td>
      <td>&lt;56</td>
      <td>52.877432</td>
    </tr>
    <tr>
      <th>17659</th>
      <td>256376</td>
      <td>21&nbsp;F. Jakobsson</td>
      <td>20</td>
      <td>https://cdn.sofifa.net/players/256/376/21_60.png</td>
      <td>Sweden</td>
      <td>https://cdn.sofifa.net/flags/se.png</td>
      <td>50</td>
      <td>61</td>
      <td>IFK Norrköping</td>
      <td>https://cdn.sofifa.net/teams/702/30.png</td>
      <td>...</td>
      <td>NaN</td>
      <td>2021</td>
      <td>186cm</td>
      <td>78kg</td>
      <td>€131K</td>
      <td>30.0</td>
      <td>NaN</td>
      <td>11</td>
      <td>&lt;56</td>
      <td>52.877432</td>
    </tr>
  </tbody>
</table>
<p>13644 rows × 32 columns</p>
</div>
</div>
</div>
<div class="cell" data-execution_count="47">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb80-1"><a href="#cb80-1"></a>ggplot(data<span class="op">=</span>df2)<span class="op">\</span></span>
<span id="cb80-2"><a href="#cb80-2"></a><span class="op">+</span>geom_point(aes(x<span class="op">=</span><span class="st">'Overall'</span>,y<span class="op">=</span><span class="st">'Potential2'</span>,color<span class="op">=</span><span class="st">'Overall_grouped'</span>),position<span class="op">=</span><span class="st">'jitter'</span>,alpha<span class="op">=</span><span class="fl">0.05</span>)<span class="op">\</span></span>
<span id="cb80-3"><a href="#cb80-3"></a><span class="op">+</span>geom_boxplot(aes(x<span class="op">=</span><span class="st">'Overall_x'</span>,y<span class="op">=</span><span class="st">'Potential2'</span>,color<span class="op">=</span><span class="st">'Overall_grouped'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2022-10-24-8wk-12_files/figure-html/cell-59-output-1.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display" data-execution_count="47">
<pre><code>&lt;ggplot: (8772275710537)&gt;</code></pre>
</div>
</div>
<p>(방법2)</p>
<div class="cell" data-execution_count="48">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb82-1"><a href="#cb82-1"></a>_df <span class="op">=</span> df.<span class="bu">eval</span>(<span class="st">'Potential2 = Potential - Overall'</span>).query(<span class="st">'Potential2 &gt; 1'</span>)<span class="op">\</span></span>
<span id="cb82-2"><a href="#cb82-2"></a>.assign(Overall_grouped<span class="op">=</span> <span class="kw">lambda</span> df: <span class="bu">list</span>(<span class="bu">map</span>(f,df.Overall)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="49">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb83-1"><a href="#cb83-1"></a>df3<span class="op">=</span>_df.groupby(by<span class="op">=</span><span class="st">"Overall_grouped"</span>).agg({<span class="st">'Overall'</span>:np.mean}).reset_index()<span class="op">\</span></span>
<span id="cb83-2"><a href="#cb83-2"></a>.rename(columns<span class="op">=</span>{<span class="st">'Overall'</span>:<span class="st">'Overall_x'</span>}).merge(_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="50">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb84-1"><a href="#cb84-1"></a>ggplot(data<span class="op">=</span>df3)<span class="op">\</span></span>
<span id="cb84-2"><a href="#cb84-2"></a><span class="op">+</span>geom_point(aes(x<span class="op">=</span><span class="st">'Overall'</span>,y<span class="op">=</span><span class="st">'Potential2'</span>,color<span class="op">=</span><span class="st">'Overall_grouped'</span>),position<span class="op">=</span><span class="st">'jitter'</span>,alpha<span class="op">=</span><span class="fl">0.05</span>)<span class="op">\</span></span>
<span id="cb84-3"><a href="#cb84-3"></a><span class="op">+</span>geom_boxplot(aes(x<span class="op">=</span><span class="st">'Overall_x'</span>,y<span class="op">=</span><span class="st">'Potential2'</span>,color<span class="op">=</span><span class="st">'Overall_grouped'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2022-10-24-8wk-12_files/figure-html/cell-62-output-1.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display" data-execution_count="50">
<pre><code>&lt;ggplot: (8772275671993)&gt;</code></pre>
</div>
</div>
</section>
</section>
<section id="판다스-groupby" class="level1">
<h1>판다스: Groupby</h1>
<section id="flights-data" class="level2">
<h2 class="anchored" data-anchor-id="flights-data">flights data</h2>
<div class="cell" data-execution_count="51">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb86-1"><a href="#cb86-1"></a>df<span class="op">=</span>pd.read_csv(<span class="st">'https://raw.githubusercontent.com/PacktPublishing/Pandas-Cookbook/master/data/flights.csv'</span>)</span>
<span id="cb86-2"><a href="#cb86-2"></a>df.info()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 58492 entries, 0 to 58491
Data columns (total 14 columns):
 #   Column     Non-Null Count  Dtype  
---  ------     --------------  -----  
 0   MONTH      58492 non-null  int64  
 1   DAY        58492 non-null  int64  
 2   WEEKDAY    58492 non-null  int64  
 3   AIRLINE    58492 non-null  object 
 4   ORG_AIR    58492 non-null  object 
 5   DEST_AIR   58492 non-null  object 
 6   SCHED_DEP  58492 non-null  int64  
 7   DEP_DELAY  57659 non-null  float64
 8   AIR_TIME   57474 non-null  float64
 9   DIST       58492 non-null  int64  
 10  SCHED_ARR  58492 non-null  int64  
 11  ARR_DELAY  57474 non-null  float64
 12  DIVERTED   58492 non-null  int64  
 13  CANCELLED  58492 non-null  int64  
dtypes: float64(3), int64(8), object(3)
memory usage: 6.2+ MB</code></pre>
</div>
</div>
</section>
<section id="get_groups" class="level2">
<h2 class="anchored" data-anchor-id="get_groups">get_groups</h2>
<p><code>-</code> groupby - 데이터프레임을 여러개의 서브데이터프레임으로 나누는 기슨 - 단독으로 쓸 이유는 별로 없다. <span class="math inline">\(\to\)</span> 그룹을 나누고 each 그룹마다 어떠한 “변수”에 “연산”을 하기 위함.</p>
<div class="cell" data-execution_count="52">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb88-1"><a href="#cb88-1"></a>df.groupby(by<span class="op">=</span><span class="st">"AIRLINE"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="52">
<pre><code>&lt;pandas.core.groupby.generic.DataFrameGroupBy object at 0x7fa7462529d0&gt;</code></pre>
</div>
</div>
<ul>
<li>지금 이것이 항공사별로 데이터프레임이 나누어진 상태임</li>
</ul>
<p><code>-</code> 진짜 sub dataframe 으로 나누어져 있는지 확인</p>
<div class="cell" data-execution_count="53">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb90-1"><a href="#cb90-1"></a>grouped <span class="op">=</span> df.groupby(by<span class="op">=</span><span class="st">"AIRLINE"</span>)</span>
<span id="cb90-2"><a href="#cb90-2"></a>grouped.groups.keys()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="53">
<pre><code>dict_keys(['AA', 'AS', 'B6', 'DL', 'EV', 'F9', 'HA', 'MQ', 'NK', 'OO', 'UA', 'US', 'VX', 'WN'])</code></pre>
</div>
</div>
<div class="cell" data-execution_count="54">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb92-1"><a href="#cb92-1"></a>display(grouped.get_group(<span class="st">'AS'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>MONTH</th>
      <th>DAY</th>
      <th>WEEKDAY</th>
      <th>AIRLINE</th>
      <th>ORG_AIR</th>
      <th>DEST_AIR</th>
      <th>SCHED_DEP</th>
      <th>DEP_DELAY</th>
      <th>AIR_TIME</th>
      <th>DIST</th>
      <th>SCHED_ARR</th>
      <th>ARR_DELAY</th>
      <th>DIVERTED</th>
      <th>CANCELLED</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>38</th>
      <td>1</td>
      <td>1</td>
      <td>4</td>
      <td>AS</td>
      <td>PHX</td>
      <td>SEA</td>
      <td>1505</td>
      <td>-2.0</td>
      <td>155.0</td>
      <td>1107</td>
      <td>1702</td>
      <td>-3.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>198</th>
      <td>1</td>
      <td>2</td>
      <td>5</td>
      <td>AS</td>
      <td>LAX</td>
      <td>SEA</td>
      <td>2110</td>
      <td>5.0</td>
      <td>145.0</td>
      <td>954</td>
      <td>2352</td>
      <td>8.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>241</th>
      <td>1</td>
      <td>2</td>
      <td>5</td>
      <td>AS</td>
      <td>LAS</td>
      <td>PDX</td>
      <td>650</td>
      <td>-5.0</td>
      <td>117.0</td>
      <td>763</td>
      <td>906</td>
      <td>-3.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>277</th>
      <td>1</td>
      <td>2</td>
      <td>5</td>
      <td>AS</td>
      <td>ORD</td>
      <td>ANC</td>
      <td>935</td>
      <td>-1.0</td>
      <td>402.0</td>
      <td>2846</td>
      <td>1339</td>
      <td>-6.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>397</th>
      <td>1</td>
      <td>3</td>
      <td>6</td>
      <td>AS</td>
      <td>LAS</td>
      <td>SEA</td>
      <td>1300</td>
      <td>48.0</td>
      <td>137.0</td>
      <td>867</td>
      <td>1535</td>
      <td>47.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>58305</th>
      <td>12</td>
      <td>30</td>
      <td>3</td>
      <td>AS</td>
      <td>LAX</td>
      <td>SEA</td>
      <td>1325</td>
      <td>-2.0</td>
      <td>134.0</td>
      <td>954</td>
      <td>1608</td>
      <td>-7.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>58355</th>
      <td>12</td>
      <td>31</td>
      <td>4</td>
      <td>AS</td>
      <td>PHX</td>
      <td>SEA</td>
      <td>1200</td>
      <td>-5.0</td>
      <td>145.0</td>
      <td>1107</td>
      <td>1407</td>
      <td>-24.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>58404</th>
      <td>12</td>
      <td>31</td>
      <td>4</td>
      <td>AS</td>
      <td>SFO</td>
      <td>SLC</td>
      <td>2110</td>
      <td>-2.0</td>
      <td>80.0</td>
      <td>599</td>
      <td>2358</td>
      <td>-4.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>58407</th>
      <td>12</td>
      <td>31</td>
      <td>4</td>
      <td>AS</td>
      <td>SFO</td>
      <td>PDX</td>
      <td>645</td>
      <td>-2.0</td>
      <td>81.0</td>
      <td>550</td>
      <td>832</td>
      <td>-3.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>58428</th>
      <td>12</td>
      <td>31</td>
      <td>4</td>
      <td>AS</td>
      <td>LAX</td>
      <td>SEA</td>
      <td>1420</td>
      <td>-8.0</td>
      <td>127.0</td>
      <td>954</td>
      <td>1709</td>
      <td>-25.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>768 rows × 14 columns</p>
</div>
</div>
</div>
<div class="cell" data-execution_count="55">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb93-1"><a href="#cb93-1"></a><span class="co">#collapse_output</span></span>
<span id="cb93-2"><a href="#cb93-2"></a><span class="cf">for</span> key <span class="kw">in</span> grouped.groups.keys():</span>
<span id="cb93-3"><a href="#cb93-3"></a>    display(grouped.get_group(key))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>MONTH</th>
      <th>DAY</th>
      <th>WEEKDAY</th>
      <th>AIRLINE</th>
      <th>ORG_AIR</th>
      <th>DEST_AIR</th>
      <th>SCHED_DEP</th>
      <th>DEP_DELAY</th>
      <th>AIR_TIME</th>
      <th>DIST</th>
      <th>SCHED_ARR</th>
      <th>ARR_DELAY</th>
      <th>DIVERTED</th>
      <th>CANCELLED</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>1</td>
      <td>4</td>
      <td>AA</td>
      <td>DFW</td>
      <td>DCA</td>
      <td>1555</td>
      <td>7.0</td>
      <td>126.0</td>
      <td>1192</td>
      <td>1935</td>
      <td>-7.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>1</td>
      <td>1</td>
      <td>4</td>
      <td>AA</td>
      <td>DFW</td>
      <td>MSY</td>
      <td>1250</td>
      <td>84.0</td>
      <td>64.0</td>
      <td>447</td>
      <td>1410</td>
      <td>83.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>1</td>
      <td>1</td>
      <td>4</td>
      <td>AA</td>
      <td>ORD</td>
      <td>STL</td>
      <td>1845</td>
      <td>-5.0</td>
      <td>44.0</td>
      <td>258</td>
      <td>1950</td>
      <td>-5.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>15</th>
      <td>1</td>
      <td>1</td>
      <td>4</td>
      <td>AA</td>
      <td>DEN</td>
      <td>DFW</td>
      <td>1445</td>
      <td>-6.0</td>
      <td>93.0</td>
      <td>641</td>
      <td>1745</td>
      <td>4.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>26</th>
      <td>1</td>
      <td>1</td>
      <td>4</td>
      <td>AA</td>
      <td>LAX</td>
      <td>AUS</td>
      <td>1430</td>
      <td>33.0</td>
      <td>157.0</td>
      <td>1242</td>
      <td>1925</td>
      <td>41.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>58470</th>
      <td>12</td>
      <td>31</td>
      <td>4</td>
      <td>AA</td>
      <td>DFW</td>
      <td>FAT</td>
      <td>1020</td>
      <td>-3.0</td>
      <td>196.0</td>
      <td>1313</td>
      <td>1156</td>
      <td>-2.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>58475</th>
      <td>12</td>
      <td>31</td>
      <td>4</td>
      <td>AA</td>
      <td>IAH</td>
      <td>CLT</td>
      <td>710</td>
      <td>1.0</td>
      <td>113.0</td>
      <td>912</td>
      <td>1037</td>
      <td>-12.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>58476</th>
      <td>12</td>
      <td>31</td>
      <td>4</td>
      <td>AA</td>
      <td>DFW</td>
      <td>TPA</td>
      <td>1020</td>
      <td>-3.0</td>
      <td>121.0</td>
      <td>929</td>
      <td>1340</td>
      <td>-6.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>58479</th>
      <td>12</td>
      <td>31</td>
      <td>4</td>
      <td>AA</td>
      <td>DFW</td>
      <td>ELP</td>
      <td>1200</td>
      <td>3.0</td>
      <td>94.0</td>
      <td>551</td>
      <td>1250</td>
      <td>13.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>58487</th>
      <td>12</td>
      <td>31</td>
      <td>4</td>
      <td>AA</td>
      <td>SFO</td>
      <td>DFW</td>
      <td>515</td>
      <td>5.0</td>
      <td>166.0</td>
      <td>1464</td>
      <td>1045</td>
      <td>-19.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>8900 rows × 14 columns</p>
</div>
</div>
<div class="cell-output cell-output-display">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>MONTH</th>
      <th>DAY</th>
      <th>WEEKDAY</th>
      <th>AIRLINE</th>
      <th>ORG_AIR</th>
      <th>DEST_AIR</th>
      <th>SCHED_DEP</th>
      <th>DEP_DELAY</th>
      <th>AIR_TIME</th>
      <th>DIST</th>
      <th>SCHED_ARR</th>
      <th>ARR_DELAY</th>
      <th>DIVERTED</th>
      <th>CANCELLED</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>38</th>
      <td>1</td>
      <td>1</td>
      <td>4</td>
      <td>AS</td>
      <td>PHX</td>
      <td>SEA</td>
      <td>1505</td>
      <td>-2.0</td>
      <td>155.0</td>
      <td>1107</td>
      <td>1702</td>
      <td>-3.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>198</th>
      <td>1</td>
      <td>2</td>
      <td>5</td>
      <td>AS</td>
      <td>LAX</td>
      <td>SEA</td>
      <td>2110</td>
      <td>5.0</td>
      <td>145.0</td>
      <td>954</td>
      <td>2352</td>
      <td>8.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>241</th>
      <td>1</td>
      <td>2</td>
      <td>5</td>
      <td>AS</td>
      <td>LAS</td>
      <td>PDX</td>
      <td>650</td>
      <td>-5.0</td>
      <td>117.0</td>
      <td>763</td>
      <td>906</td>
      <td>-3.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>277</th>
      <td>1</td>
      <td>2</td>
      <td>5</td>
      <td>AS</td>
      <td>ORD</td>
      <td>ANC</td>
      <td>935</td>
      <td>-1.0</td>
      <td>402.0</td>
      <td>2846</td>
      <td>1339</td>
      <td>-6.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>397</th>
      <td>1</td>
      <td>3</td>
      <td>6</td>
      <td>AS</td>
      <td>LAS</td>
      <td>SEA</td>
      <td>1300</td>
      <td>48.0</td>
      <td>137.0</td>
      <td>867</td>
      <td>1535</td>
      <td>47.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>58305</th>
      <td>12</td>
      <td>30</td>
      <td>3</td>
      <td>AS</td>
      <td>LAX</td>
      <td>SEA</td>
      <td>1325</td>
      <td>-2.0</td>
      <td>134.0</td>
      <td>954</td>
      <td>1608</td>
      <td>-7.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>58355</th>
      <td>12</td>
      <td>31</td>
      <td>4</td>
      <td>AS</td>
      <td>PHX</td>
      <td>SEA</td>
      <td>1200</td>
      <td>-5.0</td>
      <td>145.0</td>
      <td>1107</td>
      <td>1407</td>
      <td>-24.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>58404</th>
      <td>12</td>
      <td>31</td>
      <td>4</td>
      <td>AS</td>
      <td>SFO</td>
      <td>SLC</td>
      <td>2110</td>
      <td>-2.0</td>
      <td>80.0</td>
      <td>599</td>
      <td>2358</td>
      <td>-4.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>58407</th>
      <td>12</td>
      <td>31</td>
      <td>4</td>
      <td>AS</td>
      <td>SFO</td>
      <td>PDX</td>
      <td>645</td>
      <td>-2.0</td>
      <td>81.0</td>
      <td>550</td>
      <td>832</td>
      <td>-3.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>58428</th>
      <td>12</td>
      <td>31</td>
      <td>4</td>
      <td>AS</td>
      <td>LAX</td>
      <td>SEA</td>
      <td>1420</td>
      <td>-8.0</td>
      <td>127.0</td>
      <td>954</td>
      <td>1709</td>
      <td>-25.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>768 rows × 14 columns</p>
</div>
</div>
<div class="cell-output cell-output-display">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>MONTH</th>
      <th>DAY</th>
      <th>WEEKDAY</th>
      <th>AIRLINE</th>
      <th>ORG_AIR</th>
      <th>DEST_AIR</th>
      <th>SCHED_DEP</th>
      <th>DEP_DELAY</th>
      <th>AIR_TIME</th>
      <th>DIST</th>
      <th>SCHED_ARR</th>
      <th>ARR_DELAY</th>
      <th>DIVERTED</th>
      <th>CANCELLED</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>123</th>
      <td>1</td>
      <td>1</td>
      <td>4</td>
      <td>B6</td>
      <td>LAS</td>
      <td>BOS</td>
      <td>1230</td>
      <td>0.0</td>
      <td>246.0</td>
      <td>2381</td>
      <td>2026</td>
      <td>-27.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>127</th>
      <td>1</td>
      <td>1</td>
      <td>4</td>
      <td>B6</td>
      <td>LAS</td>
      <td>BOS</td>
      <td>2359</td>
      <td>68.0</td>
      <td>247.0</td>
      <td>2381</td>
      <td>749</td>
      <td>46.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>239</th>
      <td>1</td>
      <td>2</td>
      <td>5</td>
      <td>B6</td>
      <td>ORD</td>
      <td>BOS</td>
      <td>540</td>
      <td>-8.0</td>
      <td>96.0</td>
      <td>867</td>
      <td>856</td>
      <td>-22.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>333</th>
      <td>1</td>
      <td>3</td>
      <td>6</td>
      <td>B6</td>
      <td>LAX</td>
      <td>FLL</td>
      <td>2237</td>
      <td>32.0</td>
      <td>270.0</td>
      <td>2342</td>
      <td>619</td>
      <td>42.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>548</th>
      <td>1</td>
      <td>4</td>
      <td>7</td>
      <td>B6</td>
      <td>SFO</td>
      <td>FLL</td>
      <td>2307</td>
      <td>-4.0</td>
      <td>298.0</td>
      <td>2583</td>
      <td>724</td>
      <td>-1.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>58262</th>
      <td>12</td>
      <td>30</td>
      <td>3</td>
      <td>B6</td>
      <td>SFO</td>
      <td>LGB</td>
      <td>1921</td>
      <td>-6.0</td>
      <td>57.0</td>
      <td>354</td>
      <td>2038</td>
      <td>-14.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>58301</th>
      <td>12</td>
      <td>30</td>
      <td>3</td>
      <td>B6</td>
      <td>LAX</td>
      <td>JFK</td>
      <td>630</td>
      <td>4.0</td>
      <td>285.0</td>
      <td>2475</td>
      <td>1445</td>
      <td>-6.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>58425</th>
      <td>12</td>
      <td>31</td>
      <td>4</td>
      <td>B6</td>
      <td>ORD</td>
      <td>SJU</td>
      <td>700</td>
      <td>239.0</td>
      <td>250.0</td>
      <td>2072</td>
      <td>1335</td>
      <td>239.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>58477</th>
      <td>12</td>
      <td>31</td>
      <td>4</td>
      <td>B6</td>
      <td>DFW</td>
      <td>BOS</td>
      <td>1145</td>
      <td>12.0</td>
      <td>161.0</td>
      <td>1562</td>
      <td>1608</td>
      <td>-14.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>58483</th>
      <td>12</td>
      <td>31</td>
      <td>4</td>
      <td>B6</td>
      <td>PHX</td>
      <td>BOS</td>
      <td>2236</td>
      <td>-12.0</td>
      <td>231.0</td>
      <td>2300</td>
      <td>515</td>
      <td>-45.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>543 rows × 14 columns</p>
</div>
</div>
<div class="cell-output cell-output-display">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>MONTH</th>
      <th>DAY</th>
      <th>WEEKDAY</th>
      <th>AIRLINE</th>
      <th>ORG_AIR</th>
      <th>DEST_AIR</th>
      <th>SCHED_DEP</th>
      <th>DEP_DELAY</th>
      <th>AIR_TIME</th>
      <th>DIST</th>
      <th>SCHED_ARR</th>
      <th>ARR_DELAY</th>
      <th>DIVERTED</th>
      <th>CANCELLED</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>53</th>
      <td>1</td>
      <td>1</td>
      <td>4</td>
      <td>DL</td>
      <td>LAS</td>
      <td>MSP</td>
      <td>713</td>
      <td>-5.0</td>
      <td>156.0</td>
      <td>1299</td>
      <td>1220</td>
      <td>-18.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>57</th>
      <td>1</td>
      <td>1</td>
      <td>4</td>
      <td>DL</td>
      <td>MSP</td>
      <td>RSW</td>
      <td>700</td>
      <td>-1.0</td>
      <td>169.0</td>
      <td>1416</td>
      <td>1130</td>
      <td>-20.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>77</th>
      <td>1</td>
      <td>1</td>
      <td>4</td>
      <td>DL</td>
      <td>LAX</td>
      <td>ATL</td>
      <td>1130</td>
      <td>24.0</td>
      <td>217.0</td>
      <td>1947</td>
      <td>1840</td>
      <td>16.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>79</th>
      <td>1</td>
      <td>1</td>
      <td>4</td>
      <td>DL</td>
      <td>LAX</td>
      <td>CMH</td>
      <td>2146</td>
      <td>-3.0</td>
      <td>223.0</td>
      <td>1995</td>
      <td>459</td>
      <td>-13.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>85</th>
      <td>1</td>
      <td>1</td>
      <td>4</td>
      <td>DL</td>
      <td>ATL</td>
      <td>OKC</td>
      <td>2059</td>
      <td>-4.0</td>
      <td>116.0</td>
      <td>761</td>
      <td>2227</td>
      <td>-12.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>58440</th>
      <td>12</td>
      <td>31</td>
      <td>4</td>
      <td>DL</td>
      <td>ATL</td>
      <td>CVG</td>
      <td>1611</td>
      <td>-4.0</td>
      <td>61.0</td>
      <td>373</td>
      <td>1736</td>
      <td>-6.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>58448</th>
      <td>12</td>
      <td>31</td>
      <td>4</td>
      <td>DL</td>
      <td>ATL</td>
      <td>SRQ</td>
      <td>1610</td>
      <td>0.0</td>
      <td>61.0</td>
      <td>444</td>
      <td>1740</td>
      <td>-13.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>58464</th>
      <td>12</td>
      <td>31</td>
      <td>4</td>
      <td>DL</td>
      <td>LAX</td>
      <td>SFO</td>
      <td>700</td>
      <td>108.0</td>
      <td>54.0</td>
      <td>337</td>
      <td>825</td>
      <td>105.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>58467</th>
      <td>12</td>
      <td>31</td>
      <td>4</td>
      <td>DL</td>
      <td>ATL</td>
      <td>IND</td>
      <td>1235</td>
      <td>-3.0</td>
      <td>63.0</td>
      <td>432</td>
      <td>1407</td>
      <td>-13.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>58485</th>
      <td>12</td>
      <td>31</td>
      <td>4</td>
      <td>DL</td>
      <td>ATL</td>
      <td>CMH</td>
      <td>2206</td>
      <td>2.0</td>
      <td>64.0</td>
      <td>447</td>
      <td>2338</td>
      <td>-8.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>10601 rows × 14 columns</p>
</div>
</div>
<div class="cell-output cell-output-display">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>MONTH</th>
      <th>DAY</th>
      <th>WEEKDAY</th>
      <th>AIRLINE</th>
      <th>ORG_AIR</th>
      <th>DEST_AIR</th>
      <th>SCHED_DEP</th>
      <th>DEP_DELAY</th>
      <th>AIR_TIME</th>
      <th>DIST</th>
      <th>SCHED_ARR</th>
      <th>ARR_DELAY</th>
      <th>DIVERTED</th>
      <th>CANCELLED</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>11</th>
      <td>1</td>
      <td>1</td>
      <td>4</td>
      <td>EV</td>
      <td>ORD</td>
      <td>JAN</td>
      <td>1155</td>
      <td>6.0</td>
      <td>113.0</td>
      <td>677</td>
      <td>1403</td>
      <td>5.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>13</th>
      <td>1</td>
      <td>1</td>
      <td>4</td>
      <td>EV</td>
      <td>ORD</td>
      <td>CMH</td>
      <td>1010</td>
      <td>-2.0</td>
      <td>46.0</td>
      <td>296</td>
      <td>1228</td>
      <td>-9.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>29</th>
      <td>1</td>
      <td>1</td>
      <td>4</td>
      <td>EV</td>
      <td>ORD</td>
      <td>IND</td>
      <td>1025</td>
      <td>-6.0</td>
      <td>29.0</td>
      <td>177</td>
      <td>1228</td>
      <td>-19.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>40</th>
      <td>1</td>
      <td>1</td>
      <td>4</td>
      <td>EV</td>
      <td>IAH</td>
      <td>CLE</td>
      <td>1038</td>
      <td>-3.0</td>
      <td>126.0</td>
      <td>1091</td>
      <td>1425</td>
      <td>-18.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>69</th>
      <td>1</td>
      <td>1</td>
      <td>4</td>
      <td>EV</td>
      <td>ATL</td>
      <td>RAP</td>
      <td>1930</td>
      <td>-5.0</td>
      <td>181.0</td>
      <td>1230</td>
      <td>2104</td>
      <td>-15.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>58445</th>
      <td>12</td>
      <td>31</td>
      <td>4</td>
      <td>EV</td>
      <td>DFW</td>
      <td>TXK</td>
      <td>850</td>
      <td>-5.0</td>
      <td>30.0</td>
      <td>181</td>
      <td>948</td>
      <td>-17.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>58452</th>
      <td>12</td>
      <td>31</td>
      <td>4</td>
      <td>EV</td>
      <td>DFW</td>
      <td>SHV</td>
      <td>1650</td>
      <td>-4.0</td>
      <td>32.0</td>
      <td>190</td>
      <td>1746</td>
      <td>-12.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>58459</th>
      <td>12</td>
      <td>31</td>
      <td>4</td>
      <td>EV</td>
      <td>MSP</td>
      <td>ORD</td>
      <td>1435</td>
      <td>18.0</td>
      <td>61.0</td>
      <td>334</td>
      <td>1609</td>
      <td>3.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>58463</th>
      <td>12</td>
      <td>31</td>
      <td>4</td>
      <td>EV</td>
      <td>ORD</td>
      <td>MSN</td>
      <td>1220</td>
      <td>18.0</td>
      <td>32.0</td>
      <td>108</td>
      <td>1319</td>
      <td>27.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>58486</th>
      <td>12</td>
      <td>31</td>
      <td>4</td>
      <td>EV</td>
      <td>DFW</td>
      <td>LFT</td>
      <td>850</td>
      <td>21.0</td>
      <td>52.0</td>
      <td>351</td>
      <td>1012</td>
      <td>14.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>5858 rows × 14 columns</p>
</div>
</div>
<div class="cell-output cell-output-display">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>MONTH</th>
      <th>DAY</th>
      <th>WEEKDAY</th>
      <th>AIRLINE</th>
      <th>ORG_AIR</th>
      <th>DEST_AIR</th>
      <th>SCHED_DEP</th>
      <th>DEP_DELAY</th>
      <th>AIR_TIME</th>
      <th>DIST</th>
      <th>SCHED_ARR</th>
      <th>ARR_DELAY</th>
      <th>DIVERTED</th>
      <th>CANCELLED</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>7</th>
      <td>1</td>
      <td>1</td>
      <td>4</td>
      <td>F9</td>
      <td>SFO</td>
      <td>PHX</td>
      <td>1020</td>
      <td>-7.0</td>
      <td>91.0</td>
      <td>651</td>
      <td>1315</td>
      <td>-6.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>93</th>
      <td>1</td>
      <td>1</td>
      <td>4</td>
      <td>F9</td>
      <td>ATL</td>
      <td>DEN</td>
      <td>859</td>
      <td>16.0</td>
      <td>181.0</td>
      <td>1199</td>
      <td>1026</td>
      <td>10.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>209</th>
      <td>1</td>
      <td>2</td>
      <td>5</td>
      <td>F9</td>
      <td>MSP</td>
      <td>DEN</td>
      <td>1025</td>
      <td>-6.0</td>
      <td>97.0</td>
      <td>680</td>
      <td>1134</td>
      <td>-13.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>232</th>
      <td>1</td>
      <td>2</td>
      <td>5</td>
      <td>F9</td>
      <td>DEN</td>
      <td>PHX</td>
      <td>2040</td>
      <td>-7.0</td>
      <td>83.0</td>
      <td>602</td>
      <td>2228</td>
      <td>-18.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>247</th>
      <td>1</td>
      <td>2</td>
      <td>5</td>
      <td>F9</td>
      <td>ORD</td>
      <td>ATL</td>
      <td>730</td>
      <td>10.0</td>
      <td>86.0</td>
      <td>606</td>
      <td>1020</td>
      <td>23.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>58288</th>
      <td>12</td>
      <td>30</td>
      <td>3</td>
      <td>F9</td>
      <td>DEN</td>
      <td>ORD</td>
      <td>625</td>
      <td>-4.0</td>
      <td>136.0</td>
      <td>888</td>
      <td>1000</td>
      <td>14.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>58331</th>
      <td>12</td>
      <td>30</td>
      <td>3</td>
      <td>F9</td>
      <td>ORD</td>
      <td>PHX</td>
      <td>825</td>
      <td>18.0</td>
      <td>207.0</td>
      <td>1440</td>
      <td>1127</td>
      <td>14.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>58447</th>
      <td>12</td>
      <td>31</td>
      <td>4</td>
      <td>F9</td>
      <td>DEN</td>
      <td>LAS</td>
      <td>1245</td>
      <td>13.0</td>
      <td>94.0</td>
      <td>628</td>
      <td>1340</td>
      <td>13.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>58449</th>
      <td>12</td>
      <td>31</td>
      <td>4</td>
      <td>F9</td>
      <td>DEN</td>
      <td>MCO</td>
      <td>645</td>
      <td>11.0</td>
      <td>169.0</td>
      <td>1546</td>
      <td>1224</td>
      <td>-11.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>58488</th>
      <td>12</td>
      <td>31</td>
      <td>4</td>
      <td>F9</td>
      <td>LAS</td>
      <td>SFO</td>
      <td>1910</td>
      <td>13.0</td>
      <td>71.0</td>
      <td>414</td>
      <td>2050</td>
      <td>4.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>1317 rows × 14 columns</p>
</div>
</div>
<div class="cell-output cell-output-display">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>MONTH</th>
      <th>DAY</th>
      <th>WEEKDAY</th>
      <th>AIRLINE</th>
      <th>ORG_AIR</th>
      <th>DEST_AIR</th>
      <th>SCHED_DEP</th>
      <th>DEP_DELAY</th>
      <th>AIR_TIME</th>
      <th>DIST</th>
      <th>SCHED_ARR</th>
      <th>ARR_DELAY</th>
      <th>DIVERTED</th>
      <th>CANCELLED</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>582</th>
      <td>1</td>
      <td>4</td>
      <td>7</td>
      <td>HA</td>
      <td>LAX</td>
      <td>OGG</td>
      <td>1115</td>
      <td>-11.0</td>
      <td>310.0</td>
      <td>2486</td>
      <td>1500</td>
      <td>-27.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>712</th>
      <td>1</td>
      <td>5</td>
      <td>1</td>
      <td>HA</td>
      <td>LAS</td>
      <td>HNL</td>
      <td>900</td>
      <td>-5.0</td>
      <td>357.0</td>
      <td>2762</td>
      <td>1315</td>
      <td>5.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>878</th>
      <td>1</td>
      <td>6</td>
      <td>2</td>
      <td>HA</td>
      <td>PHX</td>
      <td>HNL</td>
      <td>800</td>
      <td>1.0</td>
      <td>374.0</td>
      <td>2917</td>
      <td>1140</td>
      <td>3.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1053</th>
      <td>1</td>
      <td>7</td>
      <td>3</td>
      <td>HA</td>
      <td>LAX</td>
      <td>HNL</td>
      <td>1705</td>
      <td>0.0</td>
      <td>332.0</td>
      <td>2556</td>
      <td>2055</td>
      <td>-2.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1269</th>
      <td>1</td>
      <td>8</td>
      <td>4</td>
      <td>HA</td>
      <td>LAX</td>
      <td>HNL</td>
      <td>1000</td>
      <td>-1.0</td>
      <td>335.0</td>
      <td>2556</td>
      <td>1350</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>55883</th>
      <td>12</td>
      <td>16</td>
      <td>3</td>
      <td>HA</td>
      <td>LAX</td>
      <td>HNL</td>
      <td>835</td>
      <td>1.0</td>
      <td>314.0</td>
      <td>2556</td>
      <td>1235</td>
      <td>-18.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>56174</th>
      <td>12</td>
      <td>18</td>
      <td>5</td>
      <td>HA</td>
      <td>LAX</td>
      <td>HNL</td>
      <td>835</td>
      <td>-5.0</td>
      <td>342.0</td>
      <td>2556</td>
      <td>1235</td>
      <td>-4.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>56350</th>
      <td>12</td>
      <td>19</td>
      <td>6</td>
      <td>HA</td>
      <td>PHX</td>
      <td>HNL</td>
      <td>800</td>
      <td>-5.0</td>
      <td>363.0</td>
      <td>2917</td>
      <td>1155</td>
      <td>-34.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>56816</th>
      <td>12</td>
      <td>21</td>
      <td>1</td>
      <td>HA</td>
      <td>LAX</td>
      <td>LIH</td>
      <td>740</td>
      <td>20.0</td>
      <td>303.0</td>
      <td>2615</td>
      <td>1145</td>
      <td>-11.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>58391</th>
      <td>12</td>
      <td>31</td>
      <td>4</td>
      <td>HA</td>
      <td>LAX</td>
      <td>HNL</td>
      <td>1000</td>
      <td>0.0</td>
      <td>324.0</td>
      <td>2556</td>
      <td>1350</td>
      <td>-9.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>112 rows × 14 columns</p>
</div>
</div>
<div class="cell-output cell-output-display">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>MONTH</th>
      <th>DAY</th>
      <th>WEEKDAY</th>
      <th>AIRLINE</th>
      <th>ORG_AIR</th>
      <th>DEST_AIR</th>
      <th>SCHED_DEP</th>
      <th>DEP_DELAY</th>
      <th>AIR_TIME</th>
      <th>DIST</th>
      <th>SCHED_ARR</th>
      <th>ARR_DELAY</th>
      <th>DIVERTED</th>
      <th>CANCELLED</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>1</td>
      <td>4</td>
      <td>MQ</td>
      <td>DFW</td>
      <td>VPS</td>
      <td>1305</td>
      <td>36.0</td>
      <td>85.0</td>
      <td>641</td>
      <td>1453</td>
      <td>35.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>10</th>
      <td>1</td>
      <td>1</td>
      <td>4</td>
      <td>MQ</td>
      <td>DFW</td>
      <td>DRO</td>
      <td>1335</td>
      <td>28.0</td>
      <td>104.0</td>
      <td>674</td>
      <td>1438</td>
      <td>28.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>18</th>
      <td>1</td>
      <td>1</td>
      <td>4</td>
      <td>MQ</td>
      <td>ORD</td>
      <td>DAY</td>
      <td>2220</td>
      <td>19.0</td>
      <td>37.0</td>
      <td>240</td>
      <td>23</td>
      <td>20.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>24</th>
      <td>1</td>
      <td>1</td>
      <td>4</td>
      <td>MQ</td>
      <td>DFW</td>
      <td>BTR</td>
      <td>730</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>383</td>
      <td>853</td>
      <td>NaN</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>50</th>
      <td>1</td>
      <td>1</td>
      <td>4</td>
      <td>MQ</td>
      <td>ORD</td>
      <td>CID</td>
      <td>1135</td>
      <td>-7.0</td>
      <td>37.0</td>
      <td>196</td>
      <td>1238</td>
      <td>-15.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>58415</th>
      <td>12</td>
      <td>31</td>
      <td>4</td>
      <td>MQ</td>
      <td>ORD</td>
      <td>FWA</td>
      <td>845</td>
      <td>-2.0</td>
      <td>37.0</td>
      <td>157</td>
      <td>1045</td>
      <td>-4.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>58426</th>
      <td>12</td>
      <td>31</td>
      <td>4</td>
      <td>MQ</td>
      <td>DFW</td>
      <td>FAR</td>
      <td>1154</td>
      <td>4.0</td>
      <td>124.0</td>
      <td>968</td>
      <td>1437</td>
      <td>-13.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>58468</th>
      <td>12</td>
      <td>31</td>
      <td>4</td>
      <td>MQ</td>
      <td>DFW</td>
      <td>OKC</td>
      <td>1720</td>
      <td>-3.0</td>
      <td>31.0</td>
      <td>175</td>
      <td>1819</td>
      <td>-10.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>58474</th>
      <td>12</td>
      <td>31</td>
      <td>4</td>
      <td>MQ</td>
      <td>ORD</td>
      <td>FNT</td>
      <td>829</td>
      <td>4.0</td>
      <td>40.0</td>
      <td>223</td>
      <td>1034</td>
      <td>-4.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>58484</th>
      <td>12</td>
      <td>31</td>
      <td>4</td>
      <td>MQ</td>
      <td>ORD</td>
      <td>DSM</td>
      <td>1333</td>
      <td>1.0</td>
      <td>57.0</td>
      <td>299</td>
      <td>1455</td>
      <td>-7.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>3471 rows × 14 columns</p>
</div>
</div>
<div class="cell-output cell-output-display">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>MONTH</th>
      <th>DAY</th>
      <th>WEEKDAY</th>
      <th>AIRLINE</th>
      <th>ORG_AIR</th>
      <th>DEST_AIR</th>
      <th>SCHED_DEP</th>
      <th>DEP_DELAY</th>
      <th>AIR_TIME</th>
      <th>DIST</th>
      <th>SCHED_ARR</th>
      <th>ARR_DELAY</th>
      <th>DIVERTED</th>
      <th>CANCELLED</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>17</th>
      <td>1</td>
      <td>1</td>
      <td>4</td>
      <td>NK</td>
      <td>DEN</td>
      <td>DTW</td>
      <td>1952</td>
      <td>37.0</td>
      <td>124.0</td>
      <td>1123</td>
      <td>31</td>
      <td>54.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>74</th>
      <td>1</td>
      <td>1</td>
      <td>4</td>
      <td>NK</td>
      <td>PHX</td>
      <td>DFW</td>
      <td>159</td>
      <td>-1.0</td>
      <td>103.0</td>
      <td>868</td>
      <td>502</td>
      <td>1.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>95</th>
      <td>1</td>
      <td>1</td>
      <td>4</td>
      <td>NK</td>
      <td>LAS</td>
      <td>OAK</td>
      <td>1115</td>
      <td>22.0</td>
      <td>62.0</td>
      <td>407</td>
      <td>1246</td>
      <td>10.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>109</th>
      <td>1</td>
      <td>1</td>
      <td>4</td>
      <td>NK</td>
      <td>MSP</td>
      <td>ORD</td>
      <td>616</td>
      <td>2.0</td>
      <td>49.0</td>
      <td>334</td>
      <td>745</td>
      <td>-19.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>166</th>
      <td>1</td>
      <td>2</td>
      <td>5</td>
      <td>NK</td>
      <td>LAS</td>
      <td>PDX</td>
      <td>1535</td>
      <td>-8.0</td>
      <td>123.0</td>
      <td>763</td>
      <td>1754</td>
      <td>-4.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>58160</th>
      <td>12</td>
      <td>29</td>
      <td>2</td>
      <td>NK</td>
      <td>MSP</td>
      <td>MCO</td>
      <td>740</td>
      <td>0.0</td>
      <td>171.0</td>
      <td>1310</td>
      <td>1158</td>
      <td>33.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>58197</th>
      <td>12</td>
      <td>30</td>
      <td>3</td>
      <td>NK</td>
      <td>IAH</td>
      <td>ORD</td>
      <td>755</td>
      <td>-8.0</td>
      <td>136.0</td>
      <td>925</td>
      <td>1030</td>
      <td>-2.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>58437</th>
      <td>12</td>
      <td>31</td>
      <td>4</td>
      <td>NK</td>
      <td>ORD</td>
      <td>DFW</td>
      <td>1952</td>
      <td>15.0</td>
      <td>135.0</td>
      <td>802</td>
      <td>2225</td>
      <td>23.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>58461</th>
      <td>12</td>
      <td>31</td>
      <td>4</td>
      <td>NK</td>
      <td>ORD</td>
      <td>LGA</td>
      <td>1801</td>
      <td>-5.0</td>
      <td>84.0</td>
      <td>733</td>
      <td>2109</td>
      <td>-26.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>58469</th>
      <td>12</td>
      <td>31</td>
      <td>4</td>
      <td>NK</td>
      <td>LAS</td>
      <td>MSY</td>
      <td>1950</td>
      <td>124.0</td>
      <td>163.0</td>
      <td>1500</td>
      <td>112</td>
      <td>101.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>1516 rows × 14 columns</p>
</div>
</div>
<div class="cell-output cell-output-display">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>MONTH</th>
      <th>DAY</th>
      <th>WEEKDAY</th>
      <th>AIRLINE</th>
      <th>ORG_AIR</th>
      <th>DEST_AIR</th>
      <th>SCHED_DEP</th>
      <th>DEP_DELAY</th>
      <th>AIR_TIME</th>
      <th>DIST</th>
      <th>SCHED_ARR</th>
      <th>ARR_DELAY</th>
      <th>DIVERTED</th>
      <th>CANCELLED</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>12</th>
      <td>1</td>
      <td>1</td>
      <td>4</td>
      <td>OO</td>
      <td>ORD</td>
      <td>MSP</td>
      <td>1510</td>
      <td>2.0</td>
      <td>65.0</td>
      <td>334</td>
      <td>1646</td>
      <td>4.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>16</th>
      <td>1</td>
      <td>1</td>
      <td>4</td>
      <td>OO</td>
      <td>DEN</td>
      <td>SGU</td>
      <td>1105</td>
      <td>21.0</td>
      <td>66.0</td>
      <td>517</td>
      <td>1249</td>
      <td>20.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>22</th>
      <td>1</td>
      <td>1</td>
      <td>4</td>
      <td>OO</td>
      <td>LAS</td>
      <td>LAX</td>
      <td>1544</td>
      <td>-4.0</td>
      <td>39.0</td>
      <td>236</td>
      <td>1655</td>
      <td>-12.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>25</th>
      <td>1</td>
      <td>1</td>
      <td>4</td>
      <td>OO</td>
      <td>ORD</td>
      <td>SPI</td>
      <td>2110</td>
      <td>-4.0</td>
      <td>31.0</td>
      <td>174</td>
      <td>2205</td>
      <td>5.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>27</th>
      <td>1</td>
      <td>1</td>
      <td>4</td>
      <td>OO</td>
      <td>IAH</td>
      <td>JAC</td>
      <td>1104</td>
      <td>-1.0</td>
      <td>161.0</td>
      <td>1265</td>
      <td>1316</td>
      <td>-1.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>58451</th>
      <td>12</td>
      <td>31</td>
      <td>4</td>
      <td>OO</td>
      <td>ATL</td>
      <td>FWA</td>
      <td>1905</td>
      <td>-3.0</td>
      <td>72.0</td>
      <td>508</td>
      <td>2051</td>
      <td>-14.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>58480</th>
      <td>12</td>
      <td>31</td>
      <td>4</td>
      <td>OO</td>
      <td>MSP</td>
      <td>BIS</td>
      <td>1310</td>
      <td>-2.0</td>
      <td>65.0</td>
      <td>386</td>
      <td>1449</td>
      <td>-9.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>58482</th>
      <td>12</td>
      <td>31</td>
      <td>4</td>
      <td>OO</td>
      <td>DEN</td>
      <td>CPR</td>
      <td>1850</td>
      <td>-2.0</td>
      <td>38.0</td>
      <td>230</td>
      <td>1956</td>
      <td>1.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>58489</th>
      <td>12</td>
      <td>31</td>
      <td>4</td>
      <td>OO</td>
      <td>SFO</td>
      <td>SBA</td>
      <td>1846</td>
      <td>-6.0</td>
      <td>46.0</td>
      <td>262</td>
      <td>1956</td>
      <td>-5.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>58491</th>
      <td>12</td>
      <td>31</td>
      <td>4</td>
      <td>OO</td>
      <td>SFO</td>
      <td>BOI</td>
      <td>859</td>
      <td>5.0</td>
      <td>73.0</td>
      <td>522</td>
      <td>1146</td>
      <td>-1.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>6588 rows × 14 columns</p>
</div>
</div>
<div class="cell-output cell-output-display">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>MONTH</th>
      <th>DAY</th>
      <th>WEEKDAY</th>
      <th>AIRLINE</th>
      <th>ORG_AIR</th>
      <th>DEST_AIR</th>
      <th>SCHED_DEP</th>
      <th>DEP_DELAY</th>
      <th>AIR_TIME</th>
      <th>DIST</th>
      <th>SCHED_ARR</th>
      <th>ARR_DELAY</th>
      <th>DIVERTED</th>
      <th>CANCELLED</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>1</td>
      <td>4</td>
      <td>UA</td>
      <td>DEN</td>
      <td>IAD</td>
      <td>823</td>
      <td>7.0</td>
      <td>154.0</td>
      <td>1452</td>
      <td>1333</td>
      <td>-13.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1</td>
      <td>1</td>
      <td>4</td>
      <td>UA</td>
      <td>IAH</td>
      <td>SAN</td>
      <td>1450</td>
      <td>1.0</td>
      <td>178.0</td>
      <td>1303</td>
      <td>1620</td>
      <td>-14.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>1</td>
      <td>1</td>
      <td>4</td>
      <td>UA</td>
      <td>IAH</td>
      <td>SJC</td>
      <td>925</td>
      <td>3.0</td>
      <td>215.0</td>
      <td>1608</td>
      <td>1136</td>
      <td>-14.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>14</th>
      <td>1</td>
      <td>1</td>
      <td>4</td>
      <td>UA</td>
      <td>IAH</td>
      <td>IND</td>
      <td>1426</td>
      <td>-1.0</td>
      <td>102.0</td>
      <td>844</td>
      <td>1742</td>
      <td>-20.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>21</th>
      <td>1</td>
      <td>1</td>
      <td>4</td>
      <td>UA</td>
      <td>ORD</td>
      <td>CLE</td>
      <td>2102</td>
      <td>48.0</td>
      <td>47.0</td>
      <td>315</td>
      <td>2320</td>
      <td>41.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>58422</th>
      <td>12</td>
      <td>31</td>
      <td>4</td>
      <td>UA</td>
      <td>DEN</td>
      <td>SAN</td>
      <td>1535</td>
      <td>0.0</td>
      <td>124.0</td>
      <td>853</td>
      <td>1704</td>
      <td>-13.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>58432</th>
      <td>12</td>
      <td>31</td>
      <td>4</td>
      <td>UA</td>
      <td>ORD</td>
      <td>SAN</td>
      <td>1915</td>
      <td>7.0</td>
      <td>238.0</td>
      <td>1723</td>
      <td>2143</td>
      <td>-3.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>58457</th>
      <td>12</td>
      <td>31</td>
      <td>4</td>
      <td>UA</td>
      <td>ORD</td>
      <td>LAX</td>
      <td>659</td>
      <td>-1.0</td>
      <td>241.0</td>
      <td>1744</td>
      <td>946</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>58460</th>
      <td>12</td>
      <td>31</td>
      <td>4</td>
      <td>UA</td>
      <td>SFO</td>
      <td>PHL</td>
      <td>2235</td>
      <td>-6.0</td>
      <td>265.0</td>
      <td>2521</td>
      <td>700</td>
      <td>-42.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>58481</th>
      <td>12</td>
      <td>31</td>
      <td>4</td>
      <td>UA</td>
      <td>IAH</td>
      <td>LAX</td>
      <td>1433</td>
      <td>1.0</td>
      <td>197.0</td>
      <td>1379</td>
      <td>1625</td>
      <td>-13.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>7792 rows × 14 columns</p>
</div>
</div>
<div class="cell-output cell-output-display">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>MONTH</th>
      <th>DAY</th>
      <th>WEEKDAY</th>
      <th>AIRLINE</th>
      <th>ORG_AIR</th>
      <th>DEST_AIR</th>
      <th>SCHED_DEP</th>
      <th>DEP_DELAY</th>
      <th>AIR_TIME</th>
      <th>DIST</th>
      <th>SCHED_ARR</th>
      <th>ARR_DELAY</th>
      <th>DIVERTED</th>
      <th>CANCELLED</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>31</th>
      <td>1</td>
      <td>1</td>
      <td>4</td>
      <td>US</td>
      <td>PHX</td>
      <td>DEN</td>
      <td>1810</td>
      <td>29.0</td>
      <td>94.0</td>
      <td>602</td>
      <td>1954</td>
      <td>49.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>35</th>
      <td>1</td>
      <td>1</td>
      <td>4</td>
      <td>US</td>
      <td>ORD</td>
      <td>PHL</td>
      <td>1600</td>
      <td>-2.0</td>
      <td>80.0</td>
      <td>678</td>
      <td>1857</td>
      <td>-9.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>49</th>
      <td>1</td>
      <td>1</td>
      <td>4</td>
      <td>US</td>
      <td>IAH</td>
      <td>PHX</td>
      <td>1445</td>
      <td>-1.0</td>
      <td>147.0</td>
      <td>1009</td>
      <td>1638</td>
      <td>-7.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>96</th>
      <td>1</td>
      <td>1</td>
      <td>4</td>
      <td>US</td>
      <td>ATL</td>
      <td>PHL</td>
      <td>1445</td>
      <td>-4.0</td>
      <td>90.0</td>
      <td>666</td>
      <td>1644</td>
      <td>-11.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>104</th>
      <td>1</td>
      <td>1</td>
      <td>4</td>
      <td>US</td>
      <td>MSP</td>
      <td>PHX</td>
      <td>730</td>
      <td>-3.0</td>
      <td>174.0</td>
      <td>1276</td>
      <td>1010</td>
      <td>-20.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>31514</th>
      <td>6</td>
      <td>30</td>
      <td>2</td>
      <td>US</td>
      <td>DEN</td>
      <td>PHL</td>
      <td>705</td>
      <td>-4.0</td>
      <td>188.0</td>
      <td>1558</td>
      <td>1240</td>
      <td>1.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>31523</th>
      <td>6</td>
      <td>30</td>
      <td>2</td>
      <td>US</td>
      <td>PHX</td>
      <td>DEN</td>
      <td>1451</td>
      <td>6.0</td>
      <td>85.0</td>
      <td>602</td>
      <td>1738</td>
      <td>7.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>31535</th>
      <td>6</td>
      <td>30</td>
      <td>2</td>
      <td>US</td>
      <td>PHX</td>
      <td>AUS</td>
      <td>840</td>
      <td>-3.0</td>
      <td>116.0</td>
      <td>872</td>
      <td>1304</td>
      <td>-11.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>31561</th>
      <td>6</td>
      <td>30</td>
      <td>2</td>
      <td>US</td>
      <td>ORD</td>
      <td>PHX</td>
      <td>710</td>
      <td>-5.0</td>
      <td>170.0</td>
      <td>1440</td>
      <td>901</td>
      <td>-50.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>31582</th>
      <td>6</td>
      <td>30</td>
      <td>2</td>
      <td>US</td>
      <td>PHX</td>
      <td>OGG</td>
      <td>800</td>
      <td>-4.0</td>
      <td>356.0</td>
      <td>2845</td>
      <td>1127</td>
      <td>-13.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>1615 rows × 14 columns</p>
</div>
</div>
<div class="cell-output cell-output-display">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>MONTH</th>
      <th>DAY</th>
      <th>WEEKDAY</th>
      <th>AIRLINE</th>
      <th>ORG_AIR</th>
      <th>DEST_AIR</th>
      <th>SCHED_DEP</th>
      <th>DEP_DELAY</th>
      <th>AIR_TIME</th>
      <th>DIST</th>
      <th>SCHED_ARR</th>
      <th>ARR_DELAY</th>
      <th>DIVERTED</th>
      <th>CANCELLED</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>56</th>
      <td>1</td>
      <td>1</td>
      <td>4</td>
      <td>VX</td>
      <td>LAS</td>
      <td>SFO</td>
      <td>900</td>
      <td>23.0</td>
      <td>65.0</td>
      <td>414</td>
      <td>1035</td>
      <td>11.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>227</th>
      <td>1</td>
      <td>2</td>
      <td>5</td>
      <td>VX</td>
      <td>SFO</td>
      <td>LAS</td>
      <td>1220</td>
      <td>-5.0</td>
      <td>68.0</td>
      <td>414</td>
      <td>1350</td>
      <td>-5.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>243</th>
      <td>1</td>
      <td>2</td>
      <td>5</td>
      <td>VX</td>
      <td>SFO</td>
      <td>SEA</td>
      <td>700</td>
      <td>-4.0</td>
      <td>104.0</td>
      <td>679</td>
      <td>905</td>
      <td>-1.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>417</th>
      <td>1</td>
      <td>3</td>
      <td>6</td>
      <td>VX</td>
      <td>SFO</td>
      <td>LAS</td>
      <td>900</td>
      <td>-2.0</td>
      <td>62.0</td>
      <td>414</td>
      <td>1030</td>
      <td>-11.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>432</th>
      <td>1</td>
      <td>3</td>
      <td>6</td>
      <td>VX</td>
      <td>SFO</td>
      <td>SEA</td>
      <td>2035</td>
      <td>-2.0</td>
      <td>106.0</td>
      <td>679</td>
      <td>2240</td>
      <td>-2.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>58332</th>
      <td>12</td>
      <td>30</td>
      <td>3</td>
      <td>VX</td>
      <td>SFO</td>
      <td>LAS</td>
      <td>1950</td>
      <td>-3.0</td>
      <td>58.0</td>
      <td>414</td>
      <td>2120</td>
      <td>-4.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>58383</th>
      <td>12</td>
      <td>31</td>
      <td>4</td>
      <td>VX</td>
      <td>SFO</td>
      <td>PSP</td>
      <td>1630</td>
      <td>-7.0</td>
      <td>65.0</td>
      <td>421</td>
      <td>1755</td>
      <td>-12.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>58400</th>
      <td>12</td>
      <td>31</td>
      <td>4</td>
      <td>VX</td>
      <td>SFO</td>
      <td>LAX</td>
      <td>1125</td>
      <td>-4.0</td>
      <td>54.0</td>
      <td>337</td>
      <td>1245</td>
      <td>-10.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>58471</th>
      <td>12</td>
      <td>31</td>
      <td>4</td>
      <td>VX</td>
      <td>SFO</td>
      <td>LAX</td>
      <td>700</td>
      <td>6.0</td>
      <td>51.0</td>
      <td>337</td>
      <td>820</td>
      <td>3.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>58478</th>
      <td>12</td>
      <td>31</td>
      <td>4</td>
      <td>VX</td>
      <td>SFO</td>
      <td>LAX</td>
      <td>1530</td>
      <td>29.0</td>
      <td>52.0</td>
      <td>337</td>
      <td>1650</td>
      <td>22.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>993 rows × 14 columns</p>
</div>
</div>
<div class="cell-output cell-output-display">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>MONTH</th>
      <th>DAY</th>
      <th>WEEKDAY</th>
      <th>AIRLINE</th>
      <th>ORG_AIR</th>
      <th>DEST_AIR</th>
      <th>SCHED_DEP</th>
      <th>DEP_DELAY</th>
      <th>AIR_TIME</th>
      <th>DIST</th>
      <th>SCHED_ARR</th>
      <th>ARR_DELAY</th>
      <th>DIVERTED</th>
      <th>CANCELLED</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>1</td>
      <td>4</td>
      <td>WN</td>
      <td>LAX</td>
      <td>SLC</td>
      <td>1625</td>
      <td>58.0</td>
      <td>94.0</td>
      <td>590</td>
      <td>1905</td>
      <td>65.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>1</td>
      <td>4</td>
      <td>WN</td>
      <td>LAX</td>
      <td>MCI</td>
      <td>1720</td>
      <td>48.0</td>
      <td>166.0</td>
      <td>1363</td>
      <td>2225</td>
      <td>39.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>19</th>
      <td>1</td>
      <td>1</td>
      <td>4</td>
      <td>WN</td>
      <td>PHX</td>
      <td>LAX</td>
      <td>1640</td>
      <td>51.0</td>
      <td>58.0</td>
      <td>370</td>
      <td>1700</td>
      <td>59.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>20</th>
      <td>1</td>
      <td>1</td>
      <td>4</td>
      <td>WN</td>
      <td>ATL</td>
      <td>BWI</td>
      <td>1115</td>
      <td>1.0</td>
      <td>76.0</td>
      <td>577</td>
      <td>1305</td>
      <td>-15.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>23</th>
      <td>1</td>
      <td>1</td>
      <td>4</td>
      <td>WN</td>
      <td>ATL</td>
      <td>HOU</td>
      <td>1555</td>
      <td>30.0</td>
      <td>113.0</td>
      <td>696</td>
      <td>1720</td>
      <td>18.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>58455</th>
      <td>12</td>
      <td>31</td>
      <td>4</td>
      <td>WN</td>
      <td>LAX</td>
      <td>SMF</td>
      <td>1420</td>
      <td>-2.0</td>
      <td>64.0</td>
      <td>373</td>
      <td>1540</td>
      <td>-7.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>58458</th>
      <td>12</td>
      <td>31</td>
      <td>4</td>
      <td>WN</td>
      <td>LAS</td>
      <td>SFO</td>
      <td>1825</td>
      <td>25.0</td>
      <td>67.0</td>
      <td>414</td>
      <td>1955</td>
      <td>17.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>58472</th>
      <td>12</td>
      <td>31</td>
      <td>4</td>
      <td>WN</td>
      <td>PHX</td>
      <td>HOU</td>
      <td>845</td>
      <td>5.0</td>
      <td>119.0</td>
      <td>1020</td>
      <td>1210</td>
      <td>7.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>58473</th>
      <td>12</td>
      <td>31</td>
      <td>4</td>
      <td>WN</td>
      <td>DEN</td>
      <td>PDX</td>
      <td>1205</td>
      <td>4.0</td>
      <td>130.0</td>
      <td>991</td>
      <td>1400</td>
      <td>-13.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>58490</th>
      <td>12</td>
      <td>31</td>
      <td>4</td>
      <td>WN</td>
      <td>MSP</td>
      <td>ATL</td>
      <td>525</td>
      <td>39.0</td>
      <td>124.0</td>
      <td>907</td>
      <td>855</td>
      <td>34.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>8418 rows × 14 columns</p>
</div>
</div>
</div>
</section>
<section id="범주형변수를-기준으로-groupby---agg" class="level2">
<h2 class="anchored" data-anchor-id="범주형변수를-기준으로-groupby---agg">범주형변수를 기준으로 groupby -&gt; agg</h2>
<section id="ex1-airline-to-arr_delaymean" class="level3">
<h3 class="anchored" data-anchor-id="ex1-airline-to-arr_delaymean"><code>#</code> EX1: [AIRLINE] <span class="math inline">\(\to\)</span> {ARR_DELAY:mean}</h3>
<p><code>-</code> 방법1: grouby() <span class="math inline">\(\to\)</span> .agg({colname: function})</p>
<p>(예시1)</p>
<div class="cell" data-execution_count="56">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb94-1"><a href="#cb94-1"></a>df.groupby(by<span class="op">=</span><span class="st">"AIRLINE"</span>).agg({<span class="st">'ARR_DELAY'</span>:np.mean})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="56">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>ARR_DELAY</th>
    </tr>
    <tr>
      <th>AIRLINE</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>AA</th>
      <td>5.542661</td>
    </tr>
    <tr>
      <th>AS</th>
      <td>-0.833333</td>
    </tr>
    <tr>
      <th>B6</th>
      <td>8.692593</td>
    </tr>
    <tr>
      <th>DL</th>
      <td>0.339691</td>
    </tr>
    <tr>
      <th>EV</th>
      <td>7.034580</td>
    </tr>
    <tr>
      <th>F9</th>
      <td>13.630651</td>
    </tr>
    <tr>
      <th>HA</th>
      <td>4.972973</td>
    </tr>
    <tr>
      <th>MQ</th>
      <td>6.860591</td>
    </tr>
    <tr>
      <th>NK</th>
      <td>18.436070</td>
    </tr>
    <tr>
      <th>OO</th>
      <td>7.593463</td>
    </tr>
    <tr>
      <th>UA</th>
      <td>7.765755</td>
    </tr>
    <tr>
      <th>US</th>
      <td>1.681105</td>
    </tr>
    <tr>
      <th>VX</th>
      <td>5.348884</td>
    </tr>
    <tr>
      <th>WN</th>
      <td>6.397353</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>(예시2)</p>
<div class="cell" data-execution_count="57">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb95-1"><a href="#cb95-1"></a>df.groupby(by<span class="op">=</span><span class="st">"AIRLINE"</span>).agg({<span class="st">'ARR_DELAY'</span>:<span class="st">'mean'</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="57">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>ARR_DELAY</th>
    </tr>
    <tr>
      <th>AIRLINE</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>AA</th>
      <td>5.542661</td>
    </tr>
    <tr>
      <th>AS</th>
      <td>-0.833333</td>
    </tr>
    <tr>
      <th>B6</th>
      <td>8.692593</td>
    </tr>
    <tr>
      <th>DL</th>
      <td>0.339691</td>
    </tr>
    <tr>
      <th>EV</th>
      <td>7.034580</td>
    </tr>
    <tr>
      <th>F9</th>
      <td>13.630651</td>
    </tr>
    <tr>
      <th>HA</th>
      <td>4.972973</td>
    </tr>
    <tr>
      <th>MQ</th>
      <td>6.860591</td>
    </tr>
    <tr>
      <th>NK</th>
      <td>18.436070</td>
    </tr>
    <tr>
      <th>OO</th>
      <td>7.593463</td>
    </tr>
    <tr>
      <th>UA</th>
      <td>7.765755</td>
    </tr>
    <tr>
      <th>US</th>
      <td>1.681105</td>
    </tr>
    <tr>
      <th>VX</th>
      <td>5.348884</td>
    </tr>
    <tr>
      <th>WN</th>
      <td>6.397353</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p><code>-</code> 방법2: grouby() <span class="math inline">\(\to\)</span> key로 column선택 <span class="math inline">\(\to\)</span> .agg(f) or .f()</p>
<p>(예시1)</p>
<div class="cell" data-execution_count="58">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb96-1"><a href="#cb96-1"></a>df.groupby(by<span class="op">=</span><span class="st">'AIRLINE'</span>)[<span class="st">'ARR_DELAY'</span>].agg(np.mean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="58">
<pre><code>AIRLINE
AA     5.542661
AS    -0.833333
B6     8.692593
DL     0.339691
EV     7.034580
F9    13.630651
HA     4.972973
MQ     6.860591
NK    18.436070
OO     7.593463
UA     7.765755
US     1.681105
VX     5.348884
WN     6.397353
Name: ARR_DELAY, dtype: float64</code></pre>
</div>
</div>
<p>(예시2)</p>
<div class="cell" data-execution_count="59">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb98-1"><a href="#cb98-1"></a>df.groupby(by<span class="op">=</span><span class="st">'AIRLINE'</span>)[<span class="st">'ARR_DELAY'</span>].agg(<span class="st">"mean"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="59">
<pre><code>AIRLINE
AA     5.542661
AS    -0.833333
B6     8.692593
DL     0.339691
EV     7.034580
F9    13.630651
HA     4.972973
MQ     6.860591
NK    18.436070
OO     7.593463
UA     7.765755
US     1.681105
VX     5.348884
WN     6.397353
Name: ARR_DELAY, dtype: float64</code></pre>
</div>
</div>
<p>(예시3)</p>
<div class="cell" data-execution_count="60">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb100-1"><a href="#cb100-1"></a>df.groupby(by<span class="op">=</span><span class="st">'AIRLINE'</span>)[<span class="st">'ARR_DELAY'</span>].mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="60">
<pre><code>AIRLINE
AA     5.542661
AS    -0.833333
B6     8.692593
DL     0.339691
EV     7.034580
F9    13.630651
HA     4.972973
MQ     6.860591
NK    18.436070
OO     7.593463
UA     7.765755
US     1.681105
VX     5.348884
WN     6.397353
Name: ARR_DELAY, dtype: float64</code></pre>
</div>
</div>
</section>
<section id="ex2-airlineweekday-to-cancelledsum" class="level3">
<h3 class="anchored" data-anchor-id="ex2-airlineweekday-to-cancelledsum"><code>#</code> EX2: [AIRLINE,WEEKDAY] <span class="math inline">\(\to\)</span> {CANCELLED:sum}</h3>
<p><code>-</code> 방법1</p>
<p>(예시1)</p>
<div class="cell" data-execution_count="61">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb102-1"><a href="#cb102-1"></a>df.groupby(by<span class="op">=</span>[<span class="st">"AIRLINE"</span>,<span class="st">"WEEKDAY"</span>]).agg({<span class="st">"CANCELLED"</span>:np.<span class="bu">sum</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="61">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th></th>
      <th>CANCELLED</th>
    </tr>
    <tr>
      <th>AIRLINE</th>
      <th>WEEKDAY</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="5" valign="top">AA</th>
      <th>1</th>
      <td>41</td>
    </tr>
    <tr>
      <th>2</th>
      <td>9</td>
    </tr>
    <tr>
      <th>3</th>
      <td>16</td>
    </tr>
    <tr>
      <th>4</th>
      <td>20</td>
    </tr>
    <tr>
      <th>5</th>
      <td>18</td>
    </tr>
    <tr>
      <th>...</th>
      <th>...</th>
      <td>...</td>
    </tr>
    <tr>
      <th rowspan="5" valign="top">WN</th>
      <th>3</th>
      <td>18</td>
    </tr>
    <tr>
      <th>4</th>
      <td>10</td>
    </tr>
    <tr>
      <th>5</th>
      <td>7</td>
    </tr>
    <tr>
      <th>6</th>
      <td>10</td>
    </tr>
    <tr>
      <th>7</th>
      <td>7</td>
    </tr>
  </tbody>
</table>
<p>98 rows × 1 columns</p>
</div>
</div>
</div>
<p>(예시2)</p>
<div class="cell" data-execution_count="62">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb103-1"><a href="#cb103-1"></a>df.groupby(by<span class="op">=</span>[<span class="st">"AIRLINE"</span>,<span class="st">"WEEKDAY"</span>]).agg({<span class="st">"CANCELLED"</span>:<span class="st">"sum"</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="62">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th></th>
      <th>CANCELLED</th>
    </tr>
    <tr>
      <th>AIRLINE</th>
      <th>WEEKDAY</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="5" valign="top">AA</th>
      <th>1</th>
      <td>41</td>
    </tr>
    <tr>
      <th>2</th>
      <td>9</td>
    </tr>
    <tr>
      <th>3</th>
      <td>16</td>
    </tr>
    <tr>
      <th>4</th>
      <td>20</td>
    </tr>
    <tr>
      <th>5</th>
      <td>18</td>
    </tr>
    <tr>
      <th>...</th>
      <th>...</th>
      <td>...</td>
    </tr>
    <tr>
      <th rowspan="5" valign="top">WN</th>
      <th>3</th>
      <td>18</td>
    </tr>
    <tr>
      <th>4</th>
      <td>10</td>
    </tr>
    <tr>
      <th>5</th>
      <td>7</td>
    </tr>
    <tr>
      <th>6</th>
      <td>10</td>
    </tr>
    <tr>
      <th>7</th>
      <td>7</td>
    </tr>
  </tbody>
</table>
<p>98 rows × 1 columns</p>
</div>
</div>
</div>
<p><code>-</code> 방법2</p>
<p>(예시1)</p>
<div class="cell" data-execution_count="63">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb104-1"><a href="#cb104-1"></a>df.groupby(by<span class="op">=</span>[<span class="st">"AIRLINE"</span>,<span class="st">"WEEKDAY"</span>])[[<span class="st">"CANCELLED"</span>]].agg(np.<span class="bu">sum</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="63">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th></th>
      <th>CANCELLED</th>
    </tr>
    <tr>
      <th>AIRLINE</th>
      <th>WEEKDAY</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="5" valign="top">AA</th>
      <th>1</th>
      <td>41</td>
    </tr>
    <tr>
      <th>2</th>
      <td>9</td>
    </tr>
    <tr>
      <th>3</th>
      <td>16</td>
    </tr>
    <tr>
      <th>4</th>
      <td>20</td>
    </tr>
    <tr>
      <th>5</th>
      <td>18</td>
    </tr>
    <tr>
      <th>...</th>
      <th>...</th>
      <td>...</td>
    </tr>
    <tr>
      <th rowspan="5" valign="top">WN</th>
      <th>3</th>
      <td>18</td>
    </tr>
    <tr>
      <th>4</th>
      <td>10</td>
    </tr>
    <tr>
      <th>5</th>
      <td>7</td>
    </tr>
    <tr>
      <th>6</th>
      <td>10</td>
    </tr>
    <tr>
      <th>7</th>
      <td>7</td>
    </tr>
  </tbody>
</table>
<p>98 rows × 1 columns</p>
</div>
</div>
</div>
<p>(예시2)</p>
<div class="cell" data-execution_count="64">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb105-1"><a href="#cb105-1"></a>df.groupby(by<span class="op">=</span>[<span class="st">"AIRLINE"</span>,<span class="st">"WEEKDAY"</span>])[<span class="st">"CANCELLED"</span>].agg(<span class="st">"sum"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="64">
<pre><code>AIRLINE  WEEKDAY
AA       1          41
         2           9
         3          16
         4          20
         5          18
                    ..
WN       3          18
         4          10
         5           7
         6          10
         7           7
Name: CANCELLED, Length: 98, dtype: int64</code></pre>
</div>
</div>
<p>(예시3)</p>
<div class="cell" data-execution_count="65">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb107-1"><a href="#cb107-1"></a>df.groupby(by<span class="op">=</span>[<span class="st">"AIRLINE"</span>,<span class="st">"WEEKDAY"</span>])[<span class="st">"CANCELLED"</span>].<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="65">
<pre><code>AIRLINE  WEEKDAY
AA       1          41
         2           9
         3          16
         4          20
         5          18
                    ..
WN       3          18
         4          10
         5           7
         6          10
         7           7
Name: CANCELLED, Length: 98, dtype: int64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="66">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb109-1"><a href="#cb109-1"></a>df.DIVERTED</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="66">
<pre><code>0        0
1        0
2        0
3        0
4        0
        ..
58487    0
58488    0
58489    0
58490    0
58491    0
Name: DIVERTED, Length: 58492, dtype: int64</code></pre>
</div>
</div>
</section>
<section id="ex3-airlineweekday-to-cancelledsummean-diverted-summean" class="level3">
<h3 class="anchored" data-anchor-id="ex3-airlineweekday-to-cancelledsummean-diverted-summean"><code>#</code> EX3: [AIRLINE,WEEKDAY] <span class="math inline">\(\to\)</span> {CANCELLED:sum,mean}, {DIVERTED: sum,mean}</h3>
<p><code>-</code> 방법1</p>
<p>(예시1)</p>
<div class="cell" data-execution_count="67">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb111-1"><a href="#cb111-1"></a>df.groupby([<span class="st">"AIRLINE"</span>,<span class="st">"WEEKDAY"</span>])<span class="op">\</span></span>
<span id="cb111-2"><a href="#cb111-2"></a>.agg({<span class="st">"CANCELLED"</span>:[np.<span class="bu">sum</span>,np.mean],<span class="st">"DIVERTED"</span>:[np.<span class="bu">sum</span>,np.mean]})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="67">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th></th>
      <th colspan="2" halign="left">CANCELLED</th>
      <th colspan="2" halign="left">DIVERTED</th>
    </tr>
    <tr>
      <th></th>
      <th></th>
      <th>sum</th>
      <th>mean</th>
      <th>sum</th>
      <th>mean</th>
    </tr>
    <tr>
      <th>AIRLINE</th>
      <th>WEEKDAY</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="5" valign="top">AA</th>
      <th>1</th>
      <td>41</td>
      <td>0.032106</td>
      <td>6</td>
      <td>0.004699</td>
    </tr>
    <tr>
      <th>2</th>
      <td>9</td>
      <td>0.007341</td>
      <td>2</td>
      <td>0.001631</td>
    </tr>
    <tr>
      <th>3</th>
      <td>16</td>
      <td>0.011949</td>
      <td>2</td>
      <td>0.001494</td>
    </tr>
    <tr>
      <th>4</th>
      <td>20</td>
      <td>0.015004</td>
      <td>5</td>
      <td>0.003751</td>
    </tr>
    <tr>
      <th>5</th>
      <td>18</td>
      <td>0.014151</td>
      <td>1</td>
      <td>0.000786</td>
    </tr>
    <tr>
      <th>...</th>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th rowspan="5" valign="top">WN</th>
      <th>3</th>
      <td>18</td>
      <td>0.014118</td>
      <td>2</td>
      <td>0.001569</td>
    </tr>
    <tr>
      <th>4</th>
      <td>10</td>
      <td>0.007911</td>
      <td>4</td>
      <td>0.003165</td>
    </tr>
    <tr>
      <th>5</th>
      <td>7</td>
      <td>0.005828</td>
      <td>0</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>6</th>
      <td>10</td>
      <td>0.010132</td>
      <td>3</td>
      <td>0.003040</td>
    </tr>
    <tr>
      <th>7</th>
      <td>7</td>
      <td>0.006066</td>
      <td>3</td>
      <td>0.002600</td>
    </tr>
  </tbody>
</table>
<p>98 rows × 4 columns</p>
</div>
</div>
</div>
<p>(예시2)</p>
<div class="cell" data-execution_count="68">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb112-1"><a href="#cb112-1"></a>df.groupby([<span class="st">"AIRLINE"</span>,<span class="st">"WEEKDAY"</span>])<span class="op">\</span></span>
<span id="cb112-2"><a href="#cb112-2"></a>.agg({<span class="st">"CANCELLED"</span>:[<span class="st">"sum"</span>,<span class="st">"mean"</span>],<span class="st">"DIVERTED"</span>:[<span class="st">"sum"</span>,<span class="st">"mean"</span>]})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="68">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th></th>
      <th colspan="2" halign="left">CANCELLED</th>
      <th colspan="2" halign="left">DIVERTED</th>
    </tr>
    <tr>
      <th></th>
      <th></th>
      <th>sum</th>
      <th>mean</th>
      <th>sum</th>
      <th>mean</th>
    </tr>
    <tr>
      <th>AIRLINE</th>
      <th>WEEKDAY</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="5" valign="top">AA</th>
      <th>1</th>
      <td>41</td>
      <td>0.032106</td>
      <td>6</td>
      <td>0.004699</td>
    </tr>
    <tr>
      <th>2</th>
      <td>9</td>
      <td>0.007341</td>
      <td>2</td>
      <td>0.001631</td>
    </tr>
    <tr>
      <th>3</th>
      <td>16</td>
      <td>0.011949</td>
      <td>2</td>
      <td>0.001494</td>
    </tr>
    <tr>
      <th>4</th>
      <td>20</td>
      <td>0.015004</td>
      <td>5</td>
      <td>0.003751</td>
    </tr>
    <tr>
      <th>5</th>
      <td>18</td>
      <td>0.014151</td>
      <td>1</td>
      <td>0.000786</td>
    </tr>
    <tr>
      <th>...</th>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th rowspan="5" valign="top">WN</th>
      <th>3</th>
      <td>18</td>
      <td>0.014118</td>
      <td>2</td>
      <td>0.001569</td>
    </tr>
    <tr>
      <th>4</th>
      <td>10</td>
      <td>0.007911</td>
      <td>4</td>
      <td>0.003165</td>
    </tr>
    <tr>
      <th>5</th>
      <td>7</td>
      <td>0.005828</td>
      <td>0</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>6</th>
      <td>10</td>
      <td>0.010132</td>
      <td>3</td>
      <td>0.003040</td>
    </tr>
    <tr>
      <th>7</th>
      <td>7</td>
      <td>0.006066</td>
      <td>3</td>
      <td>0.002600</td>
    </tr>
  </tbody>
</table>
<p>98 rows × 4 columns</p>
</div>
</div>
</div>
<p><code>-</code> 방법2</p>
<p>(예시1)</p>
<div class="cell" data-execution_count="69">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb113-1"><a href="#cb113-1"></a>df.groupby([<span class="st">"AIRLINE"</span>,<span class="st">"WEEKDAY"</span>])[[<span class="st">"CANCELLED"</span>,<span class="st">"DIVERTED"</span>]]<span class="op">\</span></span>
<span id="cb113-2"><a href="#cb113-2"></a>.agg([np.<span class="bu">sum</span>,np.mean])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="69">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th></th>
      <th colspan="2" halign="left">CANCELLED</th>
      <th colspan="2" halign="left">DIVERTED</th>
    </tr>
    <tr>
      <th></th>
      <th></th>
      <th>sum</th>
      <th>mean</th>
      <th>sum</th>
      <th>mean</th>
    </tr>
    <tr>
      <th>AIRLINE</th>
      <th>WEEKDAY</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="5" valign="top">AA</th>
      <th>1</th>
      <td>41</td>
      <td>0.032106</td>
      <td>6</td>
      <td>0.004699</td>
    </tr>
    <tr>
      <th>2</th>
      <td>9</td>
      <td>0.007341</td>
      <td>2</td>
      <td>0.001631</td>
    </tr>
    <tr>
      <th>3</th>
      <td>16</td>
      <td>0.011949</td>
      <td>2</td>
      <td>0.001494</td>
    </tr>
    <tr>
      <th>4</th>
      <td>20</td>
      <td>0.015004</td>
      <td>5</td>
      <td>0.003751</td>
    </tr>
    <tr>
      <th>5</th>
      <td>18</td>
      <td>0.014151</td>
      <td>1</td>
      <td>0.000786</td>
    </tr>
    <tr>
      <th>...</th>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th rowspan="5" valign="top">WN</th>
      <th>3</th>
      <td>18</td>
      <td>0.014118</td>
      <td>2</td>
      <td>0.001569</td>
    </tr>
    <tr>
      <th>4</th>
      <td>10</td>
      <td>0.007911</td>
      <td>4</td>
      <td>0.003165</td>
    </tr>
    <tr>
      <th>5</th>
      <td>7</td>
      <td>0.005828</td>
      <td>0</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>6</th>
      <td>10</td>
      <td>0.010132</td>
      <td>3</td>
      <td>0.003040</td>
    </tr>
    <tr>
      <th>7</th>
      <td>7</td>
      <td>0.006066</td>
      <td>3</td>
      <td>0.002600</td>
    </tr>
  </tbody>
</table>
<p>98 rows × 4 columns</p>
</div>
</div>
</div>
<p>(예시2)</p>
<div class="cell" data-execution_count="70">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb114-1"><a href="#cb114-1"></a>df.groupby([<span class="st">"AIRLINE"</span>,<span class="st">"WEEKDAY"</span>])[[<span class="st">"CANCELLED"</span>,<span class="st">"DIVERTED"</span>]]<span class="op">\</span></span>
<span id="cb114-2"><a href="#cb114-2"></a>.agg([<span class="st">"sum"</span>,<span class="st">"mean"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="70">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th></th>
      <th colspan="2" halign="left">CANCELLED</th>
      <th colspan="2" halign="left">DIVERTED</th>
    </tr>
    <tr>
      <th></th>
      <th></th>
      <th>sum</th>
      <th>mean</th>
      <th>sum</th>
      <th>mean</th>
    </tr>
    <tr>
      <th>AIRLINE</th>
      <th>WEEKDAY</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="5" valign="top">AA</th>
      <th>1</th>
      <td>41</td>
      <td>0.032106</td>
      <td>6</td>
      <td>0.004699</td>
    </tr>
    <tr>
      <th>2</th>
      <td>9</td>
      <td>0.007341</td>
      <td>2</td>
      <td>0.001631</td>
    </tr>
    <tr>
      <th>3</th>
      <td>16</td>
      <td>0.011949</td>
      <td>2</td>
      <td>0.001494</td>
    </tr>
    <tr>
      <th>4</th>
      <td>20</td>
      <td>0.015004</td>
      <td>5</td>
      <td>0.003751</td>
    </tr>
    <tr>
      <th>5</th>
      <td>18</td>
      <td>0.014151</td>
      <td>1</td>
      <td>0.000786</td>
    </tr>
    <tr>
      <th>...</th>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th rowspan="5" valign="top">WN</th>
      <th>3</th>
      <td>18</td>
      <td>0.014118</td>
      <td>2</td>
      <td>0.001569</td>
    </tr>
    <tr>
      <th>4</th>
      <td>10</td>
      <td>0.007911</td>
      <td>4</td>
      <td>0.003165</td>
    </tr>
    <tr>
      <th>5</th>
      <td>7</td>
      <td>0.005828</td>
      <td>0</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>6</th>
      <td>10</td>
      <td>0.010132</td>
      <td>3</td>
      <td>0.003040</td>
    </tr>
    <tr>
      <th>7</th>
      <td>7</td>
      <td>0.006066</td>
      <td>3</td>
      <td>0.002600</td>
    </tr>
  </tbody>
</table>
<p>98 rows × 4 columns</p>
</div>
</div>
</div>
<p>(예시3) – 사용불가능</p>
</section>
<section id="ex4-airlineweekday-to-cancelledsummeancount-air_time-meanvar" class="level3">
<h3 class="anchored" data-anchor-id="ex4-airlineweekday-to-cancelledsummeancount-air_time-meanvar"><code>#</code> EX4: [AIRLINE,WEEKDAY] <span class="math inline">\(\to\)</span> {CANCELLED:sum,mean,count}, {AIR_TIME: mean,var}</h3>
<p><code>-</code> 방법1</p>
<p>(예시1)</p>
<div class="cell" data-execution_count="71">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb115-1"><a href="#cb115-1"></a>df.groupby([<span class="st">"AIRLINE"</span>,<span class="st">"WEEKDAY"</span>])<span class="op">\</span></span>
<span id="cb115-2"><a href="#cb115-2"></a>.agg({<span class="st">'CANCELLED'</span>:[np.<span class="bu">sum</span>,np.mean,<span class="bu">len</span>],<span class="st">'AIR_TIME'</span>:[np.mean,np.var]})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="71">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th></th>
      <th colspan="3" halign="left">CANCELLED</th>
      <th colspan="2" halign="left">AIR_TIME</th>
    </tr>
    <tr>
      <th></th>
      <th></th>
      <th>sum</th>
      <th>mean</th>
      <th>len</th>
      <th>mean</th>
      <th>var</th>
    </tr>
    <tr>
      <th>AIRLINE</th>
      <th>WEEKDAY</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="5" valign="top">AA</th>
      <th>1</th>
      <td>41</td>
      <td>0.032106</td>
      <td>1277</td>
      <td>147.610569</td>
      <td>5393.806723</td>
    </tr>
    <tr>
      <th>2</th>
      <td>9</td>
      <td>0.007341</td>
      <td>1226</td>
      <td>143.851852</td>
      <td>5359.890719</td>
    </tr>
    <tr>
      <th>3</th>
      <td>16</td>
      <td>0.011949</td>
      <td>1339</td>
      <td>144.514005</td>
      <td>5378.854539</td>
    </tr>
    <tr>
      <th>4</th>
      <td>20</td>
      <td>0.015004</td>
      <td>1333</td>
      <td>141.124618</td>
      <td>4791.524627</td>
    </tr>
    <tr>
      <th>5</th>
      <td>18</td>
      <td>0.014151</td>
      <td>1272</td>
      <td>145.430966</td>
      <td>5884.592076</td>
    </tr>
    <tr>
      <th>...</th>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th rowspan="5" valign="top">WN</th>
      <th>3</th>
      <td>18</td>
      <td>0.014118</td>
      <td>1275</td>
      <td>104.219920</td>
      <td>2901.873447</td>
    </tr>
    <tr>
      <th>4</th>
      <td>10</td>
      <td>0.007911</td>
      <td>1264</td>
      <td>107.200800</td>
      <td>2966.568935</td>
    </tr>
    <tr>
      <th>5</th>
      <td>7</td>
      <td>0.005828</td>
      <td>1201</td>
      <td>107.893635</td>
      <td>3268.717093</td>
    </tr>
    <tr>
      <th>6</th>
      <td>10</td>
      <td>0.010132</td>
      <td>987</td>
      <td>109.247433</td>
      <td>3152.753719</td>
    </tr>
    <tr>
      <th>7</th>
      <td>7</td>
      <td>0.006066</td>
      <td>1154</td>
      <td>107.602273</td>
      <td>3183.126889</td>
    </tr>
  </tbody>
</table>
<p>98 rows × 5 columns</p>
</div>
</div>
</div>
<p>(예시2)</p>
<div class="cell" data-execution_count="72">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb116-1"><a href="#cb116-1"></a>df.groupby([<span class="st">"AIRLINE"</span>,<span class="st">"WEEKDAY"</span>])<span class="op">\</span></span>
<span id="cb116-2"><a href="#cb116-2"></a>.agg({<span class="st">'CANCELLED'</span>:[<span class="st">"sum"</span>,<span class="st">"mean"</span>,<span class="st">"count"</span>],<span class="st">'AIR_TIME'</span>:[<span class="st">"mean"</span>,<span class="st">"var"</span>]})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="72">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th></th>
      <th colspan="3" halign="left">CANCELLED</th>
      <th colspan="2" halign="left">AIR_TIME</th>
    </tr>
    <tr>
      <th></th>
      <th></th>
      <th>sum</th>
      <th>mean</th>
      <th>count</th>
      <th>mean</th>
      <th>var</th>
    </tr>
    <tr>
      <th>AIRLINE</th>
      <th>WEEKDAY</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="5" valign="top">AA</th>
      <th>1</th>
      <td>41</td>
      <td>0.032106</td>
      <td>1277</td>
      <td>147.610569</td>
      <td>5393.806723</td>
    </tr>
    <tr>
      <th>2</th>
      <td>9</td>
      <td>0.007341</td>
      <td>1226</td>
      <td>143.851852</td>
      <td>5359.890719</td>
    </tr>
    <tr>
      <th>3</th>
      <td>16</td>
      <td>0.011949</td>
      <td>1339</td>
      <td>144.514005</td>
      <td>5378.854539</td>
    </tr>
    <tr>
      <th>4</th>
      <td>20</td>
      <td>0.015004</td>
      <td>1333</td>
      <td>141.124618</td>
      <td>4791.524627</td>
    </tr>
    <tr>
      <th>5</th>
      <td>18</td>
      <td>0.014151</td>
      <td>1272</td>
      <td>145.430966</td>
      <td>5884.592076</td>
    </tr>
    <tr>
      <th>...</th>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th rowspan="5" valign="top">WN</th>
      <th>3</th>
      <td>18</td>
      <td>0.014118</td>
      <td>1275</td>
      <td>104.219920</td>
      <td>2901.873447</td>
    </tr>
    <tr>
      <th>4</th>
      <td>10</td>
      <td>0.007911</td>
      <td>1264</td>
      <td>107.200800</td>
      <td>2966.568935</td>
    </tr>
    <tr>
      <th>5</th>
      <td>7</td>
      <td>0.005828</td>
      <td>1201</td>
      <td>107.893635</td>
      <td>3268.717093</td>
    </tr>
    <tr>
      <th>6</th>
      <td>10</td>
      <td>0.010132</td>
      <td>987</td>
      <td>109.247433</td>
      <td>3152.753719</td>
    </tr>
    <tr>
      <th>7</th>
      <td>7</td>
      <td>0.006066</td>
      <td>1154</td>
      <td>107.602273</td>
      <td>3183.126889</td>
    </tr>
  </tbody>
</table>
<p>98 rows × 5 columns</p>
</div>
</div>
</div>
<p>(사용자정의함수)</p>
<div class="cell" data-execution_count="73">
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb117-1"><a href="#cb117-1"></a>df.groupby([<span class="st">"AIRLINE"</span>,<span class="st">"WEEKDAY"</span>])<span class="op">\</span></span>
<span id="cb117-2"><a href="#cb117-2"></a>.agg({<span class="st">'CANCELLED'</span>:[np.<span class="bu">sum</span>,np.mean,<span class="bu">len</span>],</span>
<span id="cb117-3"><a href="#cb117-3"></a>      <span class="st">'AIR_TIME'</span>:[np.mean,<span class="kw">lambda</span> x: np.std(x,ddof<span class="op">=</span><span class="dv">1</span>)<span class="op">**</span><span class="dv">2</span>]})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="73">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th></th>
      <th colspan="3" halign="left">CANCELLED</th>
      <th colspan="2" halign="left">AIR_TIME</th>
    </tr>
    <tr>
      <th></th>
      <th></th>
      <th>sum</th>
      <th>mean</th>
      <th>len</th>
      <th>mean</th>
      <th>&lt;lambda_0&gt;</th>
    </tr>
    <tr>
      <th>AIRLINE</th>
      <th>WEEKDAY</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="5" valign="top">AA</th>
      <th>1</th>
      <td>41</td>
      <td>0.032106</td>
      <td>1277</td>
      <td>147.610569</td>
      <td>5393.806723</td>
    </tr>
    <tr>
      <th>2</th>
      <td>9</td>
      <td>0.007341</td>
      <td>1226</td>
      <td>143.851852</td>
      <td>5359.890719</td>
    </tr>
    <tr>
      <th>3</th>
      <td>16</td>
      <td>0.011949</td>
      <td>1339</td>
      <td>144.514005</td>
      <td>5378.854539</td>
    </tr>
    <tr>
      <th>4</th>
      <td>20</td>
      <td>0.015004</td>
      <td>1333</td>
      <td>141.124618</td>
      <td>4791.524627</td>
    </tr>
    <tr>
      <th>5</th>
      <td>18</td>
      <td>0.014151</td>
      <td>1272</td>
      <td>145.430966</td>
      <td>5884.592076</td>
    </tr>
    <tr>
      <th>...</th>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th rowspan="5" valign="top">WN</th>
      <th>3</th>
      <td>18</td>
      <td>0.014118</td>
      <td>1275</td>
      <td>104.219920</td>
      <td>2901.873447</td>
    </tr>
    <tr>
      <th>4</th>
      <td>10</td>
      <td>0.007911</td>
      <td>1264</td>
      <td>107.200800</td>
      <td>2966.568935</td>
    </tr>
    <tr>
      <th>5</th>
      <td>7</td>
      <td>0.005828</td>
      <td>1201</td>
      <td>107.893635</td>
      <td>3268.717093</td>
    </tr>
    <tr>
      <th>6</th>
      <td>10</td>
      <td>0.010132</td>
      <td>987</td>
      <td>109.247433</td>
      <td>3152.753719</td>
    </tr>
    <tr>
      <th>7</th>
      <td>7</td>
      <td>0.006066</td>
      <td>1154</td>
      <td>107.602273</td>
      <td>3183.126889</td>
    </tr>
  </tbody>
</table>
<p>98 rows × 5 columns</p>
</div>
</div>
</div>
</section>
</section>
<section id="연속형변수를-기준으로-groupby---agg" class="level2">
<h2 class="anchored" data-anchor-id="연속형변수를-기준으로-groupby---agg">연속형변수를 기준으로 groupby -&gt; agg</h2>
<div class="cell" data-execution_count="74">
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb118-1"><a href="#cb118-1"></a>df.T</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="74">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>...</th>
      <th>58482</th>
      <th>58483</th>
      <th>58484</th>
      <th>58485</th>
      <th>58486</th>
      <th>58487</th>
      <th>58488</th>
      <th>58489</th>
      <th>58490</th>
      <th>58491</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>MONTH</th>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>...</td>
      <td>12</td>
      <td>12</td>
      <td>12</td>
      <td>12</td>
      <td>12</td>
      <td>12</td>
      <td>12</td>
      <td>12</td>
      <td>12</td>
      <td>12</td>
    </tr>
    <tr>
      <th>DAY</th>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>...</td>
      <td>31</td>
      <td>31</td>
      <td>31</td>
      <td>31</td>
      <td>31</td>
      <td>31</td>
      <td>31</td>
      <td>31</td>
      <td>31</td>
      <td>31</td>
    </tr>
    <tr>
      <th>WEEKDAY</th>
      <td>4</td>
      <td>4</td>
      <td>4</td>
      <td>4</td>
      <td>4</td>
      <td>4</td>
      <td>4</td>
      <td>4</td>
      <td>4</td>
      <td>4</td>
      <td>...</td>
      <td>4</td>
      <td>4</td>
      <td>4</td>
      <td>4</td>
      <td>4</td>
      <td>4</td>
      <td>4</td>
      <td>4</td>
      <td>4</td>
      <td>4</td>
    </tr>
    <tr>
      <th>AIRLINE</th>
      <td>WN</td>
      <td>UA</td>
      <td>MQ</td>
      <td>AA</td>
      <td>WN</td>
      <td>UA</td>
      <td>AA</td>
      <td>F9</td>
      <td>AA</td>
      <td>UA</td>
      <td>...</td>
      <td>OO</td>
      <td>B6</td>
      <td>MQ</td>
      <td>DL</td>
      <td>EV</td>
      <td>AA</td>
      <td>F9</td>
      <td>OO</td>
      <td>WN</td>
      <td>OO</td>
    </tr>
    <tr>
      <th>ORG_AIR</th>
      <td>LAX</td>
      <td>DEN</td>
      <td>DFW</td>
      <td>DFW</td>
      <td>LAX</td>
      <td>IAH</td>
      <td>DFW</td>
      <td>SFO</td>
      <td>ORD</td>
      <td>IAH</td>
      <td>...</td>
      <td>DEN</td>
      <td>PHX</td>
      <td>ORD</td>
      <td>ATL</td>
      <td>DFW</td>
      <td>SFO</td>
      <td>LAS</td>
      <td>SFO</td>
      <td>MSP</td>
      <td>SFO</td>
    </tr>
    <tr>
      <th>DEST_AIR</th>
      <td>SLC</td>
      <td>IAD</td>
      <td>VPS</td>
      <td>DCA</td>
      <td>MCI</td>
      <td>SAN</td>
      <td>MSY</td>
      <td>PHX</td>
      <td>STL</td>
      <td>SJC</td>
      <td>...</td>
      <td>CPR</td>
      <td>BOS</td>
      <td>DSM</td>
      <td>CMH</td>
      <td>LFT</td>
      <td>DFW</td>
      <td>SFO</td>
      <td>SBA</td>
      <td>ATL</td>
      <td>BOI</td>
    </tr>
    <tr>
      <th>SCHED_DEP</th>
      <td>1625</td>
      <td>823</td>
      <td>1305</td>
      <td>1555</td>
      <td>1720</td>
      <td>1450</td>
      <td>1250</td>
      <td>1020</td>
      <td>1845</td>
      <td>925</td>
      <td>...</td>
      <td>1850</td>
      <td>2236</td>
      <td>1333</td>
      <td>2206</td>
      <td>850</td>
      <td>515</td>
      <td>1910</td>
      <td>1846</td>
      <td>525</td>
      <td>859</td>
    </tr>
    <tr>
      <th>DEP_DELAY</th>
      <td>58.0</td>
      <td>7.0</td>
      <td>36.0</td>
      <td>7.0</td>
      <td>48.0</td>
      <td>1.0</td>
      <td>84.0</td>
      <td>-7.0</td>
      <td>-5.0</td>
      <td>3.0</td>
      <td>...</td>
      <td>-2.0</td>
      <td>-12.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>21.0</td>
      <td>5.0</td>
      <td>13.0</td>
      <td>-6.0</td>
      <td>39.0</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>AIR_TIME</th>
      <td>94.0</td>
      <td>154.0</td>
      <td>85.0</td>
      <td>126.0</td>
      <td>166.0</td>
      <td>178.0</td>
      <td>64.0</td>
      <td>91.0</td>
      <td>44.0</td>
      <td>215.0</td>
      <td>...</td>
      <td>38.0</td>
      <td>231.0</td>
      <td>57.0</td>
      <td>64.0</td>
      <td>52.0</td>
      <td>166.0</td>
      <td>71.0</td>
      <td>46.0</td>
      <td>124.0</td>
      <td>73.0</td>
    </tr>
    <tr>
      <th>DIST</th>
      <td>590</td>
      <td>1452</td>
      <td>641</td>
      <td>1192</td>
      <td>1363</td>
      <td>1303</td>
      <td>447</td>
      <td>651</td>
      <td>258</td>
      <td>1608</td>
      <td>...</td>
      <td>230</td>
      <td>2300</td>
      <td>299</td>
      <td>447</td>
      <td>351</td>
      <td>1464</td>
      <td>414</td>
      <td>262</td>
      <td>907</td>
      <td>522</td>
    </tr>
    <tr>
      <th>SCHED_ARR</th>
      <td>1905</td>
      <td>1333</td>
      <td>1453</td>
      <td>1935</td>
      <td>2225</td>
      <td>1620</td>
      <td>1410</td>
      <td>1315</td>
      <td>1950</td>
      <td>1136</td>
      <td>...</td>
      <td>1956</td>
      <td>515</td>
      <td>1455</td>
      <td>2338</td>
      <td>1012</td>
      <td>1045</td>
      <td>2050</td>
      <td>1956</td>
      <td>855</td>
      <td>1146</td>
    </tr>
    <tr>
      <th>ARR_DELAY</th>
      <td>65.0</td>
      <td>-13.0</td>
      <td>35.0</td>
      <td>-7.0</td>
      <td>39.0</td>
      <td>-14.0</td>
      <td>83.0</td>
      <td>-6.0</td>
      <td>-5.0</td>
      <td>-14.0</td>
      <td>...</td>
      <td>1.0</td>
      <td>-45.0</td>
      <td>-7.0</td>
      <td>-8.0</td>
      <td>14.0</td>
      <td>-19.0</td>
      <td>4.0</td>
      <td>-5.0</td>
      <td>34.0</td>
      <td>-1.0</td>
    </tr>
    <tr>
      <th>DIVERTED</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>CANCELLED</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>14 rows × 58492 columns</p>
</div>
</div>
</div>
<div class="cell" data-execution_count="75">
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb119-1"><a href="#cb119-1"></a>df.DIST.describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="75">
<pre><code>count    58492.000000
mean       872.900072
std        624.996805
min         67.000000
25%        391.000000
50%        690.000000
75%       1199.000000
max       4502.000000
Name: DIST, dtype: float64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="76">
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb121-1"><a href="#cb121-1"></a>df.assign(DIST2 <span class="op">=</span> pd.cut(df.DIST,[<span class="op">-</span>np.inf,<span class="dv">391</span>,<span class="dv">690</span>,<span class="dv">1199</span>,np.inf]))<span class="op">\</span></span>
<span id="cb121-2"><a href="#cb121-2"></a>.groupby([<span class="st">"AIRLINE"</span>,<span class="st">"DIST2"</span>]).agg({<span class="st">'CANCELLED'</span>:[<span class="st">"sum"</span>,<span class="st">"mean"</span>,<span class="st">"count"</span>]})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="76">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th></th>
      <th colspan="3" halign="left">CANCELLED</th>
    </tr>
    <tr>
      <th></th>
      <th></th>
      <th>sum</th>
      <th>mean</th>
      <th>count</th>
    </tr>
    <tr>
      <th>AIRLINE</th>
      <th>DIST2</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="4" valign="top">AA</th>
      <th>(-inf, 391.0]</th>
      <td>18</td>
      <td>0.015986</td>
      <td>1126</td>
    </tr>
    <tr>
      <th>(391.0, 690.0]</th>
      <td>17</td>
      <td>0.013589</td>
      <td>1251</td>
    </tr>
    <tr>
      <th>(690.0, 1199.0]</th>
      <td>69</td>
      <td>0.022066</td>
      <td>3127</td>
    </tr>
    <tr>
      <th>(1199.0, inf]</th>
      <td>50</td>
      <td>0.014723</td>
      <td>3396</td>
    </tr>
    <tr>
      <th rowspan="4" valign="top">AS</th>
      <th>(-inf, 391.0]</th>
      <td>0</td>
      <td>NaN</td>
      <td>0</td>
    </tr>
    <tr>
      <th>(391.0, 690.0]</th>
      <td>0</td>
      <td>0.000000</td>
      <td>145</td>
    </tr>
    <tr>
      <th>(690.0, 1199.0]</th>
      <td>0</td>
      <td>0.000000</td>
      <td>462</td>
    </tr>
    <tr>
      <th>(1199.0, inf]</th>
      <td>0</td>
      <td>0.000000</td>
      <td>161</td>
    </tr>
    <tr>
      <th rowspan="4" valign="top">B6</th>
      <th>(-inf, 391.0]</th>
      <td>0</td>
      <td>0.000000</td>
      <td>71</td>
    </tr>
    <tr>
      <th>(391.0, 690.0]</th>
      <td>0</td>
      <td>0.000000</td>
      <td>38</td>
    </tr>
    <tr>
      <th>(690.0, 1199.0]</th>
      <td>0</td>
      <td>0.000000</td>
      <td>61</td>
    </tr>
    <tr>
      <th>(1199.0, inf]</th>
      <td>1</td>
      <td>0.002681</td>
      <td>373</td>
    </tr>
    <tr>
      <th rowspan="4" valign="top">DL</th>
      <th>(-inf, 391.0]</th>
      <td>7</td>
      <td>0.003086</td>
      <td>2268</td>
    </tr>
    <tr>
      <th>(391.0, 690.0]</th>
      <td>8</td>
      <td>0.002421</td>
      <td>3304</td>
    </tr>
    <tr>
      <th>(690.0, 1199.0]</th>
      <td>16</td>
      <td>0.006405</td>
      <td>2498</td>
    </tr>
    <tr>
      <th>(1199.0, inf]</th>
      <td>7</td>
      <td>0.002766</td>
      <td>2531</td>
    </tr>
    <tr>
      <th rowspan="4" valign="top">EV</th>
      <th>(-inf, 391.0]</th>
      <td>77</td>
      <td>0.028785</td>
      <td>2675</td>
    </tr>
    <tr>
      <th>(391.0, 690.0]</th>
      <td>47</td>
      <td>0.022793</td>
      <td>2062</td>
    </tr>
    <tr>
      <th>(690.0, 1199.0]</th>
      <td>22</td>
      <td>0.019982</td>
      <td>1101</td>
    </tr>
    <tr>
      <th>(1199.0, inf]</th>
      <td>0</td>
      <td>0.000000</td>
      <td>20</td>
    </tr>
    <tr>
      <th rowspan="4" valign="top">F9</th>
      <th>(-inf, 391.0]</th>
      <td>0</td>
      <td>0.000000</td>
      <td>27</td>
    </tr>
    <tr>
      <th>(391.0, 690.0]</th>
      <td>6</td>
      <td>0.013825</td>
      <td>434</td>
    </tr>
    <tr>
      <th>(690.0, 1199.0]</th>
      <td>4</td>
      <td>0.007105</td>
      <td>563</td>
    </tr>
    <tr>
      <th>(1199.0, inf]</th>
      <td>0</td>
      <td>0.000000</td>
      <td>293</td>
    </tr>
    <tr>
      <th rowspan="4" valign="top">HA</th>
      <th>(-inf, 391.0]</th>
      <td>0</td>
      <td>NaN</td>
      <td>0</td>
    </tr>
    <tr>
      <th>(391.0, 690.0]</th>
      <td>0</td>
      <td>NaN</td>
      <td>0</td>
    </tr>
    <tr>
      <th>(690.0, 1199.0]</th>
      <td>0</td>
      <td>NaN</td>
      <td>0</td>
    </tr>
    <tr>
      <th>(1199.0, inf]</th>
      <td>0</td>
      <td>0.000000</td>
      <td>112</td>
    </tr>
    <tr>
      <th rowspan="4" valign="top">MQ</th>
      <th>(-inf, 391.0]</th>
      <td>90</td>
      <td>0.047120</td>
      <td>1910</td>
    </tr>
    <tr>
      <th>(391.0, 690.0]</th>
      <td>39</td>
      <td>0.037356</td>
      <td>1044</td>
    </tr>
    <tr>
      <th>(690.0, 1199.0]</th>
      <td>22</td>
      <td>0.044266</td>
      <td>497</td>
    </tr>
    <tr>
      <th>(1199.0, inf]</th>
      <td>1</td>
      <td>0.050000</td>
      <td>20</td>
    </tr>
    <tr>
      <th rowspan="4" valign="top">NK</th>
      <th>(-inf, 391.0]</th>
      <td>5</td>
      <td>0.036496</td>
      <td>137</td>
    </tr>
    <tr>
      <th>(391.0, 690.0]</th>
      <td>4</td>
      <td>0.013201</td>
      <td>303</td>
    </tr>
    <tr>
      <th>(690.0, 1199.0]</th>
      <td>6</td>
      <td>0.011029</td>
      <td>544</td>
    </tr>
    <tr>
      <th>(1199.0, inf]</th>
      <td>10</td>
      <td>0.018797</td>
      <td>532</td>
    </tr>
    <tr>
      <th rowspan="4" valign="top">OO</th>
      <th>(-inf, 391.0]</th>
      <td>75</td>
      <td>0.024826</td>
      <td>3021</td>
    </tr>
    <tr>
      <th>(391.0, 690.0]</th>
      <td>39</td>
      <td>0.019364</td>
      <td>2014</td>
    </tr>
    <tr>
      <th>(690.0, 1199.0]</th>
      <td>19</td>
      <td>0.016351</td>
      <td>1162</td>
    </tr>
    <tr>
      <th>(1199.0, inf]</th>
      <td>9</td>
      <td>0.023018</td>
      <td>391</td>
    </tr>
    <tr>
      <th rowspan="4" valign="top">UA</th>
      <th>(-inf, 391.0]</th>
      <td>5</td>
      <td>0.007143</td>
      <td>700</td>
    </tr>
    <tr>
      <th>(391.0, 690.0]</th>
      <td>14</td>
      <td>0.011824</td>
      <td>1184</td>
    </tr>
    <tr>
      <th>(690.0, 1199.0]</th>
      <td>26</td>
      <td>0.010924</td>
      <td>2380</td>
    </tr>
    <tr>
      <th>(1199.0, inf]</th>
      <td>48</td>
      <td>0.013605</td>
      <td>3528</td>
    </tr>
    <tr>
      <th rowspan="4" valign="top">US</th>
      <th>(-inf, 391.0]</th>
      <td>0</td>
      <td>0.000000</td>
      <td>254</td>
    </tr>
    <tr>
      <th>(391.0, 690.0]</th>
      <td>7</td>
      <td>0.021944</td>
      <td>319</td>
    </tr>
    <tr>
      <th>(690.0, 1199.0]</th>
      <td>2</td>
      <td>0.006329</td>
      <td>316</td>
    </tr>
    <tr>
      <th>(1199.0, inf]</th>
      <td>12</td>
      <td>0.016529</td>
      <td>726</td>
    </tr>
    <tr>
      <th rowspan="4" valign="top">VX</th>
      <th>(-inf, 391.0]</th>
      <td>2</td>
      <td>0.008299</td>
      <td>241</td>
    </tr>
    <tr>
      <th>(391.0, 690.0]</th>
      <td>1</td>
      <td>0.003861</td>
      <td>259</td>
    </tr>
    <tr>
      <th>(690.0, 1199.0]</th>
      <td>0</td>
      <td>0.000000</td>
      <td>22</td>
    </tr>
    <tr>
      <th>(1199.0, inf]</th>
      <td>3</td>
      <td>0.006369</td>
      <td>471</td>
    </tr>
    <tr>
      <th rowspan="4" valign="top">WN</th>
      <th>(-inf, 391.0]</th>
      <td>55</td>
      <td>0.023810</td>
      <td>2310</td>
    </tr>
    <tr>
      <th>(391.0, 690.0]</th>
      <td>14</td>
      <td>0.006487</td>
      <td>2158</td>
    </tr>
    <tr>
      <th>(690.0, 1199.0]</th>
      <td>17</td>
      <td>0.007896</td>
      <td>2153</td>
    </tr>
    <tr>
      <th>(1199.0, inf]</th>
      <td>7</td>
      <td>0.003895</td>
      <td>1797</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="77">
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb122-1"><a href="#cb122-1"></a>pd.cut(df.DIST,[<span class="op">-</span>np.inf,<span class="dv">400</span>,<span class="dv">700</span>,<span class="dv">1200</span>,np.inf],labels<span class="op">=</span>[<span class="st">'~400'</span>,<span class="st">'400~700'</span>,<span class="st">'700~1200'</span>,<span class="st">'1200~'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="77">
<pre><code>0         400~700
1           1200~
2         400~700
3        700~1200
4           1200~
           ...   
58487       1200~
58488     400~700
58489        ~400
58490    700~1200
58491     400~700
Name: DIST, Length: 58492, dtype: category
Categories (4, object): ['~400' &lt; '400~700' &lt; '700~1200' &lt; '1200~']</code></pre>
</div>
</div>
<div class="cell" data-execution_count="78">
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb124-1"><a href="#cb124-1"></a>df.assign(DIST2 <span class="op">=</span> pd.cut(df.DIST,[<span class="op">-</span>np.inf,<span class="dv">400</span>,<span class="dv">700</span>,<span class="dv">1200</span>,np.inf],labels<span class="op">=</span>[<span class="st">'~400'</span>,<span class="st">'400~700'</span>,<span class="st">'700~1200'</span>,<span class="st">'1200~'</span>]))<span class="op">\</span></span>
<span id="cb124-2"><a href="#cb124-2"></a>.groupby([<span class="st">"AIRLINE"</span>,<span class="st">"DIST2"</span>]).agg({<span class="st">'CANCELLED'</span>:[<span class="st">"sum"</span>,<span class="st">"mean"</span>,<span class="st">"count"</span>]})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="78">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th></th>
      <th colspan="3" halign="left">CANCELLED</th>
    </tr>
    <tr>
      <th></th>
      <th></th>
      <th>sum</th>
      <th>mean</th>
      <th>count</th>
    </tr>
    <tr>
      <th>AIRLINE</th>
      <th>DIST2</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="4" valign="top">AA</th>
      <th>~400</th>
      <td>18</td>
      <td>0.015986</td>
      <td>1126</td>
    </tr>
    <tr>
      <th>400~700</th>
      <td>17</td>
      <td>0.013589</td>
      <td>1251</td>
    </tr>
    <tr>
      <th>700~1200</th>
      <td>69</td>
      <td>0.022066</td>
      <td>3127</td>
    </tr>
    <tr>
      <th>1200~</th>
      <td>50</td>
      <td>0.014723</td>
      <td>3396</td>
    </tr>
    <tr>
      <th rowspan="4" valign="top">AS</th>
      <th>~400</th>
      <td>0</td>
      <td>NaN</td>
      <td>0</td>
    </tr>
    <tr>
      <th>400~700</th>
      <td>0</td>
      <td>0.000000</td>
      <td>145</td>
    </tr>
    <tr>
      <th>700~1200</th>
      <td>0</td>
      <td>0.000000</td>
      <td>462</td>
    </tr>
    <tr>
      <th>1200~</th>
      <td>0</td>
      <td>0.000000</td>
      <td>161</td>
    </tr>
    <tr>
      <th rowspan="4" valign="top">B6</th>
      <th>~400</th>
      <td>0</td>
      <td>0.000000</td>
      <td>71</td>
    </tr>
    <tr>
      <th>400~700</th>
      <td>0</td>
      <td>0.000000</td>
      <td>38</td>
    </tr>
    <tr>
      <th>700~1200</th>
      <td>0</td>
      <td>0.000000</td>
      <td>61</td>
    </tr>
    <tr>
      <th>1200~</th>
      <td>1</td>
      <td>0.002681</td>
      <td>373</td>
    </tr>
    <tr>
      <th rowspan="4" valign="top">DL</th>
      <th>~400</th>
      <td>7</td>
      <td>0.003040</td>
      <td>2303</td>
    </tr>
    <tr>
      <th>400~700</th>
      <td>8</td>
      <td>0.002352</td>
      <td>3402</td>
    </tr>
    <tr>
      <th>700~1200</th>
      <td>16</td>
      <td>0.006765</td>
      <td>2365</td>
    </tr>
    <tr>
      <th>1200~</th>
      <td>7</td>
      <td>0.002766</td>
      <td>2531</td>
    </tr>
    <tr>
      <th rowspan="4" valign="top">EV</th>
      <th>~400</th>
      <td>77</td>
      <td>0.027838</td>
      <td>2766</td>
    </tr>
    <tr>
      <th>400~700</th>
      <td>48</td>
      <td>0.023312</td>
      <td>2059</td>
    </tr>
    <tr>
      <th>700~1200</th>
      <td>21</td>
      <td>0.020731</td>
      <td>1013</td>
    </tr>
    <tr>
      <th>1200~</th>
      <td>0</td>
      <td>0.000000</td>
      <td>20</td>
    </tr>
    <tr>
      <th rowspan="4" valign="top">F9</th>
      <th>~400</th>
      <td>0</td>
      <td>0.000000</td>
      <td>27</td>
    </tr>
    <tr>
      <th>400~700</th>
      <td>7</td>
      <td>0.015837</td>
      <td>442</td>
    </tr>
    <tr>
      <th>700~1200</th>
      <td>3</td>
      <td>0.005405</td>
      <td>555</td>
    </tr>
    <tr>
      <th>1200~</th>
      <td>0</td>
      <td>0.000000</td>
      <td>293</td>
    </tr>
    <tr>
      <th rowspan="4" valign="top">HA</th>
      <th>~400</th>
      <td>0</td>
      <td>NaN</td>
      <td>0</td>
    </tr>
    <tr>
      <th>400~700</th>
      <td>0</td>
      <td>NaN</td>
      <td>0</td>
    </tr>
    <tr>
      <th>700~1200</th>
      <td>0</td>
      <td>NaN</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1200~</th>
      <td>0</td>
      <td>0.000000</td>
      <td>112</td>
    </tr>
    <tr>
      <th rowspan="4" valign="top">MQ</th>
      <th>~400</th>
      <td>92</td>
      <td>0.047472</td>
      <td>1938</td>
    </tr>
    <tr>
      <th>400~700</th>
      <td>39</td>
      <td>0.035682</td>
      <td>1093</td>
    </tr>
    <tr>
      <th>700~1200</th>
      <td>20</td>
      <td>0.047619</td>
      <td>420</td>
    </tr>
    <tr>
      <th>1200~</th>
      <td>1</td>
      <td>0.050000</td>
      <td>20</td>
    </tr>
    <tr>
      <th rowspan="4" valign="top">NK</th>
      <th>~400</th>
      <td>5</td>
      <td>0.036496</td>
      <td>137</td>
    </tr>
    <tr>
      <th>400~700</th>
      <td>4</td>
      <td>0.013201</td>
      <td>303</td>
    </tr>
    <tr>
      <th>700~1200</th>
      <td>6</td>
      <td>0.011029</td>
      <td>544</td>
    </tr>
    <tr>
      <th>1200~</th>
      <td>10</td>
      <td>0.018797</td>
      <td>532</td>
    </tr>
    <tr>
      <th rowspan="4" valign="top">OO</th>
      <th>~400</th>
      <td>76</td>
      <td>0.024837</td>
      <td>3060</td>
    </tr>
    <tr>
      <th>400~700</th>
      <td>38</td>
      <td>0.018673</td>
      <td>2035</td>
    </tr>
    <tr>
      <th>700~1200</th>
      <td>19</td>
      <td>0.017241</td>
      <td>1102</td>
    </tr>
    <tr>
      <th>1200~</th>
      <td>9</td>
      <td>0.023018</td>
      <td>391</td>
    </tr>
    <tr>
      <th rowspan="4" valign="top">UA</th>
      <th>~400</th>
      <td>5</td>
      <td>0.006993</td>
      <td>715</td>
    </tr>
    <tr>
      <th>400~700</th>
      <td>14</td>
      <td>0.011966</td>
      <td>1170</td>
    </tr>
    <tr>
      <th>700~1200</th>
      <td>26</td>
      <td>0.010929</td>
      <td>2379</td>
    </tr>
    <tr>
      <th>1200~</th>
      <td>48</td>
      <td>0.013605</td>
      <td>3528</td>
    </tr>
    <tr>
      <th rowspan="4" valign="top">US</th>
      <th>~400</th>
      <td>0</td>
      <td>0.000000</td>
      <td>254</td>
    </tr>
    <tr>
      <th>400~700</th>
      <td>7</td>
      <td>0.021944</td>
      <td>319</td>
    </tr>
    <tr>
      <th>700~1200</th>
      <td>2</td>
      <td>0.006329</td>
      <td>316</td>
    </tr>
    <tr>
      <th>1200~</th>
      <td>12</td>
      <td>0.016529</td>
      <td>726</td>
    </tr>
    <tr>
      <th rowspan="4" valign="top">VX</th>
      <th>~400</th>
      <td>2</td>
      <td>0.008299</td>
      <td>241</td>
    </tr>
    <tr>
      <th>400~700</th>
      <td>1</td>
      <td>0.003861</td>
      <td>259</td>
    </tr>
    <tr>
      <th>700~1200</th>
      <td>0</td>
      <td>0.000000</td>
      <td>22</td>
    </tr>
    <tr>
      <th>1200~</th>
      <td>3</td>
      <td>0.006369</td>
      <td>471</td>
    </tr>
    <tr>
      <th rowspan="4" valign="top">WN</th>
      <th>~400</th>
      <td>55</td>
      <td>0.023022</td>
      <td>2389</td>
    </tr>
    <tr>
      <th>400~700</th>
      <td>17</td>
      <td>0.007795</td>
      <td>2181</td>
    </tr>
    <tr>
      <th>700~1200</th>
      <td>14</td>
      <td>0.006826</td>
      <td>2051</td>
    </tr>
    <tr>
      <th>1200~</th>
      <td>7</td>
      <td>0.003895</td>
      <td>1797</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>